exports.id=113,exports.ids=[113],exports.modules={57711:(e,t,a)=>{"use strict";a.r(t),a.d(t,{CompassAutoUpdateManager:()=>u});var o=a(15158),s=a.n(o),n=a(90429),i=a.n(n),r=a(45727),p=a(69640);const d=s()("mongodb-compass:main:application:auto-update-manager"),l={"mongodb-compass":"compass","mongodb-compass-readonly":"compass-readonly"},c={darwin:"osx",win32:"windows",linux:"linux"};class u{static initCalled=!1;static _init(){if(e=process.platform,!Object.keys(c).includes(e)||!Object.keys(l).includes("mongodb-compass"))return;var e;const t=new(i())({endpoint:"https://compass.mongodb.com",icon:p.Z,product:l["mongodb-compass"],channel:"stable",platform:c[process.platform]});t.on("state-change",(e=>{d("new state",e),"update-available"===e&&r.ipcMain.broadcast("app:update-available",{releaseNotes:t.releaseNotes,releaseVersion:t.releaseVersion})})),r.ipcMain.respondTo({"app:install-update":()=>{t.install()},"app:enable-auto-update":()=>{t.enable()},"app:disable-auto-update":()=>{t.disable()},"app:check-for-update":()=>{t.check()}})}static init(){this.initCalled||(this.initCalled=!0,this._init())}}},91971:(e,t,a)=>{const o=a(82361).EventEmitter,s=a(69733),n=a(96641)("hadron-auto-update-manager:linux");"linux"===process.platform?e.exports=new class extends o{setFeedURL(e){this.feedURL=e,n("feedURL is `%s`",this.feedURL)}checkForUpdates(){this.feedURL?s(this.feedURL).then((e=>{n("got response %j",e)})).catch((e=>{n("error from updater service",e)})):n("No feedURL set.")}quitAndInstall(){return!1}}:e.exports=a(72298).autoUpdater},90429:(e,t,a)=>{const o=a(72298),s=o.dialog,n=a(76635),i=a(82361).EventEmitter,r=a(91971),p=a(96641)("hadron-auto-update-manager"),d=o.app;function l(e,t,a,o,s){if(!e)throw new TypeError("endpointURL is required!");if("object"==typeof e){const n=e;e=n.endpoint,t=n.icon,a=n.product,o=n.channel,s=n.platform}this.endpointURL=e,this.iconURL=t,this.version=d.getVersion(),this.onUpdateError=n.bind(this.onUpdateError,this),this.onUpdateNotAvailable=n.bind(this.onUpdateNotAvailable,this),this.state="idle",this.feedURL=`${e}/api/v2/update/${a}/${o}/${s}/${this.version}`,p("auto updater ready and waiting.",{version:this.version,feedURL:this.feedURL}),process.nextTick((()=>{this.setupAutoUpdater()}))}n.extend(l.prototype,i.prototype),l.prototype.setupAutoUpdater=function(){r.on("error",((e,t)=>"Could not get code signature for running application"===t?(p("no auto updater for unsigned builds"),this.setState("unsupported")):(p("Error Downloading Update: "+t),this.setState("error")))),r.setFeedURL(this.feedURL),r.on("checking-for-update",(()=>{this.setState("checking")})),r.on("update-not-available",(()=>{this.setState("no-update-available")})),r.on("update-available",(()=>{this.setState("downloading")})),r.on("update-downloaded",((e,t,a)=>{this.releaseNotes=t,this.releaseVersion=a,this.setState("update-available")}))},l.prototype.scheduleUpdateCheck=function(){if(this.checkForUpdatesIntervalID)return p("Update check already scheduled"),!1;var e=this.checkForUpdates.bind(this,{hidePopups:!0});return this.checkForUpdatesIntervalID=setInterval(e,144e5),e(),!0},l.prototype.cancelScheduledUpdateCheck=function(){return!!this.checkForUpdatesIntervalID&&(clearInterval(this.checkForUpdatesIntervalID),this.checkForUpdatesIntervalID=null,p("cancelled scheduled update check"),!0)},l.prototype.checkForUpdates=function(e){return p("checkForUpdates with options",e),!1!==(e=e||{}).hidePopups&&(e.hidePopups=!0),e.hidePopups||(r.once("update-not-available",this.onUpdateNotAvailable),r.once("error",this.onUpdateError)),p("checking for updates..."),r.checkForUpdates(),!0},l.prototype.enable=function(){return"unsupported"===this.state?(p("Not scheduling because updates are not supported."),!1):this.scheduleUpdateCheck()},l.prototype.disable=function(){this.cancelScheduledUpdateCheck()},l.prototype.install=function(){return"update-available"!==this.state?(p("No update to install"),!1):(p("removing all event listeners for app#all-windows-closed"),d.removeAllListeners("all-windows-closed"),p("installing via autoUpdater.quitAndInstall()"),r.quitAndInstall(),!0)},l.prototype.check=function(){return"unsupported"===this.state?(p("Updates are not supported."),!1):this.checkForUpdates()},l.prototype.setState=function(e){this.state!==e&&(this.state=e,p("state is now",e),this.emit("state-changed",this.state))},l.prototype.getState=function(){return this.state},l.prototype.onUpdateNotAvailable=function(){return p("update not available",arguments),r.removeListener("error",this.onUpdateError),s.showMessageBox({type:"info",buttons:["OK"],icon:this.iconURL,message:"No update available.",title:"No Update Available",detail:"You're running the latest version of "+d.getName()+" ("+this.version+")."})},l.prototype.onUpdateError=function(e,t){return p("update error",arguments),r.removeListener("update-not-available",this.onUpdateNotAvailable),s.showMessageBox({type:"warning",buttons:["OK"],icon:this.iconURL,message:"There was an error checking for updates.",title:"Update Error",detail:t})},e.exports=l},31444:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=31444,e.exports=t}};