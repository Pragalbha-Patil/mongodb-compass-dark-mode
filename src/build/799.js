exports.id=799,exports.ids=[799],exports.modules={10842:(e,t,n)=>{var i=n(75551);e.exports=i},75551:(e,t,n)=>{var i=n(71305),o=n(37421),s=n(77485),a=n(73837).format,r=n(72298),c=r.remote?r.remote.app:void 0,l=n(49956)("mongodb-compass:models:preferences"),d={DARK:"DARK",LIGHT:"LIGHT",OS_THEME:"OS_THEME"},p={id:{type:"string",default:"General",required:!0},lastKnownVersion:{type:"string",required:!1},showFeatureTour:{type:"string",required:!1,default:void 0},showedNetworkOptIn:{type:"boolean",required:!0,default:!1},theme:{type:"string",required:!0,default:d.LIGHT},currentUserId:{type:"string",required:!1},telemetryAnonymousId:{type:"string",required:!0,default:""},agreedToLicense:{type:"boolean",required:!0,default:!1},networkTraffic:{type:"boolean",required:!0,default:!0},enableMaps:{type:"boolean",required:!0,default:!1},trackErrors:{type:"boolean",required:!0,default:!1},enableFeedbackPanel:{type:"boolean",required:!0,default:!1},trackUsageStatistics:{type:"boolean",required:!0,default:!1},autoUpdates:{type:"boolean",required:!0,default:!1},indexDDL:{type:"boolean",required:!0,default:!1},showAutoUpdateBanner:{type:"boolean",required:!0,default:!1},queryBuilder:{type:"boolean",required:!0,default:!0},showExplainPlanTab:{type:"boolean",required:!0,default:!1},singleDocumentCrud:{type:"boolean",required:!0,default:!1},serverStats:{type:"boolean",required:!0,default:!1},chartView:{type:"boolean",required:!0,default:!1},authMongodb:{type:"boolean",required:!0,default:!0},authKerberos:{type:"boolean",required:!0,default:!0},authLdap:{type:"boolean",required:!0,default:!0},authX509:{type:"boolean",required:!0,default:!1},sslUnvalidated:{type:"boolean",required:!0,default:!0},sslServer:{type:"boolean",required:!0,default:!0},sslAll:{type:"boolean",required:!0,default:!0}},u=i.extend(o,{props:p,extraProperties:"ignore",idAttribute:"id",namespace:"AppPreferences",storage:{backend:"disk",basepath:c?c.getPath("userData"):void 0},initialize:function(){this.on("page-refresh",this.onPageRefresh.bind(this)),this.on("app-restart",this.onAppRestart.bind(this)),this.on("app-version-mismatch",this.onAppVersionMismatch.bind(this))},onPageRefresh:function(){l("app page refresh detected")},onAppRestart:function(){l("app restart detected")},onAppVersionMismatch:function(e,t){l("version mismatch detected: was %s, now %s",e,t)},isFeatureEnabled:function(e){if(-1!==["enableMaps","trackErrors","enableFeedbackPanel","trackUsageStatistics","autoUpdates"].indexOf(e))return this.networkTraffic&&s(this,e);var t=s(this,e,null);if(null===t)throw new Error(a("Feature %s unknown.",e));return t}});e.exports=u,e.exports.THEMES=d},67799:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CompassApplication:()=>pe});var i=n(71017),o=n.n(i),s=n(82361),a=n(72298),r=n(45727),c=n(15158),l=n.n(c),d=n(22037),p=n.n(d),u=n(57147),h=n.n(u),m=n(12781),f=n.n(m),g=n(73837),w=n(59796),y=n.n(w),b=n(36269),v=n(69640);const S=l()("mongodb-compass:main:logging");var k=n(32697),x=n.n(k),M=n(4283),_=n.n(M),I=n(97013),C=n.n(I);function E(e,t,n){e?.callQuiet?.(t,n),"undefined"!=typeof process&&"function"==typeof process.emit&&process.emit(t,n)}const{log:O,mongoLogId:T}=function(e){const t=_()?n(45727):null,i={write(e,n){E(t,"compass:log",{line:e}),n()},end(e){e()}},o=new b.r_("",null,i),s=C()(`mongodb-compass:${e.toLowerCase()}`);return o.on("log",(({s:e,ctx:t,msg:n,attr:i})=>{s(n,i?{s:e,ctx:t,...i}:{s:e,ctx:t})})),{log:o.bindComponent(e),mongoLogId:b.lQ,debug:s,track:(...e)=>{Promise.resolve().then((()=>(async(e,n={})=>{const i=global?.hadronApp?.isFeatureEnabled("trackUsageStatistics");if(!i)return;const o={event:e,properties:n};"function"==typeof n&&(o.properties=await n()),E(t,"compass:track",o)})(...e))).catch((e=>s("track failed",e)))}}}("COMPASS-TELEMETRY"),N=process.env.HADRON_METRICS_SEGMENT_API_KEY_OVERRIDE||"dkjAjBRQ71BaMpVtx6KB3YAH8i240LAH",A=process.env.HADRON_METRICS_SEGMENT_HOST_OVERRIDE||null,P=process.env.IS_CI||process.env.CI||process.env.EVERGREEN_BUILD_VARIANT,D=!(!N||P&&!A);class W{static analytics=null;static state="waiting-for-user-config";static queuedEvents=[];static telemetryAnonymousId="";static lastReportedScreen="";constructor(){}static initPromise=null;static _track(e){const t={compass_version:a.app.getVersion().split(".").slice(0,2).join("."),compass_distribution:"compass",compass_channel:"stable"};if("waiting-for-user-config"!==this.state&&this.telemetryAnonymousId){if("disabled"!==this.state&&this.analytics){if("Screen"===e.event){const t=e.properties.name;if(t===this.lastReportedScreen)return;this.lastReportedScreen=t}this.analytics.track({userId:this.currentUserId,anonymousId:this.telemetryAnonymousId,event:e.event,properties:{...e.properties,...t}})}}else this.queuedEvents.push(e)}static identify(){let e;for(O.info(T(1001000093),"Telemetry","Loading telemetry config",{telemetryCapableEnvironment:D,hasAnalytics:!!this.analytics,currentUserId:this.currentUserId,telemetryAnonymousId:this.telemetryAnonymousId,state:this.state,queuedEvents:this.queuedEvents.length}),"enabled"===this.state&&this.analytics&&this.telemetryAnonymousId&&this.analytics.identify({userId:this.currentUserId,anonymousId:this.telemetryAnonymousId,traits:{platform:process.platform,arch:process.arch}});void 0!==(e=this.queuedEvents.shift());)this._track(e)}static _init(e){process.on("compass:track",(e=>{this._track(e)})),r.ipcMain.respondTo("compass:track",((e,t)=>{process.emit("compass:track",t)})),r.ipcMain.respondTo("compass:usage:identify",((e,t)=>{this.currentUserId=t.currentUserId,this.telemetryAnonymousId=t.telemetryAnonymousId,this.identify()})),r.ipcMain.respondTo("compass:usage:enabled",(()=>{O.info(T(1001000094),"Telemetry","Enabling Telemetry reporting"),"enabled"!==this.state&&(this.state="enabled",this.identify())})),r.ipcMain.respondTo("compass:usage:disabled",(()=>{O.info(T(1001000095),"Telemetry","Disabling Telemetry reporting"),"enabled"===this.state&&(this._track({event:"Telemetry Disabled",properties:{}}),this.analytics?.flush()),this.state="disabled"})),r.ipcMain.respondTo("compass:usage:flush",(()=>{this.analytics?.flush()})),D&&(this.analytics=new(x())(N,{host:A}),e.addExitHandler((async()=>{await new Promise((e=>this.analytics?.flush(e)))})))}static init(e){return this.initPromise??=this._init(e)}static track(e){this._track(e)}}var R=n(57310);const F=l()("mongodb-compass:electron:window-manager"),L=(()=>{let e=840;return"linux"===process.platform?e-=30:"darwin"===process.platform&&(e-=60),e})(),B=process.env.COMPASS_MIN_WIDTH??1024,H=process.env.COMPASS_MIN_HEIGHT??640,q=process.env.COMPASS_INDEX_RENDERER_URL||(0,R.pathToFileURL)(o().join(__dirname,"index.html")).toString();let z=!1;function U(e,t={}){const n=t.url??q,i={width:1432,height:L,minWidth:B,minHeight:H,icon:"linux"===process.platform?v.Z:void 0,show:!!process.env.DEBUG_MAIN_WINDOW,backgroundColor:"#F5F6F7",...t,webPreferences:{"subpixel-font-scaling":!0,"direct-write":!0,nodeIntegration:!0,contextIsolation:!1,enableRemoteModule:!0,...t&&t.webPreferences}};F("creating new main window:",i);let o=new a.BrowserWindow(i);return e.emit("new-window",o),o.once("closed",(()=>{F("Window closed. Dereferencing."),o=null})),F(`Loading page ${n} in main window`),async function(e){await(0,s.once)(e,"ready-to-show"),e.show()}(o),o.loadURL(n),process.env.DEVTOOLS&&o.webContents.openDevTools({mode:"detach"}),o.webContents.on("new-window",(function(e,t){e.preventDefault(),a.shell.openExternal(t)})),o}function $(e){z||(z=!0,F("sending `app:launched` msg back"),e.webContents.send("app:launched"))}function G(e,t,n){a.dialog.showMessageBox({type:"info",icon:v.Z,message:t,detail:n,buttons:["OK"]})}const V=(e,t,n={})=>{e.webContents.findInPage(t,n)},j=(e,t)=>{e.webContents.stopFindInPage(t)};n(67526),n(33354),n(25870),n(10930),n(40574),n(94116),n(43267),n(74614),n(19852),n(44306),n(26077),n(71072),n(50183);var J=n(10842);const K=l()("mongodb-compass:menu");class X{theme=J.THEMES.LIGHT}function Q({theme:e}){try{if(e===J.THEMES.OS_THEME)return void(a.nativeTheme.shouldUseDarkColors?r.ipcMain.broadcast("app:darkreader-enable"):r.ipcMain.broadcast("app:darkreader-disable"));if(e===J.THEMES.DARK)return void r.ipcMain.broadcast("app:darkreader-enable");r.ipcMain.broadcast("app:darkreader-disable")}catch(e){K("Failed to broadcast theme change",e)}}function Z(e){return{label:e,accelerator:"CmdOrCtrl+Q",click(){a.app.quit()}}}function Y(e){W.track({event:"Theme Changed",properties:{theme:e}})}function ee(e,t){return[{label:"Use OS Theme (Preview)",click:function(){e.theme=J.THEMES.OS_THEME,Y(e.theme),Q(e),t(e)},type:"checkbox",checked:e.theme===J.THEMES.OS_THEME},{label:"Dark Theme (Preview)",click:function(){e.theme=J.THEMES.DARK,Y(e.theme),Q(e),t(e)},type:"checkbox",checked:e.theme===J.THEMES.DARK},{label:"Light Theme",click:function(){e.theme=J.THEMES.LIGHT,Y(e.theme),Q(e),t(e)},type:"checkbox",checked:e.theme===J.THEMES.LIGHT}]}function te(e,t){return{label:"Theme",submenu:ee(e,t)}}function ne(e,t){return{label:a.app.getName(),submenu:[{label:`About ${a.app.getName()}`,role:"about"},{type:"separator"},te(e,t),{type:"separator"},{label:"Hide",accelerator:"Command+H",role:"hide"},{label:"Hide Others",accelerator:"Command+Shift+H",role:"hideOthers"},{label:"Show All",role:"unhide"},{type:"separator"},Z("Quit")]}}function ie(e){return{label:"New &Connection",accelerator:"CmdOrCtrl+N",click(){e.emit("show-connect-window")}}}function oe(e,t){const n=[ie(t),{label:"&Disconnect",click(){r.ipcMain.broadcastFocused("app:disconnect")}}];return e&&(n.push({type:"separator"}),n.push(Z("E&xit"))),{label:"&Connect",submenu:n}}function se(e){const t=[];return t.push({label:`&Online ${a.app.getName()} Help`,accelerator:"F1",click(){a.shell.openExternal("https://docs.mongodb.com/compass/")}}),t.push({label:`${a.app.getName()} &Overview`,click(){r.ipcMain.broadcastFocused("window:show-compass-tour")}}),t.push({label:"&Privacy Settings",click(){r.ipcMain.broadcastFocused("window:show-network-optin")}}),t.push({label:"&Plugins",click(){r.ipcMain.broadcastFocused("window:show-security-panel")}}),t.push({label:"&License",async click(){const e=(await n.e(249).then(n.t.bind(n,27249,17))).default,t=o().join(a.app.getPath("temp"),"License");h().writeFile(t,e,(e=>{e||a.shell.openPath(t)}))}}),t.push(function(e){return{label:"&Open Log File",click(){e.emit("show-log-file-dialog")}}}(e)),"darwin"!==process.platform&&(t.push({type:"separator"}),t.push({label:`&About ${a.app.getName()}`,click(){a.dialog.showMessageBox({type:"info",title:"About "+a.app.getName(),icon:v.Z,message:a.app.getName(),detail:"Version "+a.app.getVersion(),buttons:["OK"]})}})),{label:"&Help",submenu:t}}function ae(e){const t=[];return t.push({label:"&Share Schema as JSON",accelerator:"Alt+CmdOrCtrl+S",click(){r.ipcMain.broadcastFocused("window:menu-share-schema-json")}}),t.push({type:"separator"}),e||t.push({label:"&Import Data",click(){r.ipcMain.broadcastFocused("compass:open-import")}}),t.push({label:"&Export Collection",click(){r.ipcMain.broadcastFocused("compass:open-export")}}),{label:"&Collection",submenu:t}}function re(e,t){return{label:"&View",submenu:[{label:"&Reload",accelerator:"CmdOrCtrl+Shift+R",click(){a.BrowserWindow.getFocusedWindow()?.reload()}},{label:"&Reload Data",accelerator:"CmdOrCtrl+R",click(){r.ipcMain.broadcast("app:refresh-data")}},{type:"separator"},{label:"Actual Size",accelerator:"CmdOrCtrl+0",click(){r.ipcMain.broadcast("window:zoom-reset")}},{label:"Zoom In",accelerator:"CmdOrCtrl+=",click(){r.ipcMain.broadcast("window:zoom-in")}},{label:"Zoom Out",accelerator:"CmdOrCtrl+-",click(){r.ipcMain.broadcast("window:zoom-out")}},{type:"separator"},..."darwin"===process.platform?[]:[te(e,t),{type:"separator"}],{label:"&Toggle DevTools",accelerator:"Alt+CmdOrCtrl+I",click(){a.BrowserWindow.getFocusedWindow()?.webContents.toggleDevTools()}}]}}class ce{showCollection=!1;isReadOnly=!1}class le{constructor(){}static windowState=new Map;static lastFocusedWindow=null;static currentWindowMenuLoaded=null;static initCalled=!1;static themeState=new X;static _init(e){this.app=e,e.on("new-window",(e=>{this.load(e)})),r.ipcMain.respondTo({"window:show-collection-submenu":this.showCollection.bind(this),"window:hide-collection-submenu":this.hideCollection.bind(this)}),r.ipcMain.respondTo({"window:theme-loaded":(e,t)=>{this.themeState.theme!==t&&(this.themeState.theme=t,this.saveThemeAndRefreshMenu({theme:t}))}}),a.nativeTheme.on("updated",(()=>{Q(this.themeState)})),this.setupDockMenu()}static init(e){this.initCalled||(this.initCalled=!0,this._init(e))}static load(e){K(`WINDOW ${e.id} load()`),e.id!==this.currentWindowMenuLoaded?(this.windowState.has(e.id)||(this.addWindow(e),K(`create menu state for new WINDOW ${e.id}`),this.windowState.set(e.id,new ce)),this.setTemplate(e.id),K(`WINDOW ${e.id}'s menu loaded`)):K(`WINDOW ${e.id}'s menu already loaded`)}static async setupDockMenu(){await a.app.whenReady(),"darwin"===process.platform&&a.app.dock.setMenu(a.Menu.buildFromTemplate([{label:"New Connection",click:()=>{this.app.emit("show-connect-window")}}]))}static addWindow(e){const t=e.id;this.lastFocusedWindow=e,K(`lastFocusedWindow set to WINDOW ${t}`),e.on("focus",(({sender:e})=>{K(`WINDOW ${e.id} focused`),K(`lastFocusedWindow set to WINDOW ${e.id}`),this.lastFocusedWindow=e,this.load(e)})),e.once("closed",(()=>{K(`WINDOW ${t} closed`),this.windowState.delete(t),this.lastFocusedWindow===e&&(this.lastFocusedWindow=null),this.currentWindowMenuLoaded===t&&(this.currentWindowMenuLoaded=null)}))}static setTemplate(e){K(`WINDOW ${e} setTemplate()`),this.currentWindowMenuLoaded=e;const t=this.getTemplate(e),n=a.Menu.buildFromTemplate(t);a.Menu.setApplicationMenu(n)}static getTemplate(e){let t=this.windowState.get(e);return t||(K(`WINDOW ${e} doesn't have any stored state. Using a default one`),t=new ce),"darwin"===process.platform?function(e,t,n,i){const o=[ne(t,n)];return o.push(oe(!1,i)),o.push({label:"Edit",submenu:[{label:"Undo",accelerator:"Command+Z",role:"undo"},{label:"Redo",accelerator:"Shift+Command+Z",role:"redo"},{type:"separator"},{label:"Cut",accelerator:"Command+X",role:"cut"},{label:"Copy",accelerator:"Command+C",role:"copy"},{label:"Paste",accelerator:"Command+V",role:"paste"},{label:"Select All",accelerator:"Command+A",role:"selectAll"},{type:"separator"},{label:"Find",accelerator:"CmdOrCtrl+F",click(){r.ipcMain.broadcastFocused("app:find")}}]}),o.push(re(t,n)),e.showCollection&&o.push(ae(e.isReadOnly)),o.push({label:"Window",submenu:[{label:"Minimize",accelerator:"Command+M",role:"minimize"},{label:"Close",accelerator:"Command+W",role:"close"},{type:"separator"},{label:"Bring All to Front",role:"front"}]}),o.push(se(i)),o}(t,this.themeState,this.saveThemeAndRefreshMenu,this.app):function(e,t,n,i){const o=[oe(!0,i),re(t,n)];return e.showCollection&&o.push(ae(e.isReadOnly)),o.push(se(i)),o}(t,this.themeState,this.saveThemeAndRefreshMenu,this.app)}static saveThemeAndRefreshMenu=e=>{const t=this.currentWindowMenuLoaded;if(!t)return void K("Cannot refresh WINDOW menu");r.ipcMain.broadcastFocused("app:save-theme",e.theme),K(`WINDOW ${t} refreshing menu`);const n=this.getTemplate(t),i=a.Menu.buildFromTemplate(n);a.Menu.setApplicationMenu(i)};static showCollection(e,{isReadOnly:t}){this.updateMenu({showCollection:!0,isReadOnly:t})}static hideCollection(){this.updateMenu({showCollection:!1})}static updateMenu(e,t=this.lastFocusedWindow){if(K(`updateMenu() set menu state to ${JSON.stringify(e)}`),!t)return void K("Can't update menu state: no window to update");const n=this.windowState.get(t.id);n&&(Object.assign(n,e),this.windowState.set(t.id,n),this.setTemplate(t.id))}}const de=l()("mongodb-compass:main:application");class pe{constructor(){}static emitter=new s.EventEmitter;static exitHandlers=[];static initPromise=null;static async _init(){n(71540)?de("electron-squirrel-startup event handled sucessfully"):(this.setupUserDirectory(),await Promise.all([this.setupLogging(),this.setupAutoUpdate(),this.setupSecureStore(),this.setupTelemetry()]),this.setupJavaScriptArguments(),this.setupLifecycleListeners(),this.setupApplicationMenu(),this.setupWindowManager())}static init(){return this.initPromise??=this._init()}static async setupSecureStore(){await Promise.resolve().then(n.t.bind(n,37421,23))}static setupJavaScriptArguments(){a.app.commandLine.appendSwitch("js-flags","--harmony"),a.app.commandLine.appendSwitch("ignore-gpu-blacklist","true")}static async setupAutoUpdate(){{const{CompassAutoUpdateManager:e}=await Promise.all([n.e(680),n.e(113)]).then(n.bind(n,57711));e.init()}}static setupApplicationMenu(){le.init(this)}static setupWindowManager(){(class{static initPromise=null;static async _init(e){a.app.on("before-quit",(function(){const e=a.BrowserWindow.getAllWindows()[0];e&&(F("sending `app:quit` msg"),e.webContents.send("app:quit"))})),a.app.on("window-all-closed",(()=>{"darwin"!==process.platform&&a.app.quit()})),e.on("show-connect-window",(()=>{U(e)})),r.ipcMain.respondTo({"window:renderer-ready":$,"app:show-info-dialog":G,"app:find-in-page":V,"app:stop-find-in-page":j,"compass:loading:change-status"(e,t){r.ipcMain.broadcast("compass:loading:change-status",t)},"compass:error:fatal"(e,t){r.ipcMain.broadcast("compass:error:fatal",t)},"compass:log"(e,t){r.ipcMain.broadcast("compass:log",t)}}),await async function(e){await a.app.whenReady(),await async function(e){U(e)}(e)}(e),a.app.on("activate",((t,n)=>{n||U(e)}))}static init(e){return this.initPromise??=this._init(e)}}).init(this)}static setupLifecycleListeners(){a.app.on("window-all-closed",(function(){de("All windows closed. Waiting for a new connection window.")})),a.app.on("will-quit",(async e=>{e.preventDefault(),await this.runExitHandlers(),a.app.exit()})),r.ipcMain.respondTo({"license:disagree":function(){de("Did not agree to license, quitting app."),a.app.quit()}}),r.ipcMain.handle("coverage",(()=>global.__coverage__))}static setupUserDirectory(){}static async setupLogging(){const e=a.app.getPath("home"),t=process.env.LOCALAPPDATA||process.env.APPDATA,n=process.env.MONGODB_COMPASS_TEST_LOG_DIR||"win32"===process.platform?o().join(t||e,"mongodb","compass"):o().join(e,".mongodb","compass");a.app.setAppLogsPath(n),await class{constructor(){}static initPromise=null;static async _init(e){const t=await async function(e){try{const t=a.app.getPath("logs"),n=new b.nc({directory:t,gzip:!0,retentionDays:30,onerror:(e,t)=>S("Failed to access path",t,e),onwarn:(e,t)=>S("Failed to access path",t,e)}),[i,o]=await Promise.all([(async()=>(await u.promises.mkdir(t,{recursive:!0}),await n.createLogWriter()))(),(async()=>{let e="";try{e=await u.promises.readFile("/etc/os-release","utf8")}catch{}const t=/^ID="?(?<name>.+?)"?$/m.exec(e),n=/^VERSION_ID="?(?<version>.+?)"?$/m.exec(e);return{osReleaseName:t?.groups?.name,osReleaseVersion:n?.groups?.version}})()]);return S("Writing log output to",i.logFilePath),i.info("COMPASS-MAIN",(0,b.lQ)(1001000001),"logging","Starting logging",{version:a.app.getVersion(),nodeVersion:process.versions.node,electronVersion:process.versions.electron,chromeVersion:process.versions.chrome,platform:p().platform(),arch:p().arch(),...o}),r.ipcMain.on("compass:error:fatal",((e,t)=>{i.fatal("COMPASS-MAIN",(0,b.lQ)(1001000002),"app",`Uncaught exception: ${t.message}`,t)})),process.prependListener("uncaughtException",(e=>{i.fatal("COMPASS-MAIN",(0,b.lQ)(1001000002),"app",`Uncaught exception: ${String(e)}`,{message:e&&e.message,stack:e&&e.stack})})),a.app.on("window-all-closed",(function(){i.flush()})),e.addExitHandler((async function(){i.info("COMPASS-MAIN",(0,b.lQ)(1001000003),"app","Closing application"),i.end(),await(0,s.once)(i,"log-finish")})),process.on("compass:log",(e=>{i.target.write(e.line)})),r.ipcMain.respondTo("compass:log",((e,t)=>{process.emit("compass:log",t)})),r.ipcMain.handle("compass:logPath",(()=>a.app.getPath("logs"))),await n.cleanupOldLogfiles(),i.logFilePath}catch(e){S("Failure setting up logging!",e)}}(e);t&&e.on("show-log-file-dialog",(()=>{!async function(e){const{response:t}=await a.dialog.showMessageBox({type:"info",title:"Log file for this session",icon:v.Z,message:`The log file for this session can be found at ${e}`,detail:"Some tools may not be able to read the log file until Compass has exited.",buttons:["OK","Copy to clipboard","Open Folder","Extract and open as .txt"]});switch(t){case 1:a.clipboard.writeText(e);break;case 2:a.shell.showItemInFolder(e);break;case 3:try{const t=await async function(e,t=a.app.getPath("temp")){const n=o().basename(e,".gz"),i=o().join(t,"compass_logs",`compass_${n}.txt`);S("Extracting partial logfile",{logFilePath:e,tempFilePath:i});try{await u.promises.mkdir(o().dirname(i),{recursive:!0,mode:448}),await u.promises.unlink(i)}catch{}try{await(0,g.promisify)(f().pipeline)((0,u.createReadStream)(e),y().createGunzip({finishFlush:y().constants.Z_SYNC_FLUSH}),(0,u.createWriteStream)(i,{flags:"wx",mode:384}))}catch(e){throw S("Failed to extract file",e),e}return i}(e);a.shell.openPath(t)}catch(e){a.dialog.showErrorBox("Error extracting log file",String(e))}}}(t)}))}static init(e){return this.initPromise??=this._init(e)}}.init(this)}static async setupTelemetry(){await W.init(this)}static addExitHandler(e){this.exitHandlers.push(e)}static async runExitHandlers(){let e;for(;void 0!==(e=this.exitHandlers.pop());)await e()}static on(e,t){return this.emitter.on(e,t),this}static emit(e,...t){return this.emitter.emit(e,...t)}static removeAllListeners(){return this.emitter.removeAllListeners(),this}}},45727:(e,t,n)=>{"use strict";const i=n(4283);let o=!1;try{o="string"!=typeof n(72298)}catch(e){}!function(){if(!o)return console.warn("Unsupported environment for hadron-ipc"),{};const t=n(i?80677:65663);e.exports=t,i?e.exports.ipcRenderer=t:e.exports.ipcMain=t}()},81563:(e,t)=>{"use strict";t._=e=>`hadron-ipc-${e}-response`},65663:(e,t,n)=>{"use strict";const i=n(81563)._,o=n(34749),s=n(34772),a=n(99320),r=n(72298),c=r.BrowserWindow,l=r.ipcMain,d=n(69770)("hadron-ipc:main");(t=l).respondTo=(e,n)=>{if(s(e))return o(e,((e,n)=>{t.respondTo(n,e)})),t;const r=i(e),p=`${r}-error`;return l.on(e,((t,...i)=>{const o=c.fromWebContents(t.sender);if(!o)return;const s=n=>{if(d(`responding with result for ${e}`,n),o.isDestroyed())return d("browserWindow went away.  nothing to send response to.");t.sender.send(r,n)},l=n=>{if(d(`responding with error for ${e}`,n),o.isDestroyed())return d("browserWindow went away.  nothing to send response to.");t.sender.send(p,n)};d(`calling ${e} handler with args`,i);const u=n(o,...i);a(u)?u.then(s).catch(l):u instanceof Error?l(u):s(u)})),t},t.broadcast=(e,...t)=>{c.getAllWindows().forEach((n=>{n.webContents&&n.webContents.send(e,...t)}))},t.broadcastFocused=(e,...t)=>{c.getAllWindows().forEach((n=>{n.webContents&&n.isFocused()&&n.webContents.send(e,...t)}))},t.remove=(e,t)=>{l.removeListener(e,t)},e.exports=t},80677:(e,t,n)=>{"use strict";const i=n(81563)._,o=n(72298).ipcRenderer,s=n(69770)("hadron-ipc:renderer");function a(e,t,...n){e(`calling ${t} with args`,n);const s=i(t),a=`${s}-error`;return new Promise((function(i,r){o.on(s,(function(n,r){e(`got response for ${t} from main`,r),o.removeAllListeners(s),o.removeAllListeners(a),i(r)})),o.on(a,(function(n,i){e(`error for ${t} from main`,i),o.removeAllListeners(s),o.removeAllListeners(a),r(i)})),o.send(t,...n)}))}(t=o).callQuiet=function(e,...t){return a((()=>{}),e,...t)},t.call=function(e,...t){return a(s,e,...t)},e.exports=t},37421:(e,t,n)=>{e.exports=n(81039)},82862:(e,t,n)=>{var i=n(21516).P,o=n(96938)("mongodb-storage-mixin:backends:base");function s(){}s.prototype.clear=function(e){e(new Error("Not implemented"))},s.prototype._getId=function(e){return"string"==typeof e?e:e.getId()},s.prototype.findOne=function(e,t,n){n(new Error("Not implemented"))},s.prototype.create=function(e,t,n){n(new Error("Not implemented"))},s.prototype.update=function(e,t,n){n(new Error("Not implemented"))},s.prototype.remove=function(e,t,n){n(new Error("Not implemented"))},s.prototype.find=function(e,t,n){n(new Error("Not implemented"))},s.prototype.serialize=function(e){return e.serialize()},s.prototype.deserialize=function(e){return JSON.parse(e)},s.prototype.exec=function(e,t,n,s){s=s||i(e,t,n),o("exec",{method:e}),"read"===e?t.isCollection?this.find(t,n,s):this.findOne(t,n,s):"create"===e?this.create(t,n,s):"update"===e?this.update(t,n,s):"delete"===e&&this.remove(t,n,s)},e.exports=s},5932:(e,t,n)=>{var i=n(73837).inherits,o=n(82862),s=n(57147),a=n(1162),r=n(71017),c=n(24290),l=n(76635),d=n(42133),p=n(96938)("storage-mixin:backends:disk"),u=/.json$/gi;if(l.isEmpty(s))try{s=window.require("electron").remote.require("fs")}catch(e){throw new Error("browser context, `fs` module not available for disk storage")}function h(e){if(!(this instanceof h))return new h(e);e=l.defaults(e,{basepath:"."}),this.basepath=e.basepath,this.namespace=e.namespace;try{s.mkdirSync(this._getPath())}catch(e){}}i(h,o),h.clear=function(e,t,n){void 0===n&&(n=t,t="."),d(r.join(e,t),n)},h.prototype._getPath=function(){return r.join(process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST_BASE_PATH||this.basepath,this.namespace)},h.prototype._getId=function(e){var t="string"==typeof e?e:e.getId();return r.join(this._getPath(),t+".json")},h.prototype._write=function(e,t,n){var i=this._getId(e);p("_write",i),a(i,JSON.stringify(this.serialize(e)),n)},h.prototype.remove=function(e,t,n){var i=this._getId(e);s.exists(i,(function(e){if(!e)return p("remove: skipping",i,"not exists"),n();p("remove: unlinking",i),s.unlink(i,n)}))},h.prototype.update=h.prototype._write,h.prototype.create=h.prototype._write,h.prototype.findOne=function(e,t,n){var i=this._getId(e);s.exists(i,(function(e){if(!e)return n(null,{});s.readFile(i,"utf8",(function(e,t){if(e)return n(e);try{var i=JSON.parse(t);n(null,i)}catch(e){n(e)}}))}))},h.prototype.find=function(e,t,n){var i=this;s.readdir(this._getPath(),(function(e,o){if(e)return n(e);if(0===o.length)return p("no keys found for namespace `%s`",i.namespace),n(null,[]);var s=o.filter((function(e){return e.match(u)})).map((function(e){return i.findOne.bind(i,r.basename(e,r.extname(e)),t)}));p("fetching %d models",s.length),c.parallel(s,n)}))},e.exports=h},21516:(e,t,n)=>{const i=n(96938)("mongodb-storage-mixin:backends:errback");e.exports.P=function(e,t,n){return function(e,t){if(e){if(n.error)return n.error(t,e);throw i("An error ocurred with no handler specified!",e),e}if(n.success)return n.success(t)}},e.exports.U=function(e){return{success:function(t){e(null,t)},error:function(t,n){e(n)}}}},18993:(e,t,n)=>{e.exports={local:n(66019),disk:n(5932),secure:n(23328),remote:n(69904),null:n(93444),splice:n(69092),"splice-disk":n(34763),"splice-disk-ipc":n(30045),"secure-ipc":n(74867),"secure-main":n(34254)}},66019:(e,t,n)=>{var i=n(73837).inherits,o=n(82862),s=n(93444),a=n(76635),r=n(24290),c=n(75486),l=n(96938)("mongodb-storage-mixin:backends:local"),d={};function p(e){if(!(this instanceof p))return new p(e);e=a.defaults(e,{appName:"storage-mixin",driver:"INDEXEDDB"}),this.namespace=e.namespace,this.namespace in d?this.store=d[this.namespace]:(this.store=c.createInstance({driver:c[e.driver],name:e.appName,storeName:this.namespace}),d[this.namespace]=this.store)}i(p,o),p.clear=function(e,t){e in d?(l("Clearing store for",e),d[e].clear(t)):t()},p.prototype._write=function(e,t,n){this.store.setItem(this._getId(e),this.serialize(e),n)},p.prototype.findOne=function(e,t,n){const i=this._getId(e);this.store.getItem(i,((e,t)=>{e?n(e):(t||(l(`Can't find model with id ${i}`),t={}),n(null,t))}))},p.prototype.remove=function(e,t,n){this.store.removeItem(this._getId(e),n)},p.prototype.update=p.prototype._write,p.prototype.create=p.prototype._write,p.prototype.find=function(e,t,n){var i=this;this.store.keys((function(e,o){if(e)return n(e);if(0===o.length)return l("no keys found for namespace `%s`",i.namespace),n(null,[]);var s=o.map((function(e){return i.findOne.bind(i,e,t)}));l("fetching `%d` keys on namespace `%s`",s.length,i.namespace),r.parallel(s,n)}))},e.exports="undefined"!=typeof window?p:s},93444:(e,t,n)=>{var i=n(73837).inherits,o=n(82862),s=n(96938)("storage-mixin:backends:null");function a(e){if(!(this instanceof a))return new a(e);this.namespace=e.namespace,s("Warning: the `null` storage backend does not store any data.")}i(a,o),a.clear=function(e,t){t()},a.prototype._done=function(e,t,n){n()},a.prototype.remove=a.prototype._done,a.prototype.update=a.prototype._done,a.prototype.create=a.prototype._done,a.prototype.findOne=function(e,t,n){n(null,{})},a.prototype.find=function(e,t,n){n(null,[])},a.isNullBackend=!0,e.exports=a},69904:(e,t,n)=>{var i=n(53871),o=n(76635),s=n(82862);function a(e){if(!(this instanceof a))return new a(e);this.namespace=e.namespace,this.options=o.omit(e,["namespace","backend"])}(0,n(73837).inherits)(a,s),a.clear=function(e,t){t()},a.prototype.exec=function(e,t,n){o.defaults(n,this.options),i(e,t,n)},e.exports=a},74867:(e,t,n)=>{const i=n(73837).inherits,o=n(82862),s=n(76635),a=n(96938)("mongodb-storage-mixin:backends:secure-ipc"),r=n(26426);function c(e){if(!(this instanceof c))return new c(e);e=s.defaults(e,{appName:"storage-mixin"}),this.namespace=e.appName+"/"+e.namespace}if(i(c,o),"undefined"!=typeof window){const e=n(45727);c.clear=function(t,n){const i=`storage-mixin/${t}`;a("Clearing all secure values for",i),e.call("storage-mixin:clear",{serviceName:i}).then((()=>n())).catch(n)},c.prototype.remove=function(t,n,i){const o=this._getId(t),s=this.namespace;e.call("storage-mixin:remove",{accountName:o,serviceName:s}).then((()=>i())).catch(i)},c.prototype.update=function(t,n,i){const o=this.namespace,s=this._getId(t),a=JSON.stringify(this.serialize(t));e.call("storage-mixin:update",{accountName:s,serviceName:o,value:a}).then((()=>i())).catch(i)},c.prototype.create=function(t,n,i){const o=this.namespace,s=this._getId(t),a=JSON.stringify(this.serialize(t));e.call("storage-mixin:create",{accountName:s,serviceName:o,value:a}).then((()=>i())).catch(i)},c.prototype.findOne=function(t,n,i){const o=this.namespace,s=this._getId(t),a=r();e.on("storage-mixin:find-one:result",((e,t)=>{t.uuid===a&&(t.rawJsonString?i(null,JSON.parse(t.rawJsonString)):i(null,{}))})),e.call("storage-mixin:find-one",{accountName:s,serviceName:o,uuid:a})},c.prototype.find=function(t,n,i){a("Fetching data...",t.length);const o=e=>{if(e.namespace===this.namespace){const n=t.reduce(((t,n)=>{const i=n.getId(),o=e.credentials.find((e=>e.account===i)),a={};if(a[n.idAttribute]=i,o){const e=JSON.parse(o.password);s.assign(a,e)}return t.push(a),t}),[]);i(null,n)}},c=r(),l=(t,n)=>{try{if(n.callId&&n.callId!==c)return void a("Skip response from another storage-mixin:find call",{expectedCallId:c,receivedCallId:n.callId});a("Processing results of storage-mixin:find",{callId:n.callId}),e.removeListener("storage-mixin:find:result",l),o(n)}catch(e){a("Error processing the results of storage-mixin:find",e)}};e.on("storage-mixin:find:result",l),e.call("storage-mixin:find",{callId:c,namespace:this.namespace})}}e.exports=c},34254:(e,t,n)=>{const i=n(96938)("mongodb-storage-mixin:backends:secure-main");if(process&&"browser"===process.type){const e=n(45727);e.respondTo("storage-mixin:clear",((e,t)=>(i("Clearing all secure values for",t.serviceName),n(74602).findCredentials(t.serviceName).then((function(e){return Promise.all(e.map((function(e){const o=e.account;return n(74602).deletePassword(t.serviceName,o).then((function(){return i("Deleted account %s successfully",o),o})).catch((function(e){throw i("Failed to delete",o,e),e}))})))})).then((function(e){i("Cleared %d accounts for serviceName %s",e.length,t.serviceName,e)})).catch((function(e){i("Failed to clear credentials!",e)}))))),e.respondTo("storage-mixin:remove",((e,t)=>n(74602).deletePassword(t.serviceName,t.accountName).then((function(){i("Removed password for",{service:t.serviceName,account:t.accountName})})).catch((e=>{i("Error removing password",e)})))),e.respondTo("storage-mixin:update",((e,t)=>n(74602).setPassword(t.serviceName,t.accountName,t.value).then((function(){i("Updated password successfully for",{service:t.serviceName,account:t.accountName})})).catch((function(e){i("Error updating password",e)})))),e.respondTo("storage-mixin:create",((e,t)=>n(74602).setPassword(t.serviceName,t.accountName,t.value).then((function(){i("Successfully dreated password for",{service:t.serviceName,account:t.accountName})})).catch((function(e){i("Error creating password",e)})))),e.respondTo("storage-mixin:find-one",((t,o)=>n(74602).getPassword(o.serviceName,o.accountName).then((function(t){e.broadcast("storage-mixin:find-one:result",{uuid:o.uuid,rawJsonString:t})})).catch((function(e){i("Error finding one",e)})))),e.respondTo("storage-mixin:find",((t,o)=>n(74602).findCredentials(o.namespace).then((function(t){e.broadcast("storage-mixin:find:result",{namespace:o.namespace,credentials:t,callId:o.callId})})).catch((function(e){i("Error finding",e)}))))}},23328:(e,t,n)=>{var i=n(73837).inherits,o=n(82862),s=n(76635),a=n(96938)("mongodb-storage-mixin:backends:secure");function r(e){if(!(this instanceof r))return new r(e);e=s.defaults(e,{appName:"storage-mixin"}),this.namespace=e.appName+"/"+e.namespace}i(r,o),r.clear=function(e,t){var i,o=`storage-mixin/${e}`;a("Clearing all secure values for",o);try{i=n(74602).findCredentials(o)}catch(e){throw a("Error calling findCredentials",e),e}i.then((function(e){return a("Found credentials",e.map((function(e){return e.account}))),Promise.all(e.map((function(e){var t=e.account;return n(74602).deletePassword(o,t).then((function(){return a("Deleted account %s successfully",t),t})).catch((function(e){throw a("Failed to delete",t,e),e}))})))})).then((function(e){a("Cleared %d accounts for serviceName %s",e.length,o,e),t()})).catch((function(e){a("Failed to clear credentials!",e),t(e)}))},r.prototype.remove=function(e,t,i){var o=this._getId(e),s=this.namespace;n(74602).deletePassword(s,o).then((function(){a("Removed password for",{service:s,account:o}),i()})).catch(i)},r.prototype.update=function(e,t,i){var o=this.namespace,s=this._getId(e),r=JSON.stringify(this.serialize(e));n(74602).setPassword(o,s,r).then((function(){a("Updated password successfully for",{service:o,account:s}),i()})).catch((function(e){i(e)}))},r.prototype.create=function(e,t,i){var o=this.namespace,s=this._getId(e),r=JSON.stringify(this.serialize(e));n(74602).setPassword(o,s,r).then((function(){a("Successfully dreated password for",{service:o,account:s}),i()})).catch((function(e){i(e)}))},r.prototype.findOne=function(e,t,i){var o=this.namespace,s=this._getId(e);n(74602).getPassword(o,s).then((function(e){if(!e)return a("findOne failed. No value found",{service:o,account:s}),i(null,{});a("findOne successful",{service:o,account:s}),i(null,JSON.parse(e))})).catch(i)},r.prototype.find=function(e,t,i){a("Fetching data...",e.length),n(74602).findCredentials(this.namespace).then((function(t){var n=e.reduce((function(e,n){var i=n.getId(),o=t.find((function(e){return e.account===i})),a={};if(a[n.idAttribute]=i,o){var r=JSON.parse(o.password);s.assign(a,r)}return e.push(a),e}),[]);return i(null,n)})).catch(i)},e.exports=r},30045:(e,t,n)=>{var i=n(76635),o=n(24290),s=n(82862),a=n(5932),r=n(93444),c=n(74867),l=n(21516).P,d=n(21516).U,p=n(71790).L,u=n(73837).inherits,h=n(29728),m=n(96938)("mongodb-storage-mixin:backends:splice-disk");function f(e){if("true"===process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST)return new h(e);if("undefined"==typeof window)return r;if(!(this instanceof f))return new f(e);e=i.defaults(e,{appName:"storage-mixin",secureCondition:function(e,t){return t.match(/password/)}}),this.namespace=e.namespace;var t=e.secureCondition;a.prototype.serialize=function(e){return m("Serializing for disk backend with condition",t),i.omitBy(e.serialize(),t)},this.diskBackend=new a(e),c.prototype.serialize=function(e){return m("Serializing for secure backend with condition",t),i.pickBy(e.serialize(),t)},this.secureBackend=new c(e)}u(f,s),f.clear=function(e,t){m("Clear for all involved backends");var n=[a.clear.bind(null,e),c.clear.bind(null,e)];o.parallel(n,t)},f.prototype.exec=function(e,t,n,s){var a=this;s=s||l(e,t,n);var r=[function(n){a.diskBackend.exec(e,t,d(n))},function(n,o){t.set(n,{silent:!0,sort:!1}),a.secureBackend.exec(e,t,d((function(e,s){return e?o(e):i.isEmpty(n)?o(null,t.isCollection?[]:{}):void p(n,s,t,o)})))}];o.waterfall(r,s)},e.exports=f},34763:(e,t,n)=>{var i=n(76635),o=n(24290),s=n(82862),a=n(5932),r=n(93444),c=n(23328),l=n(21516).P,d=n(21516).U,p=n(73837).inherits,u=n(39491),h=n(96938)("mongodb-storage-mixin:backends:splice-disk");function m(e){if(!(this instanceof m))return new m(e);e=i.defaults(e,{appName:"storage-mixin",secureCondition:function(e,t){return t.match(/password/)}}),this.namespace=e.namespace;var t=e.secureCondition;a.prototype.serialize=function(e){return h("Serializing for disk backend with condition",t),i.omitBy(e.serialize(),t)},this.diskBackend=new a(e),c.prototype.serialize=function(e){return h("Serializing for secure backend with condition",t),i.pickBy(e.serialize(),t)},this.secureBackend=new c(e)}p(m,s),m.clear=function(e,t){h("Clear for all involved backends");var n=[a.clear.bind(null,e),c.clear.bind(null,e)];o.parallel(n,t)},m.prototype.exec=function(e,t,n,s){var a=this;s=s||l(e,t,n);var c=[function(n){a.diskBackend.exec(e,t,d(n))},function(n,o){t.set(n,{silent:!0,sort:!1}),a.secureBackend.exec(e,t,d((function(e,s){if(e)return o(e);!t.isCollection||a.secureBackend instanceof r||i.each(n,(function(e,n){u.equal(e[t.mainIndex],s[n][t.mainIndex])})),o(null,i.merge(n,s))})))}];o.waterfall(c,s)},e.exports="undefined"!=typeof window?m:r},69092:(e,t,n)=>{var i=n(76635),o=n(24290),s=n(82862),a=n(66019),r=n(93444),c=n(23328),l=n(21516).P,d=n(21516).U,p=n(71790).L,u=n(73837).inherits,h=n(96938)("mongodb-storage-mixin:backends:splice");function m(e){if(!(this instanceof m))return new m(e);e=i.defaults(e,{appName:"storage-mixin",secureCondition:function(e,t){return t.match(/password/)}}),this.namespace=e.namespace;var t=e.secureCondition;a.prototype.serialize=function(e){return h("Serializing for local backend with condition",t),i.omitBy(e.serialize(),t)},this.localBackend=new a(e),c.prototype.serialize=function(e){return h("Serializing for secure backend with condition",t),i.pickBy(e.serialize(),t)},this.secureBackend=new c(e)}u(m,s),m.clear=function(e,t){h("Clear for all involved backends");var n=[a.clear.bind(null,e),c.clear.bind(null,e)];o.parallel(n,t)},m.prototype.exec=function(e,t,n,s){var a=this;s=s||l(e,t,n);var r=[function(n){a.localBackend.exec(e,t,d(n))},function(n,o){t.set(n,{silent:!0,sort:!1}),a.secureBackend.exec(e,t,d((function(e,s){return e?o(e):i.isEmpty(n)?o(null,t.isCollection?[]:{}):void p(n,s,t,o)})))}];o.waterfall(r,s)},e.exports="undefined"!=typeof window?m:r},29728:(e,t,n)=>{const i=n(71017),o=n(22037),s=n(5932);function a(e){return new s(Object.assign({},e,{basepath:process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST_BASE_PATH||i.join(o.tmpdir(),"compass-storage-mixin-tests")}))}a.enable=e=>{process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST="true",process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST_BASE_PATH=e},a.disable=()=>{delete process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST,delete process.env.MONGODB_COMPASS_STORAGE_MIXIN_TEST_BASE_PATH},e.exports=a},71790:(e,t,n)=>{var i=n(76635);e.exports.L=function(e,t,n,o){if(n.isCollection)return o(null,e.reduce(((e,o)=>{const s=t.find((e=>e[n.mainIndex]===o[n.mainIndex]));return e.push(i.merge(o,s)),e}),[]));o(null,i.merge(e,t))}},81039:(e,t,n)=>{var i=n(18993),o=n(96938)("storage-mixin");e.exports={TestBackend:n(29728),secureMain:i["secure-main"],storage:"local",session:{fetched:{type:"boolean",required:!0,default:!1}},_initializeMixin:function(){var e=this.storage;"object"!=typeof this.storage&&(e={backend:this.storage}),e.namespace=this.namespace,this._storageBackend=new i[e.backend](e)},sync:function(e,t,n){this._storageBackend||this._initializeMixin();var i=this,s=n.success;n.success=function(e){s&&(i.fetched=!0,s.call(i,e))},n.error=function(e,t){throw o("Unexpected storage-mixin sync error",{err:t,resp:e}),t},this.fetched=!1,this._storageBackend.exec(e,t,n)}}}};