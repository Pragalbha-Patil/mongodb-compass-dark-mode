(global.webpackChunkMongoDBCompass=global.webpackChunkMongoDBCompass||[]).push([[558],{68166:(e,t,n)=>{e.exports=n(76174)},76174:(e,t,n)=>{n(67526),n(33354),n(25870),n(10930),n(40574),n(94116),n(43267),n(74614),n(19852),n(44306),n(26077),n(71072),n(50183),n(18423);const a=n(71305),s=n(2326),{Collection:i}=n(3080),r=new Map;function o(e){return{initialize(){e.forEach((e=>{if(e in this&&"function"==typeof this[e]){const n=this[e];this[e]=(t=n,function(...e){const n=this.isCollection?`${this.parent.cid}$$coll$$${t.name}`:`${this.cid}$$${t.name}`;if(r.has(n))return r.get(n);const a=t.call(this,...e).finally((()=>{r.delete(n)}));return r.set(n,a),a})}var t}))}}}function l(e){return e.parent??e.collection??null}function c(e,...t){let n=l(this);for(;n;)n.emit(e,...t),n=l(n)}function d(e,t){const n=l(e);return n?n.modelType===t?n:d(n,t):null}function u(e,t){return t||"ready"!==e}const p=a.extend(o(["fetch","fetchCollections"]),{modelType:"Database",idAttribute:"_id",props:{_id:"string",name:"string",status:{type:"string",default:"initial"},statusError:{type:"string",default:null},collectionsStatus:{type:"string",default:"initial"},collectionsStatusError:{type:"string",default:null},collection_count:"number",document_count:"number",storage_size:"number",data_size:"number",index_count:"number",index_size:"number"},derived:{collectionsLength:{deps:["collection_count","collectionsStatus"],fn(){return["ready","refreshing"].includes(this.collectionsStatus)?this.collections.length:this.collection_count??0}}},collections:{collections:i},async fetch({dataService:e,force:t=!1}){if(u(this.status,t))try{const t="initial"===this.status?"fetching":"refreshing";this.set({status:t});const n=await e.databaseStats(this.getId());this.set({status:"ready",statusError:null,...n})}catch(e){throw this.set({status:"error",statusError:e.message}),e}},async fetchCollections({dataService:e,fetchInfo:t=!1,force:n=!1}){if(u(this.collectionsStatus,n))try{const a="initial"===this.collectionsStatus?"fetching":"refreshing";this.set({collectionsStatus:a}),await this.collections.fetch({dataService:e,fetchInfo:t,force:n}),this.set({collectionsStatus:"ready",collectionsStatusError:null})}catch(e){throw this.set({collectionsStatus:"error",collectionsStatusError:e.message}),e}},async fetchCollectionsDetails({dataService:e,nameOnly:t=!1,force:n=!1}){await this.fetchCollections({dataService:e,fetchInfo:!t,force:n}),t||await Promise.allSettled(this.collections.map((t=>t.fetch({dataService:e,fetchInfo:!1,force:n}))))},toJSON(e={derived:!0}){return this.serialize(e)}}),m=s.extend(function(...e){return{initialize(...t){e.forEach((({initialize:e})=>{e.call(this,...t)}))}}}(o(["fetch"]),("databases",{initialize(){if(this.isCollection){this.on("add",c.bind(this,"add:databases")),this.on("remove",c.bind(this,"remove:databases")),this.on("change",c.bind(this,"change:databases"));for(const e of Object.keys(this.model.prototype._definition))this.on(`change:${e}`,c.bind(this,`change:databases.${e}`))}}})),{modelType:"DatabaseCollection",mainIndex:"_id",indexes:["name"],comparator:"_id",model:p,async fetch({dataService:e}){const t=d(this,"Instance");if(!t)throw new Error(`Trying to fetch ${this.modelType} that doesn't have the Instance parent model`);const n=await e.listDatabases({nameOnly:!0,privileges:t.auth.privileges});this.set(n.map((({_id:e,name:t})=>({_id:e,name:t}))))},toJSON(e={derived:!0}){return this.map((t=>t.toJSON(e)))}});m.prototype[Symbol.iterator]=function*(){for(let e=0,t=this.length;e<t;e++)yield this.at(e)},e.exports=p,e.exports.Collection=m},73086:(e,t,n)=>{"use strict";n.r(t),n.d(t,{activate:()=>ta,deactivate:()=>na,default:()=>aa,metadata:()=>Wn});var a=n(2784),s=n(16435),i=n(13980),r=n.n(i),o=n(50517);function l(e,t=!0,n=2){const a=t?1e3:1024;if(0===e)return`${e} B`;const s=t?["B","kB","MB","GB","TB","PB","EB","ZB","YB"]:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=Math.floor(Math.log(e)/Math.log(a));return`${(e/Math.pow(a,i)).toFixed(n)} ${s[i]}`}function c(e){return new Intl.NumberFormat("en",{notation:"compact"}).formatToParts(e).reduce(((e,t)=>"compact"===t.type?`${e} ${t.value}`:`${e}${t.value}`),"")}const d=(0,o.css)({display:"flex",gap:"1ch",flex:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:4*o.spacing[6]}),u=(0,o.css)({display:"flex",flexDirection:"column",gap:0}),p=(0,o.css)({fontWeight:"bold"}),m=(0,o.css)({position:"relative",width:"100%",minHeight:20}),h=(0,o.css)({opacity:1,transition:"opacity .16s linear"}),g=(0,o.css)({opacity:.3}),b=(0,o.css)({opacity:.3}),f=(0,o.css)({position:"absolute",top:0,left:0,bottom:0,right:0,display:"flex",opacity:0,transition:"opacity .16s ease-out"}),y=(0,o.css)({opacity:1,transitionTimingFunction:"ease-in"}),v=(0,o.keyframes)({from:{opacity:0},to:{opacity:1}}),C=(0,o.css)({animation:`${v} .16s ease-out`}),E=({label:e,value:t,status:n,hint:s,viewType:i})=>{const r=(0,a.useMemo)((()=>{const e="initial"!==n&&"fetching"!==n;return a.createElement(o.ContentWithFallback,{isContentReady:e,content:(e,s)=>{if(!e)return null;const i=null==t||"error"===n;return a.createElement("span",{className:(0,o.cx)(h,i&&b,"refreshing"===n&&g,s&&C)},i?"—":t)},fallback:e=>a.createElement("span",{className:(0,o.cx)(f,e&&y)},a.createElement(o.Placeholder,{maxChar:10}))})}),[t,n]);return a.createElement("div",{className:(0,o.cx)(d,"list"===i&&u)},a.createElement("span",{className:p},s?a.createElement(o.InlineDefinition,{tooltipProps:{align:"top",justify:"start",delay:500},definition:s},e,":"):a.createElement(a.Fragment,null,e,":")),a.createElement("span",{className:m},r))};function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},S.apply(this,arguments)}const x=(0,o.css)({display:"flex",alignItems:"center",gap:o.spacing[3],marginBottom:o.spacing[2]}),k=({children:e})=>a.createElement("div",{className:x},e),N=(0,o.css)({minWidth:0}),_=(0,o.css)({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",paddingTop:2,paddingBottom:2,color:`${o.uiColors.green.dark1} !important`,fontWeight:"600 !important"}),w=({children:e})=>a.createElement("div",{title:e,className:N},a.createElement(o.Subtitle,{as:"div",className:_},e)),D=(0,o.css)({marginLeft:"auto",flex:"none"}),R=({children:e})=>a.createElement("div",{className:D,"data-testid":"card-action-container"},e),I=(0,o.css)({display:"flex",gap:o.spacing[2],minHeight:20}),T=({children:e})=>a.createElement("div",{className:I},e),A=(0,o.css)({gap:o.spacing[1]}),O=(0,o.css)({}),V=({name:e,icon:t,variant:n,hint:s})=>{const i=(0,a.useCallback)((({className:s,children:i,...r}={})=>a.createElement(o.Badge,S({className:(0,o.cx)(A,s),variant:n},r),t&&a.createElement(o.Icon,{size:"small",glyph:t}),a.createElement("span",{className:O},e),i)),[t,e,n]);return s?a.createElement(o.Tooltip,{delay:500,trigger:i},s):i()},j=(0,o.css)({padding:o.spacing[3]}),L=(0,o.css)({display:"flex",gap:o.spacing[2],marginTop:o.spacing[3]}),z=(0,o.css)({flexDirection:"column"}),q=({id:e,type:t,name:n,status:s,data:i,onItemClick:r,onItemDeleteClick:l,badges:c=null,viewType:d,...u})=>{const[p,m]=(0,o.useHoverState)(),[h,g]=(0,o.useFocusState)(),b=(0,a.useCallback)((()=>{r(e)}),[r,e]),f=(0,o.useDefaultAction)(b),y=(0,a.useCallback)((t=>{t.stopPropagation(),l&&l(e)}),[l,e]),v=c&&a.createElement(T,null,c.map((e=>a.createElement(V,S({key:e.name},e))))),C=(0,o.mergeProps)({className:j},f,p,h,u),x=l&&([o.FocusState.FocusVisible,o.FocusState.FocusWithinVisible].includes(g)||m);return a.createElement(o.Card,S({key:e,contentStyle:"clickable","data-testid":`${t}-grid-item`,"data-id":e},C),a.createElement(k,null,a.createElement(w,null,n),"list"===d&&v,x&&a.createElement(R,null,a.createElement(o.IconButton,{"aria-label":`Delete ${t}`,title:`Delete ${t}`,onClick:y},a.createElement(o.Icon,{glyph:"Trash"})))),"grid"===d&&v,a.createElement("div",{className:(0,o.cx)(L,"grid"===d&&z)},i.map((({label:e,value:t,hint:n},i)=>a.createElement(E,{key:i,label:e,hint:n,value:t,status:s,viewType:d})))))};var P=n(6909),$=n(11586);const M="compass_items_grid_view_type",B=(0,o.css)({display:"flex",alignItems:"center",gap:o.spacing[2]}),F=(0,o.css)({margin:"0 !important",padding:"0 !important"});const{track:H}=(0,P.createLoggerAndTelemetry)("COMPASS-DATABASES-COLLECTIONS-LIST-UI"),U=(0,o.css)({paddingLeft:o.spacing[3],paddingRight:o.spacing[3],paddingBottom:o.spacing[2],columnGap:o.spacing[2]}),G=(0,o.css)({width:"100%",flex:1,overflow:"hidden",display:"grid",gridTemplateRows:"auto 1fr",gridTemplateColumns:"100%",outline:"none"}),K=(0,o.css)({display:"flex",padding:o.spacing[3],gap:o.spacing[3],flex:"none"}),W=(0,o.css)({whiteSpace:"nowrap"}),Z=(0,o.css)({flex:"none"}),Y=o.spacing[5]+36,J=(0,o.css)({marginLeft:"auto"}),X=a.createContext({createControls:null,viewTypeControls:null,sortControls:null}),Q=()=>{const{createControls:e,viewTypeControls:t,sortControls:n}=(0,a.useContext)(X);return a.createElement(a.Fragment,null,e&&a.createElement("div",{className:Z,"data-testid":"create-controls"},e),a.createElement("div",{className:Z},t),a.createElement("div",{className:(0,o.cx)(Z,J)},n))},ee=({itemType:e,itemGridWidth:t,itemGridHeight:n,itemListWidth:s=t,itemListHeight:i=n,items:r,sortBy:l=[],onItemClick:c,onDeleteItemClick:d,onCreateItemClick:u,renderItem:p})=>{const m=(0,a.useCallback)((t=>{H("Switch View Type",{view_type:t,item_type:e})}),[e]),h=function(e,t){return t?a.createElement(o.Button,{variant:"primary",onClick:()=>{t()},className:W},"Create ",e):null}(e,u),[g,b]=(0,o.useSortControls)(l),[f,y]=function({defaultViewType:e="list",onChange:t=(()=>{})}){const[n,s]=(0,a.useState)((()=>function(e="grid"){try{return window.sessionStorage.getItem(M)??e}catch{return e}}(e)));(0,a.useEffect)((()=>{!function(e){try{window.sessionStorage.setItem(M,e)}catch{}}(n)}),[n]);const i=(0,a.useCallback)((e=>{t(e),s(e)}),[t]),r=(0,$.Me)(),l=(0,$.Me)();return[(0,a.useMemo)((()=>a.createElement("div",{className:B},a.createElement(o.Label,{id:r,htmlFor:l,className:F},"View"),a.createElement(o.SegmentedControl,{id:l,"aria-labelledby":r,value:n,onChange:i},a.createElement(o.SegmentedControlOption,{value:"list"},a.createElement(o.Icon,{glyph:"Menu"})),a.createElement(o.SegmentedControlOption,{value:"grid"},a.createElement(o.Icon,{glyph:"Apps"}))))),[r,l,n,i]),n]}({onChange:m}),v=(0,o.useSortedItems)(r,b),C="grid"===y?t:s,E="grid"===y?n:i,S=r.length>0,x=(0,a.useCallback)((({index:e,...t})=>{const n=v[e];return p({item:n,viewType:y,onItemClick:c,onDeleteItemClick:d,...t})}),[p,d,c,v,y]);return a.createElement(X.Provider,{value:{createControls:h,sortControls:S?g:null,viewTypeControls:S?f:null}},a.createElement(o.VirtualGrid,{itemMinWidth:C,itemHeight:E+o.spacing[2],itemsCount:v.length,colCount:"list"===y?1:void 0,renderItem:x,itemKey:e=>v[e]._id,headerHeight:Y,renderHeader:Q,classNames:{container:G,header:K,row:U},resetActiveItemOnBlur:!1,"data-testid":`${e}-grid`}))};function te(){return te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},te.apply(this,arguments)}const ne=4*o.spacing[6],ae=({databases:e,onDatabaseClick:t,onCreateDatabaseClick:n,onDeleteDatabaseClick:s})=>a.createElement(ee,{items:e,itemType:"database",itemGridWidth:ne,itemGridHeight:154,itemListHeight:118,sortBy:[{name:"name",label:"Database Name"},{name:"storage_size",label:"Storage size"},{name:"collectionsLength",label:"Collections"},{name:"index_count",label:"Indexes"}],onItemClick:t,onDeleteItemClick:s,onCreateItemClick:n,renderItem:({item:e,onItemClick:t,onDeleteItemClick:n,viewType:s,...i})=>a.createElement(q,te({id:e._id,key:e._id,name:e.name,type:"database",viewType:s,status:e.status,data:[{label:"Storage size",value:l(e.storage_size),hint:`Uncompressed data size: ${l(e.data_size)}`},{label:"Collections",value:c(e.collectionsLength)},{label:"Indexes",value:c(e.index_count)}],onItemClick:t,onItemDeleteClick:n},i))});function se(){return se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},se.apply(this,arguments)}const ie=4*o.spacing[6],re=({collections:e,onCollectionClick:t,onCreateCollectionClick:n,onDeleteCollectionClick:s})=>a.createElement(ee,{items:e,itemType:"collection",itemGridWidth:ie,itemGridHeight:238,itemListHeight:118,sortBy:[{name:"name",label:"Collection Name"},{name:"document_count",label:"Documents"},{name:"avg_document_size",label:"Avg. document size"},{name:"storage_size",label:"Storage size"},{name:"index_count",label:"Indexes"},{name:"index_size",label:"Total index size"}],onItemClick:t,onDeleteItemClick:s,onCreateItemClick:n,renderItem:({item:e,onItemClick:t,onDeleteItemClick:n,...s})=>{const i="view"===e.type?[{label:"View on",value:e.source?.name}]:[{label:"Storage size",value:l(e.storage_size-e.free_storage_size),hint:`Uncompressed data size: ${l(e.size)}`},{label:"Documents",value:c(e.document_count)},{label:"Avg. document size",value:l(e.avg_document_size)},{label:"Indexes",value:c(e.index_count)},{label:"Total index size",value:l(e.index_size)}],r=e.properties.map((e=>function({name:e,options:t}){switch(e){case"collation":return{name:e,variant:"darkgray",hint:a.createElement(a.Fragment,null,Object.entries(t??{}).map((([e,t])=>t&&a.createElement("div",{key:e},a.createElement("strong",null,e,":")," ",t))))};case"view":return{name:e,variant:"darkgray",icon:"Visibility"};case"capped":return{name:e,variant:"darkgray"};case"timeseries":return{name:e,variant:"darkgray",icon:"TimeSeries"};default:return{name:e}}}(e)));return a.createElement(q,se({id:e._id,key:e._id,name:e.name,type:"collection",status:e.status,data:i,badges:r,onItemClick:t,onItemDeleteClick:n},s))}});var oe=n(84935),le=n.n(oe);function ce(){return ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ce.apply(this,arguments)}const{track:de}=(0,P.createLoggerAndTelemetry)("COMPASS-COLLECTIONS-UI");class ue extends a.PureComponent{static propTypes={collections:r().array.isRequired,collectionsStatus:r().object.isRequired,databaseName:r().string.isRequired,isReadonly:r().bool.isRequired,isWritable:r().bool.isRequired,isDataLake:r().bool.isRequired,onCollectionClick:r().func.isRequired,onDeleteCollectionClick:r().func.isRequired,onCreateCollectionClick:r().func.isRequired};componentDidMount(){de("Screen",{name:"collections"})}render(){const{collections:e,collectionsStatus:t,databaseName:n,isReadonly:s,isWritable:i,isDataLake:r,onCollectionClick:l,onDeleteCollectionClick:c,onCreateCollectionClick:d}=this.props;if("error"===t.status)return a.createElement("div",{className:"collections-module-collections-error__3jUlq"},a.createElement(o.Banner,{variant:o.BannerVariant.Danger},"An error occurred while loading collections",": ",t.error));const u=Object.assign({onCollectionClick:l},s||!i||r?{}:{onDeleteCollectionClick:c,onCreateCollectionClick:d});return a.createElement(re,ce({key:n,collections:e},u))}}function pe(e){return function(t){return function(n,a){const{appRegistry:s,databaseName:i}=a();s?.emit(e,le()(t??i))}}}const me={onCollectionClick:pe("collections-list-select-collection"),onDeleteCollectionClick:pe("open-drop-collection"),onCreateCollectionClick:pe("open-create-collection")},he=(0,s.$j)((e=>({collections:(e.collections||[]).map((e=>"view"===e.type?{_id:e._id,name:e.name,type:e.type,status:e.status,source:e.source,properties:e.properties}:e)),collectionsStatus:e.collectionsStatus,databaseName:e.databaseName,isReadonly:e.isReadonly,isWritable:e.isWritable,isDataLake:e.isDataLake,isGenuineMongoDB:e.isGenuineMongoDB})),me)(ue);var ge=n(12436),be=n.n(ge),fe=n(18717),ye=n(43292);const ve="aggregations/app-registry/APP_REGISTRY_ACTIVATED";function Ce(e=null,t){return t.type===ve?t.appRegistry:e}const Ee=e=>({type:ve,appRegistry:e}),Se="databases-collections/name/CHANGE_DATABASE_NAME";function xe(e="",t){return t.type===Se?t.name:e}const ke="aggregations/data-service/DATA_SERVICE_CONNECTED",Ne={error:null,dataService:null};function _e(e=Ne,t){return t.type===ke?{error:t.error,dataService:t.dataService}:e}const we=(e,t)=>({type:ke,error:e,dataService:t}),De="databases-collections/collections/SET_COLLECTIONS",Re=[],Ie={status:"initial",error:null},Te="databases-collections/is-writable/WRITE_STATE_CHANGED";function Ae(e=!0,t){return t.type===Te?t.isWritable:e}const Oe=e=>({type:Te,isWritable:e.isWritable}),Ve="home/is-data-lake/TOGGLE_IS_DATA_LAKE",je=(e=!1,t)=>t.type===Ve?t.isDataLake:e,Le=e=>({type:Ve,isDataLake:e}),ze="databases-collections/reset",qe=()=>({type:ze});function Pe(e=!1){return e}const $e=(0,fe.combineReducers)({appRegistry:Ce,databaseName:xe,collections:function(e=Re,t){switch(t.type){case De:case Se:return t.collections;default:return e}},collectionsStatus:function(e=Ie,t){return"compass-databases-collections/collections-status/COLLECTIONS_STATUS_CHANGED"===t.type?{status:t.status,error:t.error}:e},isReadonly:Pe,isWritable:Ae,isDataLake:je}),Me=[],Be="compass-databases-collections/databases/SET_DATABASES",Fe={status:"initial",error:null},He="compass-databases-collections/databases-status/DATABASES_STATUS_CHANGED",Ue=e=>({type:He,status:e.databasesStatus,error:e.databasesError}),Ge="databases-collections/is-genuine-mongodb/TOGGLE_IS_GENUINE_MONGODB",Ke=(0,fe.combineReducers)({appRegistry:Ce,databases:function(e=Me,t){return t.type===Be?t.databases:e},databasesStatus:function(e=Fe,t){return t.type===He?{status:t.status,error:t.error}:e},isReadonly:Pe,isWritable:Ae,isGenuineMongoDB:function(e=!0,t){return t.type===Ge?t.isGenuineMongoDB:e},isDataLake:je}),We=(0,fe.createStore)(((e,t)=>t.type===ze?{...e,databaseName:"",collections:Re,collectionsStatus:Ie,isReadonly:false,isWritable:true,isDataLake:false}:$e(e,t)),(0,fe.applyMiddleware)(ye.Z));We.onActivated=e=>{const t=be()((e=>{const{databaseName:t}=We.getState();e.parent.getId()===t&&We.dispatch((e=>({type:De,collections:e}))(e.toJSON()))}),300);e.on("instance-destroyed",(()=>{t.cancel(),We.dispatch(qe()),We.instance=null})),e.on("instance-created",(({instance:e})=>{We.instance=e,e.on("change:databases.collectionsStatus",(e=>{var n;(n=e).collectionsStatus,n.collectionsError,t(e.collections)})),e.on("change:collections.status",(e=>{t(e.collection)})),e.dataLake.on("change:isDataLake",((e,t)=>{We.dispatch(Le(t))}))})),e.on("select-database",(e=>{const{databaseName:t}=We.getState();e!==t&&We.dispatch(((e,t=[])=>({type:Se,name:e,collections:t}))(e,We.instance?.databases.get(e)?.collections.toJSON()??[]))})),e.getStore("DeploymentAwareness.WriteStateStore").listen((e=>{We.dispatch(Oe(e))})),e.on("data-service-connected",((e,t)=>{We.dispatch(we(e,t))})),We.dispatch(Ee(e))};const Ze=We;class Ye extends a.Component{static displayName="CollectionsPlugin";render(){return a.createElement(s.zt,{store:Ze},a.createElement(he,null))}}const Je=Ye;var Xe=n(70602);function Qe(){return Qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Qe.apply(this,arguments)}function et(){return a.createElement("div",{className:"column-container"},a.createElement("div",{className:"column main"},a.createElement("div",{"data-testid":"databases-non-genuine-warning",className:"databases-module-databases-non-genuine-warning__2uyRR"},a.createElement("div",{className:"zero-graphic zero-graphic-non-genuine-mongodb"}),a.createElement(Xe.ZeroState,{header:"Unable to display databases and collections",subtext:"This server or service appears to be emulating MongoDB. Some documented MongoDB features may work differently, may be entirely missing or incomplete, or may have unexpectedly different performance characteristics than would be found when connecting to a real MongoDB server or service."},a.createElement("a",{className:"zero-state-link",href:"https://www.mongodb.com/cloud/atlas"},"Try MongoDB Atlas")))))}class tt extends a.PureComponent{static propTypes={databases:r().array.isRequired,databasesStatus:r().object.isRequired,isReadonly:r().bool.isRequired,isWritable:r().bool.isRequired,isGenuineMongoDB:r().bool.isRequired,isDataLake:r().bool.isRequired,onDatabaseClick:r().func.isRequired,onDeleteDatabaseClick:r().func.isRequired,onCreateDatabaseClick:r().func.isRequired};render(){const{databases:e,databasesStatus:t,isReadonly:n,isWritable:s,isDataLake:i,isGenuineMongoDB:r,onDatabaseClick:l,onDeleteDatabaseClick:c,onCreateDatabaseClick:d}=this.props;if("error"===t.status)return a.createElement("div",{className:"databases-module-databases-error__2p3Ry"},a.createElement(o.Banner,{variant:o.BannerVariant.Danger},"An error occurred while loading databases",": ",t.error));if(0===e.length&&!r)return a.createElement(et,null);const u=Object.assign({onDatabaseClick:l},n||!s||i?{}:{onDeleteDatabaseClick:c,onCreateDatabaseClick:d});return a.createElement(ae,Qe({databases:e},u))}}function nt(e){return function(...t){return function(n,a){const{appRegistry:s}=a();s?.emit(e,...t)}}}const at={onDatabaseClick:nt("select-database"),onDeleteDatabaseClick:nt("open-drop-database"),onCreateDatabaseClick:nt("open-create-database")},st=(0,s.$j)((e=>({databases:e.databases,databasesStatus:e.databasesStatus,isReadonly:e.isReadonly,isWritable:e.isWritable,isGenuineMongoDB:e.isGenuineMongoDB,isDataLake:e.isDataLake})),at)(tt),it=(0,fe.createStore)(((e,t)=>t.type===ze?{...e,databases:Me,databasesStatus:Fe,isReadonly:false,isWritable:true,isGenuineMongoDB:!0,isDataLake:false}:Ke(e,t)),(0,fe.applyMiddleware)(ye.Z));it.onActivated=e=>{const t=be()((e=>{it.dispatch((e=>({type:Be,databases:e}))(e.toJSON()))}),300);e.on("instance-destroyed",(()=>{t.cancel(),it.dispatch(qe())})),e.on("instance-created",(({instance:e})=>{it.dispatch(Ue(e)),t(e.databases),e.genuineMongoDB.on("change:isGenuine",((e,t)=>{it.dispatch({type:Ge,isGenuineMongoDB:t})})),e.dataLake.on("change:isDataLake",((e,t)=>{it.dispatch(Le(t))})),e.on("change:databasesStatus",(()=>{it.dispatch(Ue(e)),t(e.databases)})),e.on("change:databases.status",(()=>{t(e.databases)}))})),e.getStore("DeploymentAwareness.WriteStateStore").listen((e=>{it.dispatch(Oe(e))})),it.dispatch(Ee(e))};const rt=it;class ot extends a.Component{static displayName="DatabasesPlugin";render(){return a.createElement(s.zt,{store:rt},a.createElement(st,null))}}const lt=ot,ct="databases-collections/server-version/SERVER_VERSION_CHANGED";function dt(e="4.0.0",t){return t.type===ct&&t.version||e}const ut=e=>({type:ct,version:e}),pt="databases-collections/is-running/TOGGLE_IS_RUNNING",mt=!1;function ht(e=!1,t){return t.type===pt?t.isRunning:e}const gt=e=>({type:pt,isRunning:e}),bt="databases-collections/is-visible/TOGGLE_IS_VISIBLE",ft=!1;function yt(e=!1,t){return t.type===bt?t.isVisible:e}const vt=e=>({type:bt,isVisible:e}),Ct="databases-collections/error",Et=`${Ct}/HANDLE_ERROR`,St=`${Ct}/CLEAR_ERROR`,xt=null;function kt(e=null,t){return t.type===Et?t.error:t.type===St?null:e}const Nt=e=>({type:Et,error:e}),_t=()=>({type:St}),wt=async e=>{if(!e.options)return{};const t=await e.options();return{isCapped:!!t.capped,hasCustomCollation:!!t.collation,collectionType:t.timeseries?"time-series":"collection"}};var Dt=n(68704);const Rt=n.n(Dt)()("compass-databases-collections:create-collection"),It="databases-collections/create-collection/OPEN",Tt=(0,fe.combineReducers)({isRunning:ht,isVisible:yt,databaseName:xe,error:kt,serverVersion:dt,dataService:_e}),At=(e,t)=>(Rt("create collection failed",t),e(gt(!1)),e(Nt(t))),Ot=navigator.userAgent.toLowerCase(),Vt=e=>()=>{if(Ot.indexOf("electron")>-1){const{shell:t}=n(72298);t.openExternal(e)}else window.open(e,"_new")};var jt=n(76635),Lt=n.n(jt);function zt({dataTestId:e,children:t}){return a.createElement("fieldset",{className:"field-set-module-field-set__9Gj34","data-testid":e},t)}zt.propTypes={dataTestId:r().string,children:r().node.isRequired};const qt=zt;function Pt({children:e,description:t,disabled:n,helpUrl:s,label:i,dataTestId:r,onToggle:l,openLink:c,toggled:d}){const u=r?`toggle-${r}`:(0,$.Me)();return a.createElement(qt,{dataTestId:r},a.createElement(o.Checkbox,{onChange:e=>{l(e.target.checked)},disabled:n,label:a.createElement(a.Fragment,null,a.createElement(o.Label,{htmlFor:u},i),t?a.createElement(o.Description,{className:"collapsible-field-set-module-description__2vgEd"},t,!!s&&!!c&&a.createElement(o.IconButton,{className:"collapsible-field-set-module-info-btn__1Z65w","aria-label":"Time-series collections documentation",onClick:()=>{c(s)}},a.createElement(o.Icon,{glyph:"InfoWithCircle",size:"small"}))):""),checked:d,bold:!0,id:u}),d?e:"")}Pt.propTypes={children:r().node,label:r().string.isRequired,dataTestId:r().string,description:r().oneOfType([r().element,r().string]),disabled:r().bool,helpUrl:r().string,onToggle:r().func.isRequired,toggled:r().bool,openLink:r().func};const $t=Pt;function Mt({cappedSize:e,isCapped:t,isTimeSeries:n,onChangeCappedSize:s,onChangeIsCapped:i,openLink:r}){return a.createElement($t,{toggled:t,disabled:n,onToggle:e=>i(e),label:"Capped Collection",dataTestId:"capped-collection-fields",helpUrl:"https://docs.mongodb.com/manual/core/capped-collections/",openLink:r,description:"Fixed-size collections that support high-throughput operations that insert and retrieve documents based on insertion order."},a.createElement(o.TextInput,{value:e,label:"size","data-testid":"capped-size",type:"number",description:"Maximum size in bytes for the capped collection.",onChange:e=>s(e.target.value),spellCheck:!1}))}Mt.propTypes={cappedSize:r().string.isRequired,isCapped:r().bool.isRequired,isTimeSeries:r().bool.isRequired,onChangeCappedSize:r().func.isRequired,onChangeIsCapped:r().func.isRequired,openLink:r().func.isRequired};const Bt=Mt;function Ft({collectionName:e,onChangeCollectionName:t}){return a.createElement(qt,null,a.createElement(o.TextInput,{required:!0,label:"Collection Name","data-testid":"collection-name",onChange:e=>t(e.target.value),value:e,spellCheck:!1}))}Ft.propTypes={collectionName:r().string.isRequired,onChangeCollectionName:r().func.isRequired};const Ht=Ft;function Ut({databaseName:e,onChangeDatabaseName:t}){return a.createElement(qt,null,a.createElement(o.TextInput,{required:!0,label:"Database Name","data-testid":"database-name",onChange:e=>t(e.target.value),value:e,spellCheck:!1}))}Ut.propTypes={databaseName:r().string.isRequired,onChangeDatabaseName:r().func.isRequired};const Gt=Ut;var Kt=n(48138),Wt=n.n(Kt);const Zt=["seconds","minutes","hours"];function Yt({isCapped:e,isTimeSeries:t,onChangeIsTimeSeries:n,onChangeTimeSeriesField:s,timeSeries:i,expireAfterSeconds:r}){const{granularity:l,metaField:c,timeField:d}=i,u=(0,a.useCallback)((e=>{const{name:t,value:n}=e.currentTarget;s(t,n)}),[s]);return a.createElement($t,{disabled:e,onToggle:e=>n(e),toggled:t,label:"Time-Series",dataTestId:"time-series-fields",description:"Time-series collections efficiently store sequences of measurements over a period of time."},a.createElement(qt,null,a.createElement(o.TextInput,{value:d,label:"timeField",name:"timeSeries.timeField",description:"Specify which field should be used as timeField for the time-series collection. This field must have a BSON type date.",required:!0,onChange:u,spellCheck:!1})),a.createElement(qt,null,a.createElement(o.TextInput,{label:"metaField",name:"timeSeries.metaField",description:"The metaField is the designated field for metadata.",optional:!0,value:c,onChange:u,spellCheck:!1})),a.createElement(qt,null,a.createElement(o.Select,{id:"timeSeries-granularity",className:"time-series-fields-module-options-select-dropdown__3to9V",label:"granularity",name:"timeSeries.granularity",placeholder:"Select a value [optional]",description:"The granularity field allows specifying a coarser granularity so measurements over a longer time span can be more efficiently stored and queried.",onChange:e=>s("timeSeries.granularity",e),usePortal:!1,allowDeselect:!1,value:l},Zt.map((e=>a.createElement(o.Option,{key:e,value:e},e))))),a.createElement(qt,null,a.createElement(o.TextInput,{value:r,label:"expireAfterSeconds",name:"expireAfterSeconds",description:"The expireAfterSeconds field enables automatic deletion of documents older than the specified number of seconds.",optional:!0,type:"number",onChange:u,spellCheck:!1})))}Yt.propTypes={isCapped:r().bool.isRequired,isTimeSeries:r().bool.isRequired,onChangeIsTimeSeries:r().func.isRequired,onChangeTimeSeriesField:r().func.isRequired,timeSeries:r().object.isRequired,expireAfterSeconds:r().string.isRequired};const Jt=Yt,Xt=[{field:"locale",values:[{value:"af",label:"af - Afrikaans"},{value:"sq",label:"sq - Albanian"},{value:"am",label:"am - Amharic"},{value:"ar",label:"ar - Arabic"},{value:"ar@collation=compat",label:"ar - Arabic - compat"},{value:"hy",label:"hy - Armenian"},{value:"as",label:"as - Assamese"},{value:"az",label:"az - Azeri"},{value:"az@collation=search",label:"az - Azeri - search"},{value:"be",label:"be - Belarusian"},{value:"bn",label:"bn - Bengali"},{value:"bn@collation=traditional",label:"bn - Bengali - traditional"},{value:"bs",label:"bs - Bosnian"},{value:"bs@collation=search",label:"bs - Bosnian - search"},{value:"bs_Cyrl",label:"bs_Cyrl - Bosnian (Cyrillic)"},{value:"bg",label:"bg - Bulgarian"},{value:"my",label:"my - Burmese"},{value:"ca",label:"ca - Catalan"},{value:"ca@collation=search",label:"ca - Catalan - search"},{value:"chr",label:"chr - Cherokee"},{value:"zh",label:"zh - Chinese"},{value:"zh@collation=big5han",label:"zh - Chinese - big5han"},{value:"zh@collation=gb2312han",label:"zh - Chinese - gb2312han"},{value:"zh@collation=pinyin",label:"zh - Chinese - pinyin"},{value:"zh@collation=unihan",label:"zh - Chinese - unihan"},{value:"zh@collation=zhuyin",label:"zh - Chinese - zhuyin"},{value:"zh_Hant",label:"zh_Hant - Chinese (Traditional)"},{value:"zh_Hant@collation=stroke",label:"zh_Hant - Chinese (Traditional) - stroke"},{value:"hr",label:"hr - Croatian"},{value:"hr@collation=search",label:"hr - Croatian - search"},{value:"cs",label:"cs - Czech"},{value:"cs@collation=search",label:"cs - Czech - search"},{value:"da",label:"da - Danish"},{value:"da@collation=search",label:"da - Danish - search"},{value:"nl",label:"nl - Dutch"},{value:"dz",label:"dz - Dzongkha"},{value:"en",label:"en - English"},{value:"en_US",label:"en_US - English (United States)"},{value:"en_US_POSIX",label:"en_US_POSIX - English (United States, Computer)"},{value:"eo",label:"eo - Esperanto"},{value:"et",label:"et - Estonian"},{value:"ee",label:"ee - Ewe"},{value:"fo",label:"fo - Faroese"},{value:"fil",label:"fil - Filipino"},{value:"fi_FI",label:"fi_FI - Finnish"},{value:"fi_FI@collation=search",label:"fi_FI - Finnish - search"},{value:"fi_FI@collation=traditional",label:"fi_FI - Finnish - traditional"},{value:"fr",label:"fr - French"},{value:"fr_CA",label:"fr_CA - French (Canada)"},{value:"gl",label:"gl - Galician"},{value:"gl@collation=search",label:"gl - Galician - search"},{value:"ka",label:"ka - Georgian"},{value:"de",label:"de - German"},{value:"de@collation=search",label:"de - German - search"},{value:"de@collation=eor",label:"de - German - eor"},{value:"de@collation=phonebook",label:"de - German - phonebook"},{value:"de_AT",label:"de_AT - German (Austria)"},{value:"de_AT@collation=phonebook",label:"de_AT - German (Austria) - phonebook"},{value:"el",label:"el - Greek"},{value:"gu",label:"gu - Gujarati"},{value:"ha",label:"ha - Hausa"},{value:"haw",label:"haw - Hawaiian"},{value:"he",label:"he - Hebrew"},{value:"he@collation=search",label:"he - Hebrew - search"},{value:"hi",label:"hi - Hindi"},{value:"hu",label:"hu - Hungarian"},{value:"is",label:"is - Icelandic"},{value:"is@collation=search",label:"is - Icelandic - search"},{value:"ig",label:"ig - Igbo"},{value:"smn",label:"smn - Inari Sami"},{value:"smn@collation=search",label:"smn - Inari Sami - search"},{value:"id",label:"id - Indonesian"},{value:"ga",label:"ga - Irish"},{value:"it",label:"it - Italian"},{value:"ja",label:"ja - Japanese"},{value:"ja@collation=unihan",label:"ja - Japanese - unihan"},{value:"kl",label:"kl - Kalaallisut"},{value:"kl@collation=search",label:"kl - Kalaallisut - search"},{value:"kn",label:"kn - Kannada"},{value:"kn@collation=traditional",label:"kn - Kannada - traditional"},{value:"kk",label:"kk - Kazakh"},{value:"km",label:"km - Khmer"},{value:"kok",label:"kok - Konkani"},{value:"ko",label:"ko - Korean"},{value:"ko@collation=search",label:"ko - Korean - search"},{value:"ko@collation=searchjl",label:"ko - Korean - searchjl"},{value:"ko@collation=unihan",label:"ko - Korean - unihan"},{value:"ky",label:"ky - Kyrgyz"},{value:"lk",label:"lk - Lakota"},{value:"lo",label:"lo - Lao"},{value:"lv",label:"lv - Latvian"},{value:"li",label:"li - Lingala"},{value:"li@collation=phonetic",label:"li - Lingala - phonetic"},{value:"lt",label:"lt - Lithuanian"},{value:"dsb",label:"dsb - Lower Sorbian"},{value:"lb",label:"lb - Luxembourgish"},{value:"mk",label:"mk - Macedonian"},{value:"ms",label:"ms - Malay"},{value:"ml",label:"ml - Malayalam"},{value:"mt",label:"mt - Maltese"},{value:"mr",label:"mr - Marathi"},{value:"mn",label:"mn - Mongolian"},{value:"ne",label:"ne - Nepali"},{value:"se",label:"se - Northern Sami"},{value:"se@collation=search",label:"se - Northern Sami - search"},{value:"nb",label:"nb - Norwegian Bokmål"},{value:"nb@collation=search",label:"nb - Norwegian Bokmål - search"},{value:"nn",label:"nn - Norwegian Nynorsk"},{value:"nn@collation=search",label:"nn - Norwegian Nynorsk - search"},{value:"or",label:"or - Oriya"},{value:"om",label:"om - Oromo"},{value:"ps",label:"ps - Pashto"},{value:"fa",label:"fa - Persian"},{value:"fa_AF",label:"fa_AF - Persian (Afghanistan)"},{value:"pl",label:"pl - Polish"},{value:"pt",label:"pt - Portuguese"},{value:"pa",label:"pa - Punjabi"},{value:"ro",label:"ro - Romanian"},{value:"ru",label:"ru - Russian"},{value:"sr",label:"sr - Serbian"},{value:"sr_Latn",label:"sr_Latn - Serbian (Latin)"},{value:"sr_Latn@collation=search",label:"sr_Latn - Serbian (Latin) - search"},{value:"si",label:"si - Sinhala"},{value:"si@collation=dictionary",label:"si - Sinhala - dictionary"},{value:"sk",label:"sk - Slovak"},{value:"sk@collation=search",label:"sk - Slovak - search"},{value:"sl",label:"sl - Slovenian"},{value:"es",label:"es - Spanish"},{value:"es@collation=search",label:"es - Spanish - search"},{value:"es@collation=traditional",label:"es - Spanish - traditional"},{value:"sw",label:"sw - Swahili"},{value:"sv",label:"sv - Swedish"},{value:"sv@collation=search",label:"sv - Swedish - search"},{value:"ta",label:"ta - Tamil"},{value:"te",label:"te - Telugu"},{value:"th",label:"th - Thai"},{value:"bo",label:"bo - Tibetan"},{value:"to",label:"to - Tongan"},{value:"tr",label:"tr - Turkish"},{value:"tr@collation=search",label:"tr - Turkish - search"},{value:"uk",label:"uk - Ukrainian"},{value:"hsb",label:"hsb - Upper Sorbian"},{value:"ur",label:"ur - Urdu"},{value:"ug",label:"ug - Uyghur"},{value:"vi",label:"vi - Vietnamese"},{value:"vi@collation=traditional",label:"vi - Vietnamese - traditional"},{value:"wae",label:"wae - Walser"},{value:"cy",label:"cy - Welsh"},{value:"yi",label:"yi - Yiddish"},{value:"yi@collation=search",label:"yi - Yiddish - search"},{value:"yo",label:"yo - Yoruba"},{value:"zu",label:"zu - Zulu"},{value:"simple",label:"simple"}],required:!0},{field:"strength",label:"Strength",values:[1,2,3,4,5]},{field:"caseLevel",values:[{value:!0,label:"true"},{value:!1,label:"false"}]},{field:"caseFirst",label:"Case First",values:["upper","lower","off"]},{field:"numericOrdering",values:[{value:!0,label:"true"},{value:!1,label:"false"}]},{field:"alternate",label:"Alternate",values:["non-ignorable","shifted"]},{field:"maxVariable",label:"Max-Variable",values:["punct","space"]},{field:"backwards",values:[{value:!0,label:"true"},{value:!1,label:"false"}]},{field:"normalization",values:[{value:!0,label:"true"},{value:!1,label:"false"}]}];function Qt({collation:e,changeCollationOption:t}){return Xt.map((n=>a.createElement(qt,{key:n.field},a.createElement(o.Select,{id:`collation-field-${n.field}`,className:"collation-fields-module-options-select-dropdown__2ottj",label:n.field,name:n.field,placeholder:"Select a value"+(n.required?"":" [optional]"),onChange:e=>{return t(n.field,(a=e,Object.is(+a,NaN)?"false"!==a&&("true"===a||a):+a));var a},usePortal:!1,size:o.SelectSize.Small,allowDeselect:!1,value:Lt().isNil(e[n.field])?"":String(e[n.field])},function(e){const t=e.map((e=>({value:"object"==typeof e?e.value:e,label:"object"==typeof e?e.label:e})));return Lt().sortBy(t,"value").map((({value:e,label:t})=>a.createElement(o.Option,{key:t,value:`${e}`},t)))}(n.values)))))}Qt.propTypes={collation:r().object.isRequired,changeCollationOption:r().func.isRequired};const en=Qt;function tn({collation:e,isCustomCollation:t,onChangeCollationOption:n,onChangeIsCustomCollation:s,openLink:i}){return a.createElement($t,{onToggle:e=>{s(e)},label:"Use Custom Collation",dataTestId:"use-custom-collation-fields",toggled:t,description:"Collation allows users to specify language-specific rules for string comparison, such as rules for lettercase and accent marks.",helpUrl:"https://docs.mongodb.com/master/reference/collation/",openLink:i},a.createElement(en,{collation:e,changeCollationOption:n}))}tn.propTypes={collation:r().object.isRequired,isCustomCollation:r().bool.isRequired,onChangeCollationOption:r().func.isRequired,onChangeIsCustomCollation:r().func.isRequired,openLink:r().func.isRequired};const nn=tn;function an(e){return!Lt().isNil(e)&&`${e}`?+e:void 0}function sn(e){const t={};for(const[n,a]of Object.entries(e))Lt().isNil(a)||Lt().isString(a)&&""===a.trim()||(t[n]=Lt().isObjectLike(a)?sn(a):a);return t}class rn extends a.PureComponent{static propTypes={onChange:r().func.isRequired,openLink:r().func.isRequired,serverVersion:r().string,withDatabase:r().bool};state={isCapped:!1,isCustomCollation:!1,isTimeSeries:!1,fields:{cappedSize:"",collation:{},collectionName:"",databaseName:"",timeSeries:{},expireAfterSeconds:""}};setField(e,t){const n=Lt().cloneDeep(this.state.fields);Lt().set(n,e,t),this.setState({fields:n},this.updateOptions)}updateOptions=()=>{this.props.onChange({database:this.state.fields.databaseName,collection:this.state.fields.collectionName,options:this.buildOptions()})};buildOptions(){const{isCapped:e,isCustomCollation:t,isTimeSeries:n,fields:a}=this.state,s=e?{capped:!0,size:an(a.cappedSize)}:{};return sn({...t?{collation:a.collation}:{},...s,...n?{timeseries:a.timeSeries,expireAfterSeconds:an(a.expireAfterSeconds)}:{}})}render(){const{openLink:e,serverVersion:t,withDatabase:n}=this.props,{fields:s,isCapped:i,isCustomCollation:r,isTimeSeries:o}=this.state,{collectionName:l,databaseName:c,cappedSize:d,collation:u,timeSeries:p,expireAfterSeconds:m}=s;return a.createElement(a.Fragment,null,n&&a.createElement(Gt,{databaseName:c,onChangeDatabaseName:e=>this.setField("databaseName",e)}),a.createElement(Ht,{collectionName:l,onChangeCollectionName:e=>this.setField("collectionName",e)}),a.createElement(Bt,{cappedSize:`${d}`,isCapped:i,isTimeSeries:o,onChangeCappedSize:e=>this.setField("cappedSize",e),onChangeIsCapped:e=>this.setState({isCapped:e},this.updateOptions),openLink:e}),a.createElement(nn,{collation:u,onChangeCollationOption:(e,t)=>{this.setField(`collation.${e}`,t)},onChangeIsCustomCollation:e=>this.setState({isCustomCollation:e},this.updateOptions),isCustomCollation:r,openLink:e}),function(e){try{return Wt().gte(e,"5.0.0-alpha0")}catch(e){return!0}}(t)&&a.createElement(Jt,{isCapped:i,isTimeSeries:o,onChangeIsTimeSeries:e=>this.setState({isTimeSeries:e},this.updateOptions),onChangeTimeSeriesField:(e,t)=>this.setField(e,t),timeSeries:p,expireAfterSeconds:m}))}}const on=rn;class ln extends a.PureComponent{static propTypes={error:r().object,clearError:r().func,createCollection:r().func.isRequired,isRunning:r().bool.isRequired,isVisible:r().bool.isRequired,serverVersion:r().string.isRequired,toggleIsVisible:r().func.isRequired,openLink:r().func.isRequired};constructor(){super(),this.state={data:{}}}onCancel=()=>this.props.toggleIsVisible(!1);onConfirm=()=>{this.props.createCollection(this.state.data)};onChange=e=>{this.setState({data:e})};renderError(){if(this.props.error)return a.createElement(o.Banner,{variant:"danger",dismissible:!0,onClose:this.props.clearError},this.props.error.message)}render(){return a.createElement(o.ConfirmationModal,{title:"Create Collection",open:this.props.isVisible,onConfirm:this.onConfirm,onCancel:this.onCancel,buttonText:"Create Collection",submitDisabled:!(this.state.data.collection||"").trim(),className:"create-collection-modal-module-create-collection-modal__2cNh8",trackingId:"create_collection_modal"},a.createElement(on,{serverVersion:this.props.serverVersion,withDatabase:!1,onChange:this.onChange,openLink:this.props.openLink}),this.renderError())}}const cn=(0,s.$j)((e=>({isRunning:e.isRunning,isVisible:e.isVisible,error:e.error,serverVersion:e.serverVersion})),{createCollection:e=>(t,n)=>{const a=n(),s=a.dataService.dataService,i=a.databaseName,r=e.collection,o=`${i}.${r}`;t(_t());try{t(gt(!0)),s.createCollection(o,e.options,((e,n)=>{if(e)return At(t,e);wt(n).then((e=>{global.hadronApp.appRegistry.emit("compass:collection:created",e)})),global.hadronApp.appRegistry.emit("collection-created",{ns:o,database:i,collection:r}),t(qe())}))}catch(e){return At(t,e)}},openLink:Vt,toggleIsVisible:vt,clearError:_t})(ln),dn=(0,fe.createStore)(((e,t)=>{const n={...e,isRunning:mt,isVisible:ft,databaseName:"",error:xt};return t.type===ze?n:t.type===It?{...n,isVisible:!0,databaseName:t.databaseName}:Tt(e,t)}),(0,fe.applyMiddleware)(ye.Z));dn.onActivated=e=>{e.on("data-service-connected",((e,t)=>{dn.dispatch(we(e,t))})),e.on("server-version-changed",(e=>{dn.dispatch(ut(e))})),e.on("open-create-collection",(({database:e})=>{dn.dispatch({type:It,databaseName:e})}))};const un=dn;class pn extends a.Component{static displayName="CreateCollectionPlugin";render(){return a.createElement(s.zt,{store:un},a.createElement(cn,null))}}const mn=pn,hn="databases-collections/drop-collection/name/CHANGE_NAME",gn="databases-collections/drop-collection/name/CHANGE_NAME_CONFIRMATION",bn="databases-collections/drop-collection/OPEN",fn=(0,fe.combineReducers)({isRunning:ht,isVisible:yt,name:function(e="",t){return t.type===hn?t.name:e},nameConfirmation:function(e="",t){return t.type===gn?t.nameConfirmation:e},databaseName:xe,error:kt,dataService:_e}),yn=(e,t)=>(e(gt(!1)),e(Nt(t))),vn={"drop-collection-modal-confirm":"drop-collection-modal-module-drop-collection-modal-confirm__1FRYw","drop-collection-modal-confirm-namespace":"drop-collection-modal-module-drop-collection-modal-confirm-namespace__3hiCM","drop-collection-modal-confirm-name":"drop-collection-modal-module-drop-collection-modal-confirm-name__1YjCB"};class Cn extends a.PureComponent{static displayName="DropCollectionModalComponent";static propTypes={isRunning:r().bool.isRequired,isVisible:r().bool.isRequired,name:r().string.isRequired,nameConfirmation:r().string.isRequired,error:r().object,changeCollectionNameConfirmation:r().func.isRequired,dropCollection:r().func.isRequired,toggleIsVisible:r().func.isRequired};onNameConfirmationChange=e=>{this.props.changeCollectionNameConfirmation(e.target.value)};onHide=()=>{this.props.toggleIsVisible(!1)};onFormSubmit=e=>{e.preventDefault(),e.stopPropagation(),this.props.name===this.props.nameConfirmation&&this.props.dropCollection()};render(){return a.createElement(o.ConfirmationModal,{title:"Drop Collection",open:this.props.isVisible,onConfirm:this.props.dropCollection,onCancel:this.onHide,buttonText:"Drop Collection",variant:"danger",submitDisabled:this.props.name!==this.props.nameConfirmation,className:vn["drop-collection-modal"],trackingId:"drop_collection_modal"},a.createElement("div",null,a.createElement("p",{className:vn["drop-collection-modal-confirm"]},a.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),"To drop",a.createElement("span",{className:vn["drop-collection-modal-confirm-namespace"]},this.props.name),"type the collection name",a.createElement("span",{className:vn["drop-collection-modal-confirm-name"]},this.props.name),".")),a.createElement("form",{name:"drop-collection-modal-form",onSubmit:this.onFormSubmit,"data-test-id":"drop-collection-modal"},a.createElement("div",{className:"form-group"},a.createElement("input",{type:"text",className:"form-control","data-test-id":"confirm-drop-collection-name",value:this.props.nameConfirmation,onChange:this.onNameConfirmationChange})),this.props.error?a.createElement(Xe.ModalStatusMessage,{icon:"times",message:this.props.error.message,type:"error"}):null,this.props.isRunning?a.createElement(Xe.ModalStatusMessage,{icon:"spinner",message:"Drop in Progress",type:"in-progress"}):null))}}const En=(0,s.$j)((e=>({isRunning:e.isRunning,isVisible:e.isVisible,name:e.name,nameConfirmation:e.nameConfirmation,error:e.error})),{changeCollectionName:e=>({type:hn,name:e}),changeCollectionNameConfirmation:e=>({type:gn,nameConfirmation:e}),dropCollection:()=>(e,t)=>{const n=t(),a=n.dataService.dataService,s=n.name,i=n.databaseName;e(_t());try{e(gt(!0));const t=`${i}.${s}`;a.dropCollection(t,(n=>{if(n)return yn(e,n);global.hadronApp.appRegistry.emit("collection-dropped",t),global.hadronApp.appRegistry.emit("refresh-data"),e(qe())}))}catch(t){return yn(e,t)}},toggleIsVisible:vt})(Cn),Sn=(0,fe.createStore)(((e,t)=>t.type===ze?{...e,isRunning:mt,isVisible:ft,name:"",nameConfirmation:"",databaseName:"",error:xt}:t.type===bn?{...e,isVisible:!0,name:t.collectionName,databaseName:t.databaseName,isRunning:mt,nameConfirmation:"",error:xt}:fn(e,t)),(0,fe.applyMiddleware)(ye.Z));Sn.onActivated=e=>{e.on("data-service-connected",((e,t)=>{Sn.dispatch(we(e,t))})),e.on("open-drop-collection",(({database:e,collection:t})=>{Sn.dispatch({type:bn,collectionName:t,databaseName:e})}))};const xn=Sn;class kn extends a.Component{static displayName="DropCollectionPlugin";render(){return a.createElement(s.zt,{store:xn},a.createElement(En,null))}}const Nn=kn,_n="databases-collections/create-database/OPEN",wn=(0,fe.combineReducers)({isRunning:ht,isVisible:yt,error:kt,serverVersion:dt,dataService:_e}),Dn=(e,t)=>(e(gt(!1)),e(Nt(t)));class Rn extends a.PureComponent{static displayName="CreateDatabaseModalComponent";static propTypes={isRunning:r().bool.isRequired,isVisible:r().bool.isRequired,error:r().object,createDatabase:r().func.isRequired,toggleIsVisible:r().func.isRequired,clearError:r().func.isRequired,serverVersion:r().string.isRequired,openLink:r().func.isRequired};state={data:{}};onDismissErrorMessage=()=>{this.props.clearError()};onCancel=()=>this.props.toggleIsVisible(!1);onConfirm=()=>{this.props.createDatabase(this.state.data)};onChange=e=>{this.setState({data:e})};renderError(){if(this.props.error)return a.createElement(o.Banner,{variant:"danger",dismissible:!0,onClose:this.props.clearError},this.props.error.message)}renderCollectionNameRequiredNotice(){return a.createElement(o.Banner,{className:"create-database-modal-module-collection-name-info-banner__2zlnV",variant:"info"},"Before MongoDB can save your new database, a collection name must also be specified at the time of creation. ",a.createElement(o.Link,{href:"https://docs.mongodb.com/manual/faq/fundamentals/#how-do-i-create-a-database-and-a-collection",target:"_blank"},"More Information"))}render(){const e=!!(this.state.data.collection||"").trim();return a.createElement(o.ConfirmationModal,{title:"Create Database",open:this.props.isVisible,onConfirm:this.onConfirm,onCancel:this.onCancel,buttonText:"Create Database",submitDisabled:!e||!(this.state.data.database||"").trim(),className:"create-database-modal-module-create-database-modal__HX_-p",trackingId:"create_database_modal"},a.createElement(on,{serverVersion:this.props.serverVersion,withDatabase:!0,onChange:this.onChange,openLink:this.props.openLink}),!e&&this.renderCollectionNameRequiredNotice(),this.renderError())}}const In=(0,s.$j)((e=>({isRunning:e.isRunning,isVisible:e.isVisible,serverVersion:e.serverVersion,error:e.error})),{createDatabase:e=>(t,n)=>{const a=n().dataService.dataService,s=e.database,i=e.collection;if(t(_t()),s.includes("."))return t(Nt(new Error('Database names may not contain a "."')));try{t(gt(!0)),a.createCollection(`${s}.${i}`,e.options,((e,n)=>{if(e)return Dn(t,e);wt(n).then((e=>{global.hadronApp.appRegistry.emit("compass:collection:created",e)})),global.hadronApp.appRegistry.emit("collection-created",{ns:`${s}.${i}`,database:s,collection:i}),t(qe())}))}catch(e){return Dn(t,e)}},openLink:Vt,toggleIsVisible:vt,clearError:_t})(Rn),Tn=(0,fe.createStore)(((e,t)=>t.type===ze?{...e,isRunning:mt,isVisible:ft,error:xt}:t.type===_n?{...e,isVisible:!0,isRunning:mt,error:xt}:wn(e,t)),(0,fe.applyMiddleware)(ye.Z));Tn.onActivated=e=>{e.on("data-service-connected",((e,t)=>{Tn.dispatch(we(e,t))})),e.on("server-version-changed",(e=>{Tn.dispatch(ut(e))})),e.on("open-create-database",(()=>{Tn.dispatch({type:_n})}))};const An=Tn;class On extends a.Component{static displayName="CreateDatabasePlugin";render(){return a.createElement(s.zt,{store:An},a.createElement(In,null))}}const Vn=On,jn="databases-collections/drop-database/name/CHANGE_NAME",Ln="databases-collections/drop-database/name/CHANGE_NAME_CONFIRMATION",zn="databases-collections/drop-database/OPEN",qn=(0,fe.combineReducers)({isRunning:ht,isVisible:yt,name:function(e="",t){return t.type===jn?t.name:e},nameConfirmation:function(e="",t){return t.type===Ln?t.nameConfirmation:e},error:kt,dataService:_e}),Pn=(e,t)=>(e(gt(!1)),e(Nt(t))),$n={"drop-database-modal-confirm":"drop-database-modal-module-drop-database-modal-confirm__2pNgo","drop-database-modal-confirm-namespace":"drop-database-modal-module-drop-database-modal-confirm-namespace__3jvWr","drop-database-modal-confirm-name":"drop-database-modal-module-drop-database-modal-confirm-name__229T_"};class Mn extends a.PureComponent{static displayName="DropDatabaseModalComponent";static propTypes={isRunning:r().bool.isRequired,isVisible:r().bool.isRequired,name:r().string.isRequired,nameConfirmation:r().string.isRequired,error:r().object,changeDatabaseName:r().func.isRequired,changeDatabaseNameConfirmation:r().func.isRequired,dropDatabase:r().func.isRequired,toggleIsVisible:r().func.isRequired};onNameChange=e=>{this.props.changeDatabaseName(e.target.value)};onNameConfirmationChange=e=>{this.props.changeDatabaseNameConfirmation(e.target.value)};onHide=()=>{this.props.toggleIsVisible(!1)};onFormSubmit=e=>{e.preventDefault(),e.stopPropagation(),this.props.name===this.props.nameConfirmation&&this.props.dropDatabase()};render(){return a.createElement(o.ConfirmationModal,{title:"Drop Database",open:this.props.isVisible,onConfirm:this.props.dropDatabase,onCancel:this.onHide,buttonText:"Drop Database",variant:"danger",submitDisabled:this.props.name!==this.props.nameConfirmation,className:$n["drop-database-modal"],trackingId:"drop_database_modal"},a.createElement("div",null,a.createElement("p",{className:$n["drop-database-modal-confirm"]},a.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}),"To drop",a.createElement("span",{className:$n["drop-database-modal-confirm-namespace"]},this.props.name),"type the database name",a.createElement("span",{className:$n["drop-database-modal-confirm-name"]},this.props.name),".")),a.createElement("form",{name:"drop-database-modal-form",onSubmit:this.onFormSubmit,"data-test-id":"drop-database-modal"},a.createElement("div",{className:"form-group"},a.createElement("input",{type:"text",className:"form-control","data-test-id":"confirm-drop-database-name",value:this.props.nameConfirmation,onChange:this.onNameConfirmationChange})),this.props.error?a.createElement(Xe.ModalStatusMessage,{icon:"times",message:this.props.error.message,type:"error"}):null,this.props.isRunning?a.createElement(Xe.ModalStatusMessage,{icon:"spinner",message:"Drop in Progress",type:"in-progress"}):null))}}const Bn=(0,s.$j)((e=>({isRunning:e.isRunning,isVisible:e.isVisible,name:e.name,nameConfirmation:e.nameConfirmation,error:e.error})),{changeDatabaseName:e=>({type:jn,name:e}),changeDatabaseNameConfirmation:e=>({type:Ln,nameConfirmation:e}),dropDatabase:()=>(e,t)=>{const n=t(),a=n.dataService.dataService,s=n.name;e(_t());try{e(gt(!0)),a.dropDatabase(s,(t=>{if(t)return Pn(e,t);global.hadronApp.appRegistry.emit("database-dropped",s),global.hadronApp.appRegistry.emit("refresh-data"),e(qe())}))}catch(t){return Pn(e,t)}},toggleIsVisible:vt})(Mn),Fn=(0,fe.createStore)(((e,t)=>t.type===ze?{...e,isRunning:mt,isVisible:ft,name:"",nameConfirmation:"",error:xt}:t.type===zn?{...e,isVisible:!0,name:t.name,isRunning:mt,nameConfirmation:"",error:xt}:qn(e,t)),(0,fe.applyMiddleware)(ye.Z));Fn.onActivated=e=>{e.on("data-service-connected",((e,t)=>{Fn.dispatch(we(e,t))})),e.on("open-drop-database",(e=>{Fn.dispatch({type:zn,name:e})}))};const Hn=Fn;class Un extends a.Component{static displayName="DropDatabasePlugin";render(){return a.createElement(s.zt,{store:Hn},a.createElement(Bn,null))}}const Gn=Un,Kn=en,Wn=JSON.parse('{"name":"@mongodb-js/compass-databases-collections","productName":"Compass Databases and Collections Plugin","version":"0.22.0","apiVersion":"3.0.0","description":"Plugin for viewing the list of, creating, and dropping databases and collections","main":"lib/index.js","exports":{"webpack":"./src/index.js","require":"./lib/index.js"},"scripts":{"clean":"rimraf lib","precompile":"npm run clean","compile":"cross-env NODE_ENV=production webpack --config ./config/webpack.prod.config.js","start":"webpack-dev-server --config ./config/webpack.dev.config.js","start:watch":"npm run clean && webpack --config ./config/webpack.watch.config.js","test":"cross-env NODE_ENV=test mocha","test:watch":"cross-env NODE_ENV=test mocha --watch","cover":"nyc npm run test","test-check-ci":"npm run cover && npm run check","check":"npm run lint && npm run depcheck","prepublishOnly":"npm run compile","lint":"eslint \\"./src/**/*.{js,jsx}\\" \\"./test/**/*.js\\" \\"./electron/**/*.js\\" \\"./config/**/*.{js,jsx}\\"","depcheck":"depcheck","test-ci":"npm run test","bootstrap":"npm run compile"},"license":"SSPL","peerDependencies":{"@mongodb-js/compass-components":"^0.13.0","debug":"*","hadron-ipc":"^2.9.0","hadron-react-buttons":"^5.7.0","hadron-react-components":"^5.13.0","numeral":"*","prop-types":"^15.7.2","react":"^16.14.0","react-dom":"^16.14.0","react-redux":"^5.0.6","react-select-plus":"^1.2.0","react-tooltip":"^3.11.1","redux":"^4.1.2","redux-thunk":"^2.3.0"},"devDependencies":{"@babel/cli":"^7.14.3","@babel/core":"^7.14.3","@babel/plugin-proposal-decorators":"^7.14.2","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/preset-env":"^7.14.2","@babel/preset-react":"^7.13.13","@babel/register":"^7.13.16","@mongodb-js/compass-components":"^0.13.0","@mongodb-js/compass-deployment-awareness":"^11.21.0","@mongodb-js/compass-logging":"^0.10.0","@mongodb-js/databases-collections-list":"^0.6.0","@mongodb-js/mocha-config-compass":"^0.10.0","autoprefixer":"^9.7.4","babel-loader":"^8.2.2","chai":"^4.2.0","core-js":"^3.12.1","cross-env":"^7.0.0","css-loader":"^4.3.0","debug":"4.3.0","depcheck":"^1.4.1","electron":"^13.5.1","enzyme":"^3.11.0","eslint":"^7.25.0","eslint-config-mongodb-js":"^5.0.3","extract-text-webpack-plugin":"^4.0.0-beta.0","file-loader":"^5.1.0","font-awesome":"^4.7.0","hadron-app":"^4.21.0","hadron-app-registry":"^8.10.0","hadron-ipc":"^2.9.0","hadron-react-buttons":"^5.7.0","hadron-react-components":"^5.13.0","html-webpack-plugin":"^3.2.0","ignore-loader":"^0.1.2","istanbul-instrumenter-loader":"^3.0.1","less":"^3.11.1","less-loader":"^7.3.0","mocha":"^8.4.0","mongodb-collection-model":"^4.21.0","mongodb-connection-model":"^21.15.0","mongodb-data-service":"^21.19.0","mongodb-instance-model":"^11.21.0","mongodb-ns":"^2.3.0","mongodb-reflux-store":"^0.0.1","node-loader":"^0.6.0","numeral":"^2.0.6","nyc":"^15.0.0","peer-deps-externals-webpack-plugin":"^1.0.4","postcss-loader":"^2.1.6","prop-types":"^15.7.2","react":"^16.14.0","react-dom":"^16.14.0","react-hot-loader":"^4.13.0","react-redux":"^5.0.6","react-select-plus":"^1.2.0","redux":"^4.1.2","redux-thunk":"^2.3.0","reflux":"^0.4.1","reflux-state-mixin":"github:mongodb-js/reflux-state-mixin","resolve":"^1.15.1","rimraf":"^3.0.2","semver":"^5.7.1","shebang-loader":"^0.0.1","sinon":"^9.0.0","style-loader":"^2.0.0","url-loader":"^3.0.0","webpack":"^4.46.0","webpack-bundle-analyzer":"^3.6.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.2","webpack-merge":"^4.2.2","webpack-node-externals":"^3.0.0"},"dependencies":{"@react-aria/utils":"^3.11.0","lodash":"^4.17.15"},"homepage":"https://github.com/mongodb-js/compass","bugs":{"url":"https://jira.mongodb.org/projects/COMPASS/issues","email":"compass@mongodb.com"},"repository":{"type":"git","url":"https://github.com/mongodb-js/compass.git"}}'),Zn={name:"Collections",component:Je,order:1},Yn={name:"Databases",component:lt,order:2},Jn={name:"Create Collection",component:mn},Xn={name:"Drop Collection",component:Nn},Qn={name:"Create Database",component:Vn},ea={name:"Drop Database",component:Gn};function ta(e){e.registerRole("Database.Tab",Zn),e.registerRole("Global.Modal",Jn),e.registerRole("Global.Modal",Xn),e.registerComponent("Collation.Select",Kn),e.registerStore("CollectionsPlugin.CollectionsStore",Ze),e.registerStore("CollectionsPlugin.CreateCollectionStore",un),e.registerStore("CollectionsPlugin.DropCollectionStore",xn),e.registerRole("Instance.Tab",Yn),e.registerRole("Global.Modal",Qn),e.registerRole("Global.Modal",ea),e.registerStore("DatabasesPlugin.DatabasesStore",rt),e.registerStore("DatabasesPlugin.CreateDatabaseStore",An),e.registerStore("DatabasesPlugin.DropDatabaseStore",Hn)}function na(e){e.deregisterRole("Database.Tab",Zn),e.deregisterRole("Global.Modal",Jn),e.deregisterRole("Global.Modal",Xn),e.deregisterComponent("Collation.Select"),e.deregisterStore("CollectionsPlugin.CollectionsStore"),e.deregisterStore("CollectionsPlugin.CreateCollectionStore"),e.deregisterStore("CollectionsPlugin.DropCollectionStore"),e.deregisterRole("Instance.Tab",Yn),e.deregisterRole("Global.Modal",Qn),e.deregisterRole("Global.Modal",ea),e.deregisterStore("DatabasesPlugin.DatabasesStore"),e.deregisterStore("DatabasesPlugin.CreateDatabaseStore"),e.deregisterStore("DatabasesPlugin.DropDatabaseStore")}const aa={CollectionsPlugin:Je,DatabasesPlugin:lt}},65440:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var a=n(54208),s=n.n(a);const i=Symbol("ExplainPlan.kParent");class r{constructor(e){const t=s()(e);r.addParentStages(t.executionStats.executionStages);const n=t.queryPlanner?.winningPlan?.shards?.[0]??t.queryPlanner,a=t.executionStats?.executionStages?.shards?.[0]??t.executionStats;this.namespace=n.namespace,this.parsedQuery=n.parsedQuery,this.executionSuccess=a.executionSuccess,this.nReturned=t.executionStats.nReturned,this.executionTimeMillis=t.executionStats.executionTimeMillis,this.totalKeysExamined=t.executionStats.totalKeysExamined,this.totalDocsExamined=t.executionStats.totalDocsExamined,this.rawExplainObject=t,this.originalExplainData=e}get usedIndexes(){const e=this.findAllStagesByName("IXSCAN"),t=this.findStageByName("IDHACK"),n=[];for(const a of[...e,t]){if(!a)continue;let e=null;if(this.isSharded)for(const t of r.getParentStages(a))if("string"==typeof t.shardName){e=t.shardName;break}const s=a===t?"_id_":a.indexName;n.push({index:s,shard:e})}if(this.isSharded)for(const e of this.rawExplainObject.executionStats.executionStages.shards)n.some((t=>t.shard===e.shardName))||n.push({index:null,shard:e.shardName});return n}get isCovered(){return!(this.totalDocsExamined>0)&&"FETCH"!==this.findStageByName("IXSCAN")?.parentName}get isMultiKey(){return this.findAllStagesByName("IXSCAN").some((e=>e.isMultiKey))}get inMemorySort(){return 0!==this.findAllStagesByName("SORT").length}get isCollectionScan(){return null!==this.findStageByName("COLLSCAN")}get isSharded(){return!!this.rawExplainObject.executionStats.executionStages.shards}get numShards(){return this.isSharded?this.rawExplainObject.executionStats.executionStages.shards.length:0}findStageByName(e,t){for(const n of this._getStageIterator(t))if(n.stage===e)return n;return null}findAllStagesByName(e,t){return[...this._getStageIterator(t)].filter((t=>t.stage===e))}*_getStageIterator(e){const t=e??this.rawExplainObject.executionStats.executionStages;yield t;for(const e of r.getChildStages(t))yield*this._getStageIterator(e)}static*getChildStages(e){e.inputStage&&(yield e.inputStage),e.executionStages&&(yield e.executionStages),e.innerStage&&(yield e.innerStage),e.outerStage&&(yield e.outerStage),e.thenStage&&(yield e.thenStage),e.elseStage&&(yield e.elseStage),e.shards&&(yield*e.shards),e.inputStages&&(yield*e.inputStages)}static addParentStages(e){e[i]=null;for(const t of r.getChildStages(e))r.addParentStages(t),t[i]=e}static*getParentStages(e){let t=e;for(;t=t?.[i];)yield t}}},42915:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AppRegistry:()=>y,default:()=>v});var a=n(10862),s=n.n(a),i=n(10161),r=n.n(i),o=n(91409);const l=n.n(o)()("hadron-app-registry:actions"),c=s().createAction({preEmit:function(e){l(`Action ${e} deregistered.`)}}),d=s().createAction({preEmit:function(e){l(`Action ${e} registered.`)}}),u=s().createAction({preEmit:function(e){l(`Action ${e} overwrote existing action in the registry.`)}}),p=s().createAction({preEmit:function(e){l(`Component ${e} deregistered.`)}}),m=s().createAction({preEmit:function(e){l(`Component ${e} registered.`)}}),h=s().createAction({preEmit:function(e){l(`Container ${e} deregistered.`)}}),g=s().createAction({preEmit:function(e){l(`Container ${e} registered.`)}}),b={actionDeregistered:c,actionRegistered:d,actionOverridden:u,componentDeregistered:p,componentRegistered:m,componentOverridden:s().createAction({preEmit:function(e){l(`Component ${e} overwrote existing component in the registry.`)}}),containerDeregistered:h,containerRegistered:g,roleDeregistered:s().createAction({preEmit:function(e){l(`Role ${e} deregistered.`)}}),roleRegistered:s().createAction({preEmit:function(e){l(`Role ${e} registered.`)}}),storeDeregistered:s().createAction({preEmit:function(e){l(`Store ${e} deregistered.`)}}),storeRegistered:s().createAction({preEmit:function(e){l(`Store ${e} registered.`)}}),storeOverridden:s().createAction({preEmit:function(e){l(`Store ${e} overwrote existing store in the registry.`)}})},f=s().createStore({});class y{constructor(){this._emitter=new(r()),this.actions={},this.components={},this.stores={},this.roles={},this.storeMisses={}}static get Actions(){return b}static get AppRegistry(){return y}deregisterAction(e){return delete this.actions[e],b.actionDeregistered(e),this}deregisterComponent(e){return delete this.components[e],b.componentDeregistered(e),this}deregisterRole(e,t){const n=this.roles[e];return n.splice(n.indexOf(t),1),b.roleDeregistered(e),this}deregisterStore(e){return delete this.stores[e],b.storeDeregistered(e),this}getAction(e){return this.actions[e]}getComponent(e){return this.components[e]}getRole(e){return this.roles[e]}getStore(e){const t=this.stores[e];return void 0===t?(this.storeMisses[e]=(this.storeMisses[e]||0)+1,f):t}onActivated(){return this._callOnStores((e=>{e.onActivated&&e.onActivated(this)}))}registerAction(e,t){const n=Object.prototype.hasOwnProperty.call(this.actions,e);return this.actions[e]=t,n?b.actionOverridden(e):b.actionRegistered(e),this}registerComponent(e,t){const n=Object.prototype.hasOwnProperty.call(this.components,e);return this.components[e]=t,n?b.componentOverridden(e):b.componentRegistered(e),this}registerRole(e,t){return Object.prototype.hasOwnProperty.call(this.roles,e)&&!this.roles[e].includes(t)?(this.roles[e].push(t),this.roles[e].sort(this._roleComparator.bind(this))):this.roles[e]=[t],b.roleRegistered(e),this}registerStore(e,t){const n=Object.prototype.hasOwnProperty.call(this.stores,e);return this.stores[e]=t,n?b.storeOverridden(e):b.storeRegistered(e),this}addListener(e,t){return this.on(e,t)}emit(e,...t){return this._emitter.emit(e,...t)}eventNames(){return this._emitter.eventNames()}listenerCount(e){return this._emitter.listeners(e).length}listeners(e){return this._emitter.listeners(e)}on(e,t){return this._emitter.on(e,t),this}once(e,t){return this._emitter.once(e,t),this}removeListener(e,t){return this._emitter.removeListener(e,t),this}removeAllListeners(e){return this._emitter.removeAllListeners(e),this}_callOnStores(e){for(const t of Object.keys(this.stores))e(this.stores[t]);return this}_roleComparator(e,t){return(e.order||127)-(t.order||127)}}const v=y},56462:e=>{const t={extend:function(...e){return e.unshift(this),Object.assign.apply(null,e)}};e.exports=t},79898:(e,t,n)=>{"use strict";n(18423);const a=n(10161),s=n(92694),i=n(6718),r=i.LinkedList,o=n(9628),l={Cancel:"Document::Cancel"};e.exports=class extends a{cancel(){for(let e of Array.from(this.elements))e.cancel();this.emit(l.Cancel)}constructor(e,t){super(),this.uuid=s.v4(),this.doc=e,this.cloned=t||!1,this.isUpdatable=!0,this.elements=this._generateElements(),this.type="Document",this.currentType="Document"}apply(e){let t=[],n=null;for(const[a,s]of Object.entries(e))this.get(a)?this.get(a).edit(s):n?this.insertAfter(this.get(n),a,s):this.insertBeginning(a,s),n=a,t.push(a);for(const e of[...this.elements])t.includes(e.currentKey)||e.remove()}generateObject(){return o.generate(this.elements)}generateOriginalObject(){return o.generateOriginal(this.elements)}generateUpdateUnlessChangedInBackgroundQuery(e=null){const t=this.getOriginalKeysAndValuesForFieldsThatWereUpdated(e),n={_id:this.getId(),...t},a=this.getSetUpdateForDocumentChanges(),s=this.getUnsetUpdateForDocumentChanges(),i={};return a&&Object.keys(a).length>0&&(i.$set=a),s&&Object.keys(s).length>0&&(i.$unset=s),{query:n,updateDoc:i}}get(e){return this.elements.get(e)}getChild(e){if(!e)return;let t="Array"===this.currentType?this.elements.at(e[0]):this.elements.get(e[0]),n=1;for(;n<e.length;){if(void 0===t)return;t="Array"===t.currentType?t.at(e[n]):t.get(e[n]),n++}return t}getId(){const e=this.get("_id");return e?e.generateObject():null}getOriginalKeysAndValuesForFieldsThatWereUpdated(e=null){const t={};if(this.elements)for(const n of this.elements)(n.isModified()&&!n.isAdded()||e&&n.key in e)&&(t[n.key]=n.generateOriginalObject()),n.isAdded()&&""!==n.currentKey&&(t[n.currentKey]={$exists:!1});return t}getOriginalKeysAndValuesForSpecifiedKeys(e){const t={};if(this.elements)for(const n of this.elements)n.key in e&&(t[n.key]=n.generateOriginalObject());return t}getSetUpdateForDocumentChanges(){const e={};if(this.elements)for(const t of this.elements)!t.isRemoved()&&""!==t.currentKey&&t.isModified()&&(e[t.currentKey]=t.generateObject());return e}getStringId(){const e=this.get("_id");return e?"Array"===e.currentType||"Object"===e.currentType?JSON.stringify(e.generateObject()):""+e.value:null}getUnsetUpdateForDocumentChanges(){const e={};if(this.elements)for(const t of this.elements)!t.isAdded()&&t.isRemoved()&&""!==t.key&&(e[t.key]=!0),!t.isAdded()&&t.isRenamed()&&""!==t.key&&(e[t.key]=!0);return e}insertPlaceholder(){return this.insertEnd("","")}insertBeginning(e,t){var n=this.elements.insertBeginning(e,t,!0,this);return n._bubbleUp(i.Events.Added,n,this),n}insertEnd(e,t){var n=this.elements.insertEnd(e,t,!0,this);return n._bubbleUp(i.Events.Added,n,this),n}insertAfter(e,t,n){var a=this.elements.insertAfter(e,t,n,!0,this);return a._bubbleUp(i.Events.Added,a,this),a}isAdded(){return!1}isModified(){for(let e of this.elements)if(e.isModified())return!0;return!1}isRemoved(){return!1}isRoot(){return!0}next(){this.elements.flush();const e=this.elements.lastElement;e&&e.isAdded()&&e.isBlank()?e.remove():this.insertPlaceholder()}_generateElements(){return new r(this,this.doc)}},e.exports.Events=l},78113:(e,t,n)=>{const a=n(38875),s=n(96937),{fieldStringLen:i}=n(27003),r=n(27613);e.exports=class extends r{constructor(e){super(e)}complete(){super.complete(),this.element.isCurrentTypeValid()&&this.element.edit(a.cast(this._formattedValue(),"Date"))}edit(e){try{"Invalid Date"===a.cast(e,"Date").toString()?this.element.setInvalid(e,"Date",`${e} is not in a valid date format`):(this.element.currentValue=e,this.element.setValid(),this.element._bubbleUp(s.Edited,this.element))}catch(t){this.element.setInvalid(e,this.element.currentType,t.message)}}size(e){const t=this.element.currentValue;return e?i(t):this.element.isCurrentTypeValid()?i(this._formattedValue()):i(t)}start(){super.start(),this.element.isCurrentTypeValid()&&this.edit(this._formattedValue())}value(){const e=this.element.currentValue;return!this.editing&&this.element.isCurrentTypeValid()?this._formattedValue():e}_formattedValue(){return new Date(this.element.currentValue).toISOString().replace("Z","+00:00")}}},38537:(e,t,n)=>{const a=n(38875),s=n(96937),i=n(27613);e.exports=class extends i{constructor(e){super(e)}complete(){super.complete(),this.element.isCurrentTypeValid()&&this.element.edit(a.cast(this.element.currentValue,"Decimal128"))}edit(e){try{a.cast(e,"Decimal128"),this.element.currentValue=e,this.element.setValid(),this.element._bubbleUp(s.Edited,this.element)}catch(t){this.element.setInvalid(e,this.element.currentType,t.message)}}}},68486:(e,t,n)=>{const a=n(38875),s=n(96937),{fieldStringLen:i}=n(27003),r=n(27613);e.exports=class extends r{constructor(e){super(e)}complete(){super.complete(),this.element.isCurrentTypeValid()&&this.element.edit(a.cast(this.element.currentValue,"Double"))}edit(e){try{const t=a.cast(e,"Double");isNaN(t.value)?this.element.setInvalid(e,"Double",`${e} is not a valid double format`):(this.element.currentValue=e,this.element.setValid(),this.element._bubbleUp(s.Edited,this.element))}catch(t){this.element.setInvalid(e,this.element.currentType,t.message)}}size(){const e=this.element.currentValue;return i("function"==typeof e.valueOf?e.valueOf():e)}}},70236:(e,t,n)=>{const a=n(27613),s=n(75932),i=n(38537),r=n(43528),o=n(39927),l=n(68486),c=n(78113),d=n(12746),u=n(20642),p=n(68577),m=e=>({Standard:new a(e),String:new s(e),Decimal128:new i(e),Date:new c(e),Double:new l(e),Int32:new r(e),Int64:new o(e),Null:new d(e),Undefined:new u(e),ObjectId:new p(e)});Object.assign(m,{DateEditor:c,StandardEditor:a,StringEditor:s,Decimal128Editor:i,DoubleEditor:l,Int32Editor:r,Int64Editor:o,NullEditor:d,UndefinedEditor:u,ObjectIdEditor:p}),e.exports=m},43528:(e,t,n)=>{const{fieldStringLen:a}=n(27003),s=n(27613);e.exports=class extends s{constructor(e){super(e)}size(){return a(this.element.currentValue.valueOf())}}},39927:(e,t,n)=>{const a=n(38875),s=n(96937),i=n(27613);e.exports=class extends i{constructor(e){super(e)}complete(){super.complete(),this.element.isCurrentTypeValid()&&this.element.edit(a.cast(this.element.currentValue,"Int64"))}edit(e){try{a.cast(e,"Int64"),this.element.currentValue=e,this.element.setValid(),this.element._bubbleUp(s.Edited,this.element)}catch(t){this.element.setInvalid(e,this.element.currentType,t.message)}}}},12746:(e,t,n)=>{const a=n(27613);e.exports=class extends a{constructor(e){super(e)}size(){return 4}value(){return"null"}}},68577:(e,t,n)=>{const a=n(38875),s=n(96937),i=n(27613);e.exports=class extends i{constructor(e){super(e)}complete(){super.complete(),this.element.isCurrentTypeValid()&&this.element.edit(a.cast(this.element.currentValue,"ObjectId"))}edit(e){try{a.cast(e,"ObjectId"),this.element.currentValue=e,this.element.setValid(),this.element._bubbleUp(s.Edited,this.element)}catch(t){this.element.setInvalid(e,this.element.currentType,t.message)}}start(){super.start(),this.element.isCurrentTypeValid()&&this.edit(String(this.element.currentValue))}}},27613:(e,t,n)=>{const a=n(38875),s=n(96937),{fieldStringLen:i}=n(27003),r=/^(\[|\{)(.+)(\]|\})$/;e.exports=class{constructor(e){this.element=e,this.editing=!1}edit(e){const t=this.element.currentType;try{const n=a.cast(e,t);this.element.edit(n)}catch(n){this.element.setInvalid(e,t,n.message)}}paste(e){e.match(r)?(this.edit(JSON.parse(e)),this.element._bubbleUp(s.Converted,this.element)):this.edit(e)}size(){return i(this.element.currentValue)}value(){return this.element.currentValue}start(){this.editing=!0}complete(){this.editing=!1}}},75932:(e,t,n)=>{const a=n(27613);e.exports=class extends a{constructor(e){super(e)}},e.exports.STRING_TYPE="String"},20642:(e,t,n)=>{const a=n(27613),s="undefined";e.exports=class extends a{constructor(e){super(e)}size(){return s.length}value(){return s}}},96937:e=>{e.exports={Added:"Element::Added",Edited:"Element::Edited",Removed:"Element::Removed",Reverted:"Element::Reverted",Converted:"Element::Converted",Invalid:"Element::Invalid",Valid:"Element::Valid"}},6718:(e,t,n)=>{"use strict";n(18423);const a=n(10161),s=n(4622),i=n(34772),r=n(64537),o=n(33958),l=n(66496),c=n(9628),d=n(38875),u=n(92694),p=n(78113),m=n(96937),h=["Binary","Code","MinKey","MaxKey","Timestamp","BSONRegExp","Undefined","Null","DBRef"],g=/^(\[|\{)(.+)(\]|\})$/;class b extends a{bulkEdit(e){e.match(g)?(this.edit(JSON.parse(e)),this._bubbleUp(m.Converted,this)):this.edit(e)}cancel(){if(this.elements)for(let e of Array.from(this.elements))e.cancel();this.isModified()&&this.revert()}constructor(e,t,n,a,s,i){super(),this.uuid=u.v4(),this.key=e,this.currentKey=e,this.parent=a,this.previousElement=s,this.nextElement=i,this.added=n,this.removed=!1,this.type=d.type(t),this.currentType=this.type,this.level=this._getLevel(),this.setValid(),this._isExpandable(t)?(this.elements=this._generateElements(t),this.originalExpandableValue=t):(this.value=t,this.currentValue=t)}_getLevel(){let e=-1,t=this.parent;for(;t;)e++,t=t.parent;return e}edit(e){this.currentType=d.type(e),this._isExpandable(e)&&!this._isExpandable(this.currentValue)?(this.currentValue=null,this.elements=this._generateElements(e)):!this._isExpandable(e)&&this.elements?(this.currentValue=e,this.elements=void 0):this.currentValue=e,this.setValid(),this._bubbleUp(m.Edited,this)}changeType(e){if("Object"===e)this.edit("{"),this.next();else if("Array"===e)this.edit("["),this.next();else try{if("Date"===e){const e=new p(this);e.edit(this.generateObject()),e.complete()}else this.edit(d.cast(this.generateObject(),e))}catch(t){this.setInvalid(this.currentValue,e,t.message)}}getRoot(){let e=this.parent;for(;e.parent;)e=e.parent;return e}get(e){return this.elements?this.elements.get(e):void 0}at(e){return this.elements?this.elements.at(e):void 0}next(){return"{"===this.currentValue?this._convertToEmptyObject():"["===this.currentValue?this._convertToEmptyArray():this._next()}rename(e){if(void 0!==this.parent){const t=this.parent.elements._map[this.currentKey];delete this.parent.elements._map[this.currentKey],this.parent.elements._map[e]=t}this.currentKey=e,this._bubbleUp(m.Edited,this)}generateObject(){return"Array"===this.currentType?c.generateArray(this.elements):"Object"===this.currentType?c.generate(this.elements):this.currentValue}generateOriginalObject(){if("Array"===this.type){const e=this._generateElements(this.originalExpandableValue);return c.generateOriginalArray(e)}if("Object"===this.type){const e=this._generateElements(this.originalExpandableValue);return c.generateOriginal(e)}return this.value}insertAfter(e,t,n){"Array"===this.currentType&&(""===e.currentKey&&this.elements.handleEmptyKeys(e),t=e.currentKey+1);var a=this.elements.insertAfter(e,t,n,!0,this);return"Array"===this.currentType&&this.elements.updateKeys(a,1),a._bubbleUp(m.Added,a,this),a}insertEnd(e,t){"Array"===this.currentType&&(this.elements.flush(),e=0,this.elements.lastElement&&(""===this.elements.lastElement.currentKey&&this.elements.handleEmptyKeys(this.elements.lastElement),e=this.elements.lastElement.currentKey+1));var n=this.elements.insertEnd(e,t,!0,this);return this._bubbleUp(m.Adde,n),n}insertPlaceholder(){return this.insertEnd("","")}insertSiblingPlaceholder(){return this.parent.insertAfter(this,"","")}isAdded(){return this.added||this.parent&&this.parent.isAdded()}isBlank(){return""===this.currentKey&&""===this.currentValue}isCurrentTypeValid(){return this.currentTypeValid}setValid(){this.currentTypeValid=!0,this.invalidTypeMessage=void 0,this._bubbleUp(m.Valid,this)}setInvalid(e,t,n){this.currentValue=e,this.currentType=t,this.currentTypeValid=!1,this.invalidTypeMessage=n,this._bubbleUp(m.Invalid,this)}isDuplicateKey(e){if(""===e)return!1;for(let t of this.parent.elements)if(t.uuid!==this.uuid&&t.currentKey===e)return!0;return!1}isEdited(){return(this.isRenamed()||!this._valuesEqual()||this.type!==this.currentType)&&!this.isAdded()}_valuesEqual(){return"Date"===this.currentType&&l(this.currentValue)?o(this.value,new Date(this.currentValue)):"ObjectId"===this.currentType&&l(this.currentValue)?this._isObjectIdEqual():o(this.value,this.currentValue)}_isObjectIdEqual(){try{return this.value.toHexString()===this.currentValue}catch(e){return!1}}isLast(){return this.parent.elements.lastElement===this}isRenamed(){let e=!1;return this.parent&&!this.parent.isRoot()&&"Object"!==this.parent.currentType||(e=this.key!==this.currentKey),e}isRevertable(){return this.isEdited()||this.isRemoved()}isRemovable(){return!this.parent.isRemoved()}isNotActionable(){return"_id"===this.key&&!this.isAdded()||!this.isRemovable()}isValueEditable(){return this.isKeyEditable()&&!h.includes(this.currentType)}isParentEditable(){return!(this.parent&&!this.parent.isRoot())||this.parent.isKeyEditable()}isKeyEditable(){return this.isParentEditable()&&(this.isAdded()||"_id"!==this.currentKey)}isModified(){if(this.elements)for(let e of this.elements)if(e.isModified())return!0;return this.isAdded()||this.isEdited()||this.isRemoved()}isRemoved(){return this.removed}isRoot(){return!1}remove(){this.revert(),this.removed=!0,this.parent&&this._bubbleUp(m.Removed,this,this.parent)}revert(){this.isAdded()?(this.parent&&"Array"===this.parent.currentType&&this.parent.elements.updateKeys(this,-1),this.parent.elements.remove(this),this._bubbleUp(m.Removed,this,this.parent),this.parent=null):(this.originalExpandableValue?(this.elements=this._generateElements(this.originalExpandableValue),this.currentValue=void 0):(null===this.currentValue&&null!==this.value?this.elements=null:this._removeAddedElements(),this.currentValue=this.value),this.currentKey=this.key,this.currentType=this.type,this.removed=!1),this.setValid(),this._bubbleUp(m.Reverted,this)}_bubbleUp(e,...t){this.emit(e,...t);var n=this.parent;n&&(n.isRoot()?n.emit(e,...t):n._bubbleUp(e,...t))}_convertToEmptyObject(){this.edit({}),this.insertPlaceholder()}_convertToEmptyArray(){this.edit([]),this.insertPlaceholder()}_isElementEmpty(e){return e&&e.isAdded()&&e.isBlank()}_isExpandable(e){return i(e)||r(e)}_generateElements(e){return new f(this,e)}_key(e,t){return"Array"===this.currentType?t:e}_next(){this._isElementEmpty(this.nextElement)||this._isElementEmpty(this)||this.parent.insertAfter(this,"","")}_removeAddedElements(){if(this.elements)for(let e of this.elements)e.isAdded()&&this.elements.remove(e)}}class f{at(e){if(this.flush(),Number.isInteger(e)){for(var t=this.firstElement,n=0;n<e;n++){if(!t)return;t=t.nextElement}return null===t?void 0:t}}get(e){return this.flush(),this._map[e]}constructor(e,t){this.firstElement=null,this.lastElement=null,this.doc=e,this.originalDoc=t,this.keys=s(this.originalDoc),"Array"===this.doc.currentType&&(this.keys=this.keys.map((e=>parseInt(e,10)))),this.size=this.keys.length,this.loaded=0,this._map={}}insertAfter(e,t,n,a,s){return this.flush(),this._insertAfter(e,t,n,a,s)}updateKeys(e,t){for(this.flush();e.nextElement;)e.nextElement.currentKey+=t,e=e.nextElement}handleEmptyKeys(e){if(""===e.currentKey){let t=e;for(;""===t.currentKey;){if(!t.previousElement){t.currentKey=0;break}t=t.previousElement}for(;t.nextElement;)t.nextElement.currentKey=t.currentKey+1,t=t.nextElement}}insertBefore(e,t,n,a,s){return this.flush(),this._insertBefore(e,t,n,a,s)}insertBeginning(e,t,n,a){return this.flush(),this._insertBeginning(e,t,n,a)}insertEnd(e,t,n,a){return this.flush(),this.lastElement?this.insertAfter(this.lastElement,e,t,n,a):this.insertBeginning(e,t,n,a)}flush(){if(this.loaded<this.size)for(let e of this)e&&e.elements&&e.elements.flush()}[Symbol.iterator](){let e,t=0;return{next:()=>{if(this._needsLazyLoad(t)){const n=this.keys[t];return t+=1,e=this._lazyInsertEnd(n),{value:e}}return this._needsStandardIteration(t)?(e=e?e.nextElement:this.firstElement,e?(t+=1,{value:e}):{done:!0}):{done:!0}}}}_needsLazyLoad(e){return 0===e&&0===this.loaded&&this.size>0||this.loaded<=e&&e<this.size}_needsStandardIteration(e){return this.loaded>0&&e<this.loaded&&e<this.size}_lazyInsertEnd(e){return this.size-=1,this._insertEnd(e,this.originalDoc[e],this.doc.cloned,this.doc)}_insertEnd(e,t,n,a){return this.lastElement?this._insertAfter(this.lastElement,e,t,n,a):this._insertBeginning(e,t,n,a)}_insertBefore(e,t,n,a,s){var i=new b(t,n,a,s,e.previousElement,e);return e.previousElement?e.previousElement.nextElement=i:this.firstElement=i,e.previousElement=i,this._map[i.key]=i,this.size+=1,this.loaded+=1,i}_insertBeginning(e,t,n,a){if(!this.firstElement){var s=new b(e,t,n,a,null,null);return this.firstElement=this.lastElement=s,this.size+=1,this.loaded+=1,this._map[s.key]=s,s}const i=this.insertBefore(this.firstElement,e,t,n,a);return this._map[i.key]=i,i}_insertAfter(e,t,n,a,s){var i=new b(t,n,a,s,e,e.nextElement);return e.nextElement?e.nextElement.previousElement=i:this.lastElement=i,e.nextElement=i,this._map[i.key]=i,this.size+=1,this.loaded+=1,i}remove(e){return this.flush(),e.previousElement?e.previousElement.nextElement=e.nextElement:this.firstElement=e.nextElement,e.nextElement?e.nextElement.previousElement=e.previousElement:this.lastElement=e.previousElement,e.nextElement=e.previousElement=null,delete this._map[e.currentKey],this.size-=1,this.loaded-=1,this}findIndex(e){let t=0;for(const n of this){if(n===e)return t;t++}return-1}}b.LinkedList=f,b.Events=m,b.DATE_FORMAT="YYYY-MM-DD HH:mm:ss.SSS",e.exports=b},74727:(e,t,n)=>{e.exports=n(79898),e.exports.DocumentEvents=e.exports.Events,e.exports.Element=n(6718),e.exports.ElementEvents=e.exports.Element.Events,e.exports.ElementEditor=n(70236)},9628:e=>{"use strict";e.exports=new class{generate(e){if(e){var t={};for(let n of e)n.isRemoved()||""===n.currentKey||(t[n.currentKey]=n.generateObject());return t}return e}generateOriginal(e){if(e){var t={};for(let n of e)n.isAdded()||(t[n.key]=n.generateOriginalObject());return t}return e}generateArray(e){if(e){var t=[];for(let n of e)n.isRemoved()||(n.elements?t.push(n.generateObject()):t.push(n.currentValue));return t}return e}generateOriginalArray(e){if(e){var t=[];for(let n of e)n.originalExpandableValue?t.push(n.generateOriginalObject()):n.isAdded()||t.push(n.value);return t}return e}}},27003:e=>{e.exports={fieldStringLen:e=>{const t=String(e).length;return 0===t?1:t}}},45727:(e,t,n)=>{"use strict";const a=n(4283);let s=!1;try{s="string"!=typeof n(72298)}catch(e){}!function(){if(!s)return console.warn("Unsupported environment for hadron-ipc"),{};const t=n(a?80677:65663);e.exports=t,a?e.exports.ipcRenderer=t:e.exports.ipcMain=t}()},81563:(e,t)=>{"use strict";t._=e=>`hadron-ipc-${e}-response`},65663:(e,t,n)=>{"use strict";const a=n(81563)._,s=n(34749),i=n(34772),r=n(99320),o=n(72298),l=o.BrowserWindow,c=o.ipcMain,d=n(62069)("hadron-ipc:main");(t=c).respondTo=(e,n)=>{if(i(e))return s(e,((e,n)=>{t.respondTo(n,e)})),t;const o=a(e),u=`${o}-error`;return c.on(e,((t,...a)=>{const s=l.fromWebContents(t.sender);if(!s)return;const i=n=>{if(d(`responding with result for ${e}`,n),s.isDestroyed())return d("browserWindow went away.  nothing to send response to.");t.sender.send(o,n)},c=n=>{if(d(`responding with error for ${e}`,n),s.isDestroyed())return d("browserWindow went away.  nothing to send response to.");t.sender.send(u,n)};d(`calling ${e} handler with args`,a);const p=n(s,...a);r(p)?p.then(i).catch(c):p instanceof Error?c(p):i(p)})),t},t.broadcast=(e,...t)=>{l.getAllWindows().forEach((n=>{n.webContents&&n.webContents.send(e,...t)}))},t.broadcastFocused=(e,...t)=>{l.getAllWindows().forEach((n=>{n.webContents&&n.isFocused()&&n.webContents.send(e,...t)}))},t.remove=(e,t)=>{c.removeListener(e,t)},e.exports=t},80677:(e,t,n)=>{"use strict";const a=n(81563)._,s=n(72298).ipcRenderer,i=n(62069)("hadron-ipc:renderer");function r(e,t,...n){e(`calling ${t} with args`,n);const i=a(t),r=`${i}-error`;return new Promise((function(a,o){s.on(i,(function(n,o){e(`got response for ${t} from main`,o),s.removeAllListeners(i),s.removeAllListeners(r),a(o)})),s.on(r,(function(n,a){e(`error for ${t} from main`,a),s.removeAllListeners(i),s.removeAllListeners(r),o(a)})),s.send(t,...n)}))}(t=s).callQuiet=function(e,...t){return r((()=>{}),e,...t)},t.call=function(e,...t){return r(i,e,...t)},e.exports=t},88609:(e,t,n)=>{e.exports=e.exports.PluginManager=n(67614),e.exports.Plugin=n(34069),e.exports.Action=n(97536)},97536:(e,t,n)=>{"use strict";const a=n(61237)("hadron-plugin-manager:action"),s=n(10862),i=s.createAction({sync:!0,preEmit:function(e){a(`Plugin ${e.metadata.name} activated.`)}}),r=s.createAction({sync:!0,preEmit:function(){a("Plugin activation completed.")}});e.exports.pluginActivationCompleted=r,e.exports.pluginActivated=i},67614:(e,t,n)=>{"use strict";const{promises:a}=n(57147),s=n(71017),i=n(34069),r=n(97536),{createLoggerAndTelemetry:o}=n(6909),{debug:l,track:c}=o("COMPASS-PLUGINS");e.exports=class{constructor(e,t,n=[]){this.paths=e,this.baseDir=t,this.plugins=[...n]}async activate(e,t="1.0.0"){await Promise.all(this.paths.map((e=>this._loadPluginsFromPath(e,t)))),this.plugins.forEach((t=>{t.activate(e),Object.freeze(t),r.pluginActivated(t)})),r.pluginActivationCompleted(e)}async _loadPluginsFromPath(e,t,n){l("Loading plugins from path",e);try{const i=await a.readdir(e);return await Promise.all(i.map((a=>this._loadPlugin(s.join(e,a),t,n))))}catch(e){l("Failed to load plugins from path:",e)}return[]}async _loadPlugin(e,t){l("Loading plugin from path",e),c("External Plugin Loaded");try{const n=new i(e,t);return this.plugins.push(n),n}catch(e){l("Failed to load plugin:",e)}return null}}},34069:(e,t,n)=>{"use strict";const a=n(71017),s=n(70640),i=n(53698),r={},o={},l="@mongodb-js";e.exports=class{constructor(e,t="1.0.0"){this.pluginPath=e,this.isActivated=!1;try{this.metadata=Object.freeze(i(a.resolve(this.pluginPath,"package.json")))}catch(e){this.error=Object.freeze(e),this.metadata=Object.freeze({name:`${a.basename(this.pluginPath)}`})}this._validateNameLegality(),this._validateApiVersion(t),this._validateNameCollision()}load(){if(r.hasOwnProperty(this.pluginPath))return r[this.pluginPath];const e=i(a.resolve(this.pluginPath,this.metadata.main));return r[this.pluginPath]=e,e}activate(e){if(!this.error)try{const t=this.load().activate(e);return this.isActivated=!0,t}catch(e){this.error=e}}_validateApiVersion(e){this.applicationApiVersion=e,this.apiVersion=this.metadata.apiVersion||e,s.satisfies(this.applicationApiVersion,`^${this.apiVersion}`)||(this.error=new Error(`This plugin's api version of ${this.apiVersion} is not compatible with the application plugin api version of ${this.applicationApiVersion}`))}_validateNameLegality(){const e=this.metadata.name;this.pluginPath.includes(".mongodb")&&e.startsWith(l)&&(this.error=new Error(`Plugin name starting with ${l} is not permitted.`),this.error.stack="")}_validateNameCollision(){const e=this.metadata.name;o.hasOwnProperty(e)?this.error=new Error(`Plugin with the name ${e} already exists.`):o[e]=this.pluginPath}},e.exports.CACHE=r,e.exports.NAME_CACHE=o},53698:e=>{e.exports=require},15251:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnimatedIconTextButton:()=>o,IconButton:()=>c,IconTextButton:()=>u,TextButton:()=>m});var a=n(2784),s=n(13980),i=n.n(s);class r extends a.Component{constructor(e){super(e),this.state={animating:!1}}componentDidMount(){this.unsubscribeStopAnimation=this.props.stopAnimationListenable.listen(this.handleStopAnimation.bind(this))}componentWillUnmount(){this.unsubscribeStopAnimation()}handleClick(){this.setState({animating:!0}),this.props.clickHandler()}handleStopAnimation(){this.setState({animating:!1})}renderIcon(){const e=this.state.animating?this.props.animatingIconClassName:this.props.iconClassName;return a.createElement("i",{className:e,"aria-hidden":!0})}render(){return a.createElement("button",{type:"button","data-test-id":this.props.dataTestId,className:this.props.className,onClick:this.handleClick.bind(this),disabled:this.props.disabled},this.renderIcon(),this.props.text)}}r.displayName="AnimatedIconTextButton",r.propTypes={text:i().string,clickHandler:i().func.isRequired,className:i().string,iconClassName:i().string.isRequired,animatingIconClassName:i().string.isRequired,dataTestId:i().string,stopAnimationListenable:i().any.isRequired,disabled:i().bool};const o=r;class l extends a.Component{shouldComponentUpdate(){return!1}render(){return a.createElement("button",{type:"button",title:this.props.title,"data-test-id":this.props.dataTestId,className:this.props.className,onClick:this.props.clickHandler},a.createElement("i",{className:this.props.iconClassName,"aria-hidden":!0}))}}l.displayName="IconButton",l.propTypes={title:i().string,clickHandler:i().func.isRequired,className:i().string,iconClassName:i().string.isRequired,dataTestId:i().string};const c=l;class d extends a.Component{shouldComponentUpdate(){return!1}render(){return a.createElement("button",{type:"button","data-test-id":this.props.dataTestId,className:this.props.className,onClick:this.props.clickHandler},a.createElement("i",{className:this.props.iconClassName,"aria-hidden":!0}),this.props.text)}}d.displayName="IconTextButton",d.propTypes={text:i().string,clickHandler:i().func.isRequired,className:i().string,iconClassName:i().string.isRequired,dataTestId:i().string};const u=d;class p extends a.Component{render(){return a.createElement("button",{id:this.props.id,className:this.props.className,"data-test-id":this.props.dataTestId,title:this.props.title,type:"button",disabled:this.props.disabled,style:this.props.style,onClick:this.props.clickHandler},this.props.text)}}p.displayName="TextButton",p.propTypes={text:i().string.isRequired,title:i().string,clickHandler:i().func.isRequired,className:i().string,dataTestId:i().string,disabled:i().bool,id:i().string,style:i().object};const m=p},70602:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FormInput:()=>c,InfoSprinkle:()=>m,ModalCheckbox:()=>g,ModalInput:()=>u,ModalStatusMessage:()=>y,OptionSelector:()=>k,StatusRow:()=>C,StoreConnector:()=>D,Tooltip:()=>I,ViewSwitcher:()=>V,WithDragDropContext:()=>B,ZeroState:()=>q});var a=n(2784),s=n(45658),i=n(13980),r=n.n(i);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o.apply(this,arguments)}class l extends a.PureComponent{getClassName(){return this.props.error?"form-item form-item-has-error":"form-item"}getErrorId(){return`form-error-tooltip-${this.props.name}`}renderInfoSprinkle(){if(this.props.linkHandler)return a.createElement("i",{className:"help",onClick:this.props.linkHandler})}renderError(){if(this.props.error)return a.createElement("i",{className:"fa fa-exclamation-circle","aria-hidden":"true"})}renderErrorTooltip(){if(this.props.error)return a.createElement(s.Z,{id:this.getErrorId()})}render(){const e=this.props.error?{"data-for":this.getErrorId(),"data-effect":"solid","data-place":"bottom","data-offset":"{'bottom': -2}","data-tip":this.props.error,"data-type":"error"}:{};return a.createElement("div",{className:this.getClassName()},a.createElement("label",null,a.createElement("span",{className:"form-item-label"},this.renderError(),this.props.label),this.renderInfoSprinkle()),a.createElement("input",o({name:this.props.name,placeholder:this.props.placeholder,onChange:this.props.changeHandler,onBlur:this.props.blurHandler,value:this.props.value,className:"form-control",type:this.props.type||"text"},e)),this.renderErrorTooltip())}}l.propTypes={label:r().string.isRequired,name:r().string.isRequired,changeHandler:r().func.isRequired,blurHandler:r().func,linkHandler:r().func,placeholder:r().string,value:r().oneOfType([r().string,r().number]),type:r().string,error:r().string},l.displayName="FormInput";const c=l;class d extends a.PureComponent{render(){return a.createElement("div",{className:"form-group"},a.createElement("p",null,this.props.name),a.createElement("input",{autoFocus:this.props.autoFocus,id:this.props.id,type:"text",className:"form-control",onChange:this.props.onChangeHandler,value:this.props.value}))}}d.displayName="ModalInputComponent",d.propTypes={autoFocus:r().bool,onChangeHandler:r().func.isRequired,value:r().string,name:r().string.isRequired,id:r().string.isRequired},d.defaultProps={autoFocus:!1};const u=d;class p extends a.Component{render(){return a.createElement("i",{className:"info-sprinkle",onClick:this.props.onClickHandler.bind(this,this.props.helpLink)})}}p.displayName="InfoSprinkle",p.propTypes={onClickHandler:r().func.isRequired,helpLink:r().string.isRequired};const m=p;class h extends a.Component{render(){return a.createElement("div",null,a.createElement("label",null,a.createElement("input",{type:"checkbox",onChange:this.props.onClickHandler,checked:this.props.checked,className:this.props.inputClassName}),a.createElement("span",{className:this.props.titleClassName},this.props.name)),a.createElement(m,{helpLink:this.props.helpUrl,onClickHandler:this.props.onLinkClickHandler}))}}h.displayName="ModalCheckboxComponent",h.propTypes={onClickHandler:r().func.isRequired,onLinkClickHandler:r().func.isRequired,checked:r().bool,helpUrl:r().string,titleClassName:r().string,inputClassName:r().string,name:r().string.isRequired};const g=h;var b=n(16194);class f extends a.Component{onIconClickHandler(e){e.preventDefault(),e.stopPropagation(),this.props.onIconClickHandler()}render(){const e=`modal-status-${this.props.type}`;return a.createElement(b.Z,{className:e},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-1"},this.props.onIconClickHandler?a.createElement("i",{className:`fa fa-${this.props.icon} ${e}-icon ${e}-icon-interactible`,onClick:this.onIconClickHandler.bind(this)}):a.createElement("i",{className:`fa fa-${this.props.icon} ${e}-icon`,"aria-hidden":"true"})),a.createElement("div",{className:"col-md-11"},a.createElement("p",{className:`${e}-message`,"data-test-id":"modal-message"},this.props.message))))}}f.displayName="ModalStatusMessage",f.propTypes={icon:r().string.isRequired,message:r().string.isRequired,type:r().string.isRequired,onIconClickHandler:r().func};const y=f;class v extends a.Component{render(){let e="status-row";return"default"!==this.props.style&&(e+=` status-row-has-${this.props.style}`),a.createElement("div",{className:e},this.props.children)}}v.propTypes={style:r().oneOf(["default","warning","error"]),children:r().node},v.defaultProps={style:"default"},v.displayName="StatusRow";const C=v;var E=n(13253),S=n(62823);class x extends a.Component{static renderLabel(e,t){return e?a.createElement("label",{className:"option-selector-label",htmlFor:t},e):null}render(){const e=this.constructor.renderLabel(this.props.label,this.props.id),t=[];for(const[e,n]of Object.entries(this.props.options))t.push(a.createElement(E.Z,{"data-test-id":`${this.props.id}-${e}`,key:e,eventKey:e,href:"#"},n));return a.createElement("div",{className:"option-selector"},e,a.createElement(S.Z,{bsSize:this.props.bsSize,className:this.props.className,id:this.props.id,onSelect:this.props.onSelect,title:this.props.title,disabled:this.props.disabled},t))}}x.propTypes={id:r().string.isRequired,className:r().string,bsSize:r().string,options:r().object.isRequired,label:r().string,title:r().oneOfType([r().string,r().object]),onSelect:r().func,disabled:r().bool},x.defaultProps={label:"",title:"Select an option",onSelect:()=>{},disabled:!1},x.displayName="OptionSelector";const k=x;var N=n(84148),_=n.n(N);class w extends a.Component{constructor(e){super(e),_()(e.store.getInitialState)?this.state=e.store.state:(console.warn("component "+this.constructor.displayName+' is trying to connect to a store that lacks a "getInitialState()" method'),this.state={})}componentDidMount(){this.unsubscribe=this.props.store.listen(this.setState.bind(this))}componentWillUnmount(){this.unsubscribe()}render(){return a.cloneElement(this.props.children,this.state)}}w.propTypes={store:r().object.isRequired,children:r().element.isRequired},w.displayName="StoreConnector";const D=w;class R extends a.Component{render(){return a.createElement(s.Z,this.props)}}R.propTypes={id:r().string.isRequired,effect:r().string,className:r().string,place:r().string,delayShow:r().number},R.defaultProps={place:"right",effect:"solid",className:"hadron-tooltip",delayShow:200},R.displayName="Tooltip";const I=R;var T=n(63584),A=n(42919);class O extends a.Component{buttonFactory(){return this.props.buttonLabels.map(((e,t)=>{const n=this.props.activeButton===e,s=`${this.props.dataTestId}-${e.toLowerCase().replace(/ /g,"-")}`,i=this.props.showLabels?e:"";return a.createElement(T.Z,{key:e,active:n,"data-test-id":s,disabled:this.props.disabled,onClick:this.props.onClick.bind(this,e),bsSize:"xsmall"},this.renderIcon(t),i)}))}renderIcon(e){if(this.props.iconClassNames[e])return a.createElement("i",{className:this.props.iconClassNames[e],"aria-hidden":!0})}render(){const e=this.buttonFactory();return a.createElement("div",{className:"view-switcher"},a.createElement("span",{className:"view-switcher-label"},this.props.label),a.createElement(A.Z,null,e))}}O.propTypes={label:r().string,buttonLabels:r().arrayOf(r().string).isRequired,activeButton:r().string,disabled:r().bool,showLabels:r().bool,dataTestId:r().string,onClick:r().func,iconClassNames:r().arrayOf(r().string)},O.defaultProps={iconClassNames:[],showLabels:!0},O.displayName="ViewSwitcher";const V=O;var j=n(50517);const L="zero-state";class z extends a.Component{render(){return a.createElement("div",{className:`${L}`},a.createElement(j.H3,{className:`${L}-header`},this.props.header),a.createElement(j.Subtitle,{className:`${L}-subheader`},this.props.subtext),a.createElement("div",{className:`${L}-body`},this.props.children))}}z.displayName="ZeroState",z.propTypes={header:r().string.isRequired,subtext:r().string.isRequired,children:r().node};const q=z;var P=n(7087),$=n(87857);let M;const B=e=>(M||(M=(0,P.Z5)($.ZP)),M(e))},38875:(e,t,n)=>{e.exports=n(2473)},2473:(e,t,n)=>{const{isPlainObject:a,isArray:s,isString:i,isNumber:r,hasIn:o,keys:l,without:c,toNumber:d,toString:u}=n(76635),{ObjectId:p,MinKey:m,MaxKey:h,Long:g,Double:b,Int32:f,Decimal128:y,Binary:v,BSONRegExp:C,Code:E,BSONSymbol:S,Timestamp:x,Map:k}=n(24179),N="Long",_="Int64",w="_bsontype",D=/\[object (\w+)\]/,R=2147483647,I=-2147483648,T=Math.pow(2,63)-1,A=-T,O=/^-?\d+$/,V=["Long","Int32","Double","Decimal128"],j={Array:e=>s(e)?e:a(e)?[]:[e],Binary:e=>new v(""+e,v.SUBTYPE_DEFAULT),Boolean:e=>{if(i(e)){if("true"===e.toLowerCase())return!0;if("false"===e.toLowerCase())return!1;throw new Error(`'${e}' is not a valid boolean string`)}return!!e},Code:e=>new E(""+e,{}),Date:e=>new Date(e),Decimal128:e=>(o(e,w)&&V.includes(e._bsontype)&&(e=e._bsontype===N?e.toString():e.valueOf()),y.fromString(""+e)),Double:e=>{if("-"===e||""===e)throw new Error(`Value '${e}' is not a valid Double value`);if(i(e)&&e.endsWith("."))throw new Error("Please enter at least one digit after the decimal");const t=d(e);return new b(t)},Int32:e=>{if("-"===e||""===e)throw new Error(`Value '${e}' is not a valid Int32 value`);const t=d(e);if(t>=I&&t<=R)return new f(t);throw new Error(`Value ${t} is outside the valid Int32 range`)},Int64:e=>{if("-"===e||""===e)throw new Error(`Value '${e}' is not a valid Int64 value`);const t=d(e);if(t>=A&&t<=T)return e.value||"number"==typeof e?g.fromNumber(t):"object"==typeof e?g.fromString(e.toString()):g.fromString(e);throw new Error(`Value ${e.toString()} is outside the valid Int64 range`)},MaxKey:()=>new h,MinKey:()=>new m,Null:()=>null,Object:e=>a(e)?e:{},ObjectId:e=>i(e)&&""!==e?p.createFromHexString(e):new p,BSONRegExp:e=>new C(""+e),String:u,BSONSymbol:e=>new S(""+e),Timestamp:e=>{const t=d(e);return x.fromNumber(t)},Undefined:()=>{}},L=l(j),z=new class{test(e){if(O.test(e)){var t=d(e);return t>=I&&t<=R}return!1}},q=new class{test(e){return!!O.test(e)&&Number.isSafeInteger(d(e))}};e.exports=new class{cast(e,t){var n=j[t],a=e;return n&&(a=n(e)),"[object Object]"===a?"":a}type(e){return o(e,w)?e._bsontype===N?_:"ObjectID"===e._bsontype?"ObjectId":"Symbol"===e._bsontype?"BSONSymbol":e._bsontype:r(e)?(t=u(e),z.test(t)?"Int32":q.test(t)?_:"Double"):a(e)?"Object":s(e)?"Array":Object.prototype.toString.call(e).replace(D,"$1");var t}castableTypes(e=!1){return!0===e?L:c(L,"Decimal128")}}},64755:(e,t,n)=>{var a=n(59275),s=n(86332),i=n(80779);e.exports=a,e.exports.Collection=s,e.exports.fetch=i},86332:(e,t,n)=>{var a=n(51762),s=n(59275),i=n(80779);e.exports=a.extend({model:s,mainIndex:"id",indexes:["name"],fetchIndexes:function(e,t){var n=this;return n.trigger("request",n),i(e,t,(function(e,t){if(e)throw e;n.reset(t,{parse:!0}),n.trigger("sync",n)})),n}})},80779:(e,t,n)=>{var a=n(76635),s=n(24290),i=n(84935),r=n(33760).isNotAuthorized,o=n(85504)("mongodb-index-model:fetch");function l(e,t){t(null,e)}function c(e,t){var n=e.client,s=i(e.namespace);n.db(s.database).collection(s.collection).indexes((function(e,n){if(e)return o("getIndexes failed!",e),void t(e);a.each(n,(function(e){e.ns=s.ns})),t(null,n)}))}function d(e,t){var n=e.client,s=i(e.namespace);o("Getting $indexStats for %s",e.namespace),n.db(s.database).collection(s.collection).aggregate([{$indexStats:{}},{$project:{name:1,usageHost:"$host",usageCount:"$accesses.ops",usageSince:"$accesses.since"}}],{cursor:{}}).toArray((function(e,n){if(e)return r(e)?(o("Not authorized to get index stats",e),t(null,{})):e.message.match(/Unrecognized pipeline stage name/)?(o("$indexStats not yet supported, return empty document",e),t(null,{})):(o("Unknown error while getting index stats!",e),t(e));n=a.mapKeys(n,(function(e){return e.name})),t(null,n)}))}function u(e,t){var n=e.client,s=i(e.namespace);o("Getting index sizes for %s",e.namespace),n.db(s.database).collection(s.collection).stats((function(n,s){if(n)return r(n)?(o("Not authorized to get collection stats.  Returning default for indexSizes {}."),t(null,{})):(o("Error getting index sizes for %s",e.namespace,n),t(n));s=a.mapValues(s.indexSizes,(function(e){return{size:e}})),o("Got index sizes for %s",e.namespace,s),t(null,s)}))}function p(e,t){var n=e.getIndexes,s=e.getIndexStats,i=e.getIndexSizes;a.each(n,(function(e,t){a.assign(n[t],s[e.name]),a.assign(n[t],i[e.name])})),t(null,n)}e.exports=function(e,t,n){var a={client:l.bind(null,e),namespace:l.bind(null,t),getIndexes:["client","namespace",c],getIndexStats:["client","namespace",d],getIndexSizes:["client","namespace",u],indexes:["getIndexes","getIndexStats","getIndexSizes",p]};o("Getting index details for namespace %s",t),s.auto(a,(function(e,a){return e?(o("Failed to get index details for namespace %s",t,e),n(e)):(o("Index details for namespace %s",t,a.indexes),n(null,a.indexes))}))}},44326:(e,t,n)=>{var a=n(71305),s=n(51762),i=n(73837).format,r=a.extend({namespace:"IndexType",idAttribute:"id",props:{field:"string",value:{type:"any"}},derived:{id:{deps:["field","value"],fn:function(){return i("%s_%s",this.field,this.value)}},geo:{deps:["value"],fn:function(){return"2dsphere"===this.value||"2d"===this.value||"geoHaystack"===this.value}}}}),o=s.extend({model:r});e.exports=r,e.exports.Collection=o},59275:(e,t,n)=>{var a=n(71305),s=n(76635),i=n(44326).Collection,r={ns:"string",key:"object",name:"string",size:"number",usageCount:"number",usageSince:"date",usageHost:"string",version:"number",extra:"object"},o=a.extend({namespace:"Index",idAttribute:"id",extraProperties:"reject",props:r,session:{relativeSize:"number"},derived:{id:{deps:["name","ns"],fn:function(){return this.ns+"."+this.name}},unique:{deps:["extra","name"],fn:function(){return"_id_"===this.name||!!this.extra.unique}},sparse:{deps:["extra"],fn:function(){return!!this.extra.sparse}},ttl:{deps:["extra"],fn:function(){return!!this.extra.expireAfterSeconds}},hashed:{deps:["key"],fn:function(){return s.values(this.key).indexOf("hashed")>-1}},geo:{deps:["extra","key"],fn:function(){return!!this.extra["2dsphereIndexVersion"]||s.values(this.key).indexOf("2d")>-1||s.values(this.key).indexOf("geoHaystack")>-1}},compound:{deps:["key"],fn:function(){return s.keys(this.key).length>1}},single:{deps:["compound"],fn:function(){return!this.compound}},partial:{deps:["extra"],fn:function(){return!!this.extra.partialFilterExpression}},text:{deps:["extra"],fn:function(){return!!this.extra.textIndexVersion}},wildcard:{deps:["extra","key"],fn:function(){return s.keys(this.key).some((function(e){return"$**"===e||e.indexOf(".$**")>-1}))}},collation:{deps:["extra"],fn:function(){return!!this.extra.collation}},type:{deps:["geo","hashed","text","wildcard"],fn:function(){return this.geo?"geospatial":this.hashed?"hashed":this.text?"text":this.wildcard?"wildcard":"regular"}},cardinality:{deps:["single"],fn:function(){return this.single?"single":"compound"}},properties:{deps:["unique","sparse","partial","ttl","collation"],fn:function(){var e=this;return s.filter(["unique","sparse","partial","ttl","collation"],(function(t){return!!e[t]})).sort((function(e,t){var n={unique:1,sparse:2,partial:3,ttl:4,collation:5};return n[e]-n[t]}))}}},collections:{fields:i},parse:function(e){return e.version=e.v,delete e.v,e.extra=s.omit(e,s.keys(r)),s.each(s.keys(e.extra),(function(t){delete e[t]})),e.fields=s.map(e.key,(function(e,t){return{field:t,value:e}})),e},serialize:function(){return this.getAttributes({props:!0,derived:!0})}});e.exports=o},31453:(e,t,n)=>{e.exports=n(66820)},66820:(e,t,n)=>{n(67526),n(33354),n(25870),n(10930),n(40574),n(94116),n(43267),n(74614),n(19852),n(44306),n(26077),n(71072),n(50183),n(59086),n(87659);const a=n(71305),{Collection:s}=n(68166),i=new Map,r=new WeakSet;function o(e){if(e&&e.off&&!r.has(e)){r.add(e),e.off(),e.isCollection&&e.forEach((e=>{o(e)}));for(const t of Object.values(e))o(t)}}const l=a.extend({props:{user:{type:"object",default:null},roles:{type:"array",default:null},privileges:{type:"array",default:null}}}),c=a.extend({props:{arch:"string",cpu_cores:"number",cpu_frequency:"number",memory_bits:"number",os:"string",os_family:"string",kernel_version:"string",kernel_version_string:"string"}}),d=a.extend({props:{isEnterprise:"boolean",version:"string"}}),u=a.extend({props:{isGenuine:{type:"boolean",default:!0},dbType:"string"}}),p=a.extend({props:{isDataLake:{type:"boolean",default:!1},version:"string"}});function m(e,t){return t||"initial"!==e}function h(e,t){return t||"ready"!==e}const g=a.extend((b=["fetch","fetchDatabases","refresh"],{initialize(){b.forEach((e=>{if(e in this&&"function"==typeof this[e]){const n=this[e];this[e]=(t=n,function(...e){const n=this.isCollection?`${this.parent.cid}$$coll$$${t.name}`:`${this.cid}$$${t.name}`;if(i.has(n))return i.get(n);const a=t.call(this,...e).finally((()=>{i.delete(n)}));return i.set(n,a),a})}var t}))}}),{modelType:"Instance",idAttribute:"_id",props:{_id:{type:"string",required:!0},hostname:{type:"string",required:!0},port:"number",status:{type:"string",default:"initial"},statusError:{type:"string",default:null},databasesStatus:{type:"string",default:"initial"},databasesStatusError:{type:"string",default:null},refreshingStatus:{type:"string",default:"initial"},refreshingStatusError:{type:"string",default:null},isAtlas:{type:"boolean",default:!1}},derived:{isRefreshing:{deps:["refreshingStatus"],fn(){return["fetching","refreshing"].includes(this.refreshingStatus)}}},children:{host:c,build:d,genuineMongoDB:u,dataLake:p,auth:l},collections:{databases:s},async fetch({dataService:e,force:t=!1}){if(h(this.status,t))try{const t="initial"===this.status?"fetching":"refreshing";this.set({status:t});const n=await e.instance();this.set({status:"ready",statusError:null,...n})}catch(e){throw this.set({status:"error",statusError:e.message}),e}},async fetchDatabases({dataService:e,force:t=!1}){if(h(this.databasesStatus,t))try{const t="initial"===this.databasesStatus?"fetching":"refreshing";this.set({databasesStatus:t}),await this.databases.fetch({dataService:e}),this.set({databasesStatus:"ready",databasesStatusError:null})}catch(e){throw this.set({databasesStatus:"error",databasesStatusError:e.message}),e}},async refresh({dataService:e,fetchDatabases:t=!1,fetchDbStats:n=!1,fetchCollections:a=!1,fetchCollInfo:s=!1,fetchCollStats:i=!1}){this.set({refreshingStatus:"initial"===this.refreshingStatus?"fetching":"refreshing"});try{await this.fetch({dataService:e,force:!0}),m(this.databasesStatus,t)&&await this.fetchDatabases({dataService:e,force:!0}),await Promise.all(this.databases.map((t=>{if(m(t.collectionsStatus,a))return t.fetchCollections({dataService:e,fetchInfo:s,force:!0})}))),await Promise.allSettled(this.databases.map((t=>[m(t.status,n)&&t.fetch({dataService:e,force:!0}),...t.collections.map((t=>{if(m(t.status,i))return t.fetch({dataService:e,fetchInfo:!s,force:!0})}))])).flat()),this.set({refreshingStatus:"ready",refreshingStatusError:null})}catch(e){throw this.set({refreshingStatus:"error",refreshingStatusError:e.message}),e}},async getNamespace({dataService:e,database:t,collection:n}){await this.fetchDatabases({dataService:e});const a=this.databases.get(t);if(!a)return null;await a.fetchCollections({dataService:e});return a.collections.get(n,"name")||null},removeAllListeners(){o(this),r.deleteAll()},toJSON(e={derived:!0}){return this.serialize(e)}});var b;e.exports=g}}]);