!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("prop-types"),require("lodash/findLast"),require("@leafygreen-ui/palette"),require("@leafygreen-ui/tooltip"),require("@leafygreen-ui/emotion"),require("@leafygreen-ui/hooks"),require("@leafygreen-ui/lib"),require("@emotion/react"),require("lodash/flatMap")):"function"==typeof define&&define.amd?define(["exports","react","prop-types","lodash/findLast","@leafygreen-ui/palette","@leafygreen-ui/tooltip","@leafygreen-ui/emotion","@leafygreen-ui/hooks","@leafygreen-ui/lib","@emotion/react","lodash/flatMap"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self)["@leafygreen-ui/pipeline"]={},e.React,e.PropTypes,e.findLast,e["@leafygreen-ui/palette"],e["@leafygreen-ui/tooltip"],e["@leafygreen-ui/emotion"],e["@leafygreen-ui/hooks"],e["@leafygreen-ui/lib"],e.react,e.flatMap)}(this,(function(e,n,r,t,o,i,a,s,l,u,c){"use strict";function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=f(n),h=f(r),p=f(t),g=f(i),v=f(c);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function m(){return(m=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function O(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function z(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function x(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],t=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(t=(a=s.next()).done)&&(r.push(a.value),!n||r.length!==n);t=!0);}catch(e){o=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return j(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}var S="production"===process.env.NODE_ENV,N="Invariant failed";function C(e,n){if(!e){if(S)throw new Error(N);throw new Error(N+": "+(n||""))}}function k(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function V(){return(V=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var E=new Map,M=new Map,D=new Map,R=0;function q(e,n,r){void 0===r&&(r={}),r.threshold||(r.threshold=0);var t=r,o=t.root,i=t.rootMargin,a=t.threshold;if(E.has(e)&&("production"!==process.env.NODE_ENV?C(!1,"react-intersection-observer: Trying to observe %s, but it's already being observed by another instance.\nMake sure the `ref` is only used by a single <Observer /> instance.\n\n%s"):C(!1)),e){var s=function(e){return e?D.has(e)?D.get(e):(R+=1,D.set(e,R.toString()),D.get(e)+"_"):""}(o)+(i?a.toString()+"_"+i:a.toString()),l=M.get(s);l||(l=new IntersectionObserver(A,r),s&&M.set(s,l));var u={callback:n,element:e,inView:!1,observerId:s,observer:l,thresholds:l.thresholds||(Array.isArray(a)?a:[a])};return E.set(e,u),l.observe(e),u}}function W(e){if(e){var n=E.get(e);if(n){var r=n.observerId,t=n.observer,o=t.root;t.unobserve(e);var i=!1,a=!1;r&&E.forEach((function(n,t){t!==e&&(n.observerId===r&&(i=!0,a=!0),n.observer.root===o&&(a=!0))})),!a&&o&&D.delete(o),t&&!i&&t.disconnect(),E.delete(e)}}}function A(e){e.forEach((function(e){var n=e.isIntersecting,r=e.intersectionRatio,t=e.target,o=E.get(t);if(o&&r>=0){var i=o.thresholds.some((function(e){return o.inView?r>e:r>=e}));void 0!==n&&(i=i&&n),o.inView=i,o.callback(i,e)}}))}var H,I=function(e){var r,t;function o(){for(var n,r=arguments.length,t=new Array(r),o=0;o<r;o++)t[o]=arguments[o];return k(P(n=e.call.apply(e,[this].concat(t))||this),"state",{inView:!1,entry:void 0}),k(P(n),"node",null),k(P(n),"handleNode",(function(e){n.node&&W(n.node),n.node=e||null,n.observeNode()})),k(P(n),"handleChange",(function(e,r){(e!==n.state.inView||e)&&n.setState({inView:e,entry:r}),n.props.onChange&&n.props.onChange(e,r)})),n}t=e,(r=o).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var i=o.prototype;return i.componentDidMount=function(){this.node||("production"!==process.env.NODE_ENV?C(!1,'react-intersection-observer: No DOM node found. Make sure you forward "ref" to the root DOM element you want to observe.'):C(!1))},i.componentDidUpdate=function(e,n){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold||(W(this.node),this.observeNode()),n.inView!==this.state.inView&&this.state.inView&&this.props.triggerOnce&&(W(this.node),this.node=null)},i.componentWillUnmount=function(){this.node&&(W(this.node),this.node=null)},i.observeNode=function(){if(this.node){var e=this.props,n=e.threshold,r=e.root,t=e.rootMargin;q(this.node,this.handleChange,{threshold:n,root:r,rootMargin:t})}},i.render=function(){var e=this.state,r=e.inView,t=e.entry;if(!function(e){return"function"!=typeof e.children}(this.props))return this.props.children({inView:r,entry:t,ref:this.handleNode});var o=this.props,i=o.children,a=o.as,s=o.tag,l=(o.triggerOnce,o.threshold,o.root,o.rootMargin,o.onChange,function(e,n){if(null==e)return{};var r,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(o,["children","as","tag","triggerOnce","threshold","root","rootMargin","onChange"]));return n.createElement(a||s||"div",V({ref:this.handleNode},l),i)},o}(n.Component);function _(){var e=z(["\n    margin-left: ","px;\n    width: ","px;\n    height: 100%;\n    position: absolute;\n    right: -","px;\n    top: 0;\n    overflow: hidden;\n    align-self: center;\n\n    &::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      transform-origin: 0 0;\n      transform: rotate(45deg);\n    }\n  "]);return _=function(){return e},e}function L(){var e=z(["\n    position: relative;\n    flex-direction: row;\n    line-height: ",";\n    align-items: center;\n    justify-content: center;\n  "]);return L=function(){return e},e}function T(){var e=z(["\n    display: flex;\n    height: ","px;\n    line-height: ",";\n  "]);return T=function(){return e},e}k(I,"displayName","InView"),k(I,"defaultProps",{threshold:0,triggerOnce:!1});var X={XSmall:"xsmall",Small:"small",Normal:"normal",Large:"large"},U=(y(H={},X.XSmall,{borderRadius:4,chevron:{size:2},fontSize:12,fontWeight:600,gutter:{vertical:2,horizontal:4},height:22,lineHeight:1,minWidth:74}),y(H,X.Small,{borderRadius:4,chevron:{size:2},fontSize:14,fontWeight:600,gutter:{vertical:2,horizontal:6},height:25,lineHeight:1,minWidth:74}),y(H,X.Normal,{borderRadius:4,chevron:{size:3},fontSize:14,fontWeight:600,gutter:{vertical:2,horizontal:8},height:32,lineHeight:1,minWidth:74}),y(H,X.Large,{borderRadius:4,chevron:{size:4},fontSize:16,fontWeight:600,gutter:{vertical:2,horizontal:10},height:45,lineHeight:1,minWidth:74}),H),B={color:o.uiColors.blue.base,primary:{backgroundColor:o.uiColors.blue.light2},secondary:{backgroundColor:o.uiColors.blue.light3}},J=function(e){var n=e.size,r=U[n],t=r.height,o=r.lineHeight;return a.css(T(),t,o)},$=function(e){var n=e.size,r=U[n].lineHeight;return a.css(L(),r)},F=function(e){var n=e.size,r=U[n],t=r.gutter,o=r.height/2+2*r.chevron.size,i=o;return a.css(_(),2*t.horizontal,o,i)},G=l.createDataProp("pipeline"),K=l.createDataProp("pipeline-stages"),Q=l.createDataProp("pipeline-stage"),Y=l.createDataProp("pipeline-stage-chevron"),Z=l.createDataProp("pipeline-counter"),ee=l.createDataProp("pipeline-counter-chevron");function ne(){var e=z(["\n      &::before {\n        background-color: ",";\n        box-shadow: 0 0 0 ","px ",",\n          0 0 0 ","px ",";\n      }\n    "]);return ne=function(){return e},e}function re(){var e=z(["\n      background-color: ",";\n      color: ",";\n      padding: ","px ","px;\n      margin-right: ","px;\n      font-size: ","px;\n      font-weight: ",";\n      line-height: ",";\n      flex: 1 1 auto;\n      white-space: nowrap;\n      z-index: 1;\n\n      &:first-of-type {\n        border-top-left-radius: ","px;\n        border-bottom-left-radius: ","px;\n      }\n\n      &[data-stage-visible='false'] {\n        counter-increment: hiddenCount;\n      }\n    "]);return re=function(){return e},e}var te=function(e){var n=e.size,r=void 0===n?X.XSmall:n,t=U[r],i=t.chevron,s=t.height,l=B.primary,u=s/2;return a.cx(F({size:r}),a.css(ne(),l.backgroundColor,i.size,o.uiColors.white,u,l.backgroundColor))},oe=n.forwardRef((function(e,r){var t,o=e.children,i=e.className,s=void 0===i?"":i,l=e.intersectionNode,c=e.size,f=e.threshold,d=void 0===f?.8:f,h=O(e,["children","className","intersectionNode","size","threshold"]),p=x(function(e){void 0===e&&(e={});var r=n.useRef(),t=n.useState({inView:!1,entry:void 0}),o=t[0],i=t[1],a=n.useCallback((function(n){r.current&&W(r.current),n&&q(n,(function(r,t){i({inView:r,entry:t}),r&&e.triggerOnce&&W(n)}),e),r.current=n}),[e.threshold,e.root,e.rootMargin,e.triggerOnce]);return n.useDebugValue(o.inView),[a,o.inView,o.entry]}({threshold:d,root:l}),2),g=p[0],v=p[1],b=function(e){return{base:(n=e,r=n.size,t=void 0===r?X.XSmall:r,o=U[t],i=o.borderRadius,s=o.chevron,l=o.fontSize,u=o.fontWeight,c=o.gutter,f=o.height,d=o.lineHeight,h=B.color,p=B.primary,g=f/2+2*s.size,a.cx(J({size:t}),$({size:t}),a.css(re(),p.backgroundColor,h,c.vertical,c.horizontal,g,l,u,d,i,i))),chevron:te(e)};var n,r,t,o,i,s,l,u,c,f,d,h,p,g}({size:c}),y=b.base,w=b.chevron;return u.jsx("li",m({},h,Q.prop,{ref:(t=[g,r],function(e){t.forEach((function(n){"function"==typeof n?n(e):null!=n&&(n.current=e)}))}),"data-testid":"pipeline-stage","data-stage-visible":v,className:a.cx(y,s)}),o,u.jsx("div",m({"data-testid":"pipeline-stage-chevron"},Y.prop,{className:w})))}));function ie(){var e=z(["\n      &::before {\n        background-color: ",";\n        box-shadow: 0 0 0 ","px transparent,\n          0 0 0 ","px transparent;\n      }\n    "]);return ie=function(){return e},e}function ae(){var e=z(["\n      background-color: ",";\n      color: ",";\n      padding: ","px ","px;\n      margin-right: ","px;\n      font-size: ","px;\n      font-weight: ",";\n      line-height: ",";\n      flex: 1 1 auto;\n      white-space: nowrap;\n      z-index: 2;\n\n      &::before {\n        white-space: nowrap;\n        content: '+' counter(hiddenCount);\n      }\n    "]);return ae=function(){return e},e}oe.displayName="Stage",oe.propTypes={children:h.default.node.isRequired,className:h.default.string,intersectionNode:h.default.any,size:h.default.oneOf(Object.values(X)),threshold:h.default.oneOfType([h.default.number,h.default.arrayOf(h.default.number.isRequired)])};var se=function(e){var n=e.size,r=void 0===n?X.XSmall:n,t=U[r],o=t.chevron,i=t.height,s=B.secondary,l=i/2;return a.cx(F({size:r}),a.css(ie(),s.backgroundColor,o.size,l))},le=n.forwardRef((function(e,n){var r=e.className,t=void 0===r?"":r,o=e.children,i=e.size,s=O(e,["className","children","size"]),l=function(e){return{base:(n=e,r=n.size,t=void 0===r?X.XSmall:r,o=U[t],i=o.chevron,s=o.fontSize,l=o.fontWeight,u=o.gutter,c=o.height,f=o.lineHeight,d=B.color,h=B.secondary,p=c/2+2*i.size,a.cx(J({size:t}),$({size:t}),a.css(ae(),h.backgroundColor,d,u.vertical,u.horizontal,p,s,l,f))),chevron:se(e)};var n,r,t,o,i,s,l,u,c,f,d,h,p}({size:i}),c=l.base,f=l.chevron;return u.jsx("div",m({},s,Z.prop,{"data-testid":"pipeline-counter",className:a.cx(c,t),ref:n}),o,u.jsx("div",m({},ee.prop,{"data-testid":"pipeline-counter-chevron",className:f})))}));le.displayName="Counter",le.propTypes={children:h.default.node,className:h.default.string,size:h.default.oneOf(Object.values(X)).isRequired};const ue=e=>n.isValidElement(e)&&Boolean(e.props.children),ce=e=>null==e||"boolean"==typeof e||"{}"===JSON.stringify(e)?"":e.toString(),fe=e=>e instanceof Array||n.isValidElement(e)?n.Children.toArray(e).reduce(((e,r)=>{let t="";return t=n.isValidElement(r)&&ue(r)?fe(r.props.children):n.isValidElement(r)&&!ue(r)?"":ce(r),e.concat(t)}),""):ce(e);function de(){var e=z(["\n    ."," > ","::before {\n      background-color: ",";\n      box-shadow: 0 0 0 ","px ",",\n        0 0 0 ","px ",";\n    }\n  "]);return de=function(){return e},e}function he(){var e=z(["\n      flex-grow: 1;\n      flex-shrink: 1;\n      flex-basis: 100%;\n      flex-wrap: wrap;\n      overflow: hidden;\n      list-style: none;\n      padding: 0;\n      margin: 0;\n      min-width: ","px;\n    "]);return he=function(){return e},e}function pe(){var e=z(["\n      counter-reset: hiddenCount;\n      flex-direction: row;\n    "]);return pe=function(){return e},e}var ge=function(e){var n=e.size,r=U[n].minWidth;return a.cx(J({size:n}),a.css(he(),r))},ve="leafygreen-ui-pipeline-stage--last-visible",be=function(e){var n=e.hasHiddenStages,r=e.size,t=U[r],i=t.height,s=t.chevron,l=B.primary,u=B.secondary,c=i/2,f=n?{innerColor:o.uiColors.white,outerColor:u.backgroundColor}:{innerColor:"transparent",outerColor:"transparent"};return a.css(de(),ve,Y.selector,l.backgroundColor,s.size,f.innerColor,c,f.outerColor)},ye=n.forwardRef((function(e,r){var t=e.children,o=e.className,i=void 0===o?"":o,l=e.size,c=void 0===l?X.XSmall:l,f=O(e,["children","className","size"]),h=x(n.useState(null),2),z=h[0],j=h[1],S=x(n.useState(!1),2),N=S[0],C=S[1];s.useMutationObserver(z,{childList:!0,subtree:!0,attributes:!0},(function(e){var n,r,t=e.map((function(e){return e.type}));(e.map((function(e){return e.attributeName})).includes("data-stage-visible")||t.includes("childList"))&&(r=(n=z)&&n.scrollHeight>n.clientHeight||n&&n.scrollWidth>n.clientWidth,C(r),function(){var e=Array.from(z.children);e.forEach((function(e){e.classList.remove(ve)}));var n=p.default(e,(function(e){return"false"!==e.dataset.stageVisible}));n&&n.classList.add(ve)}())}));var k=d.default.Children.map(t,(function(e){var r,t={size:c,intersectionNode:z,ref:n.createRef()};return null!==(r=e)&&"object"===b(r)&&"type"in r&&"Stage"===r.type.displayName?d.default.cloneElement(e,t):d.default.createElement(oe,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){y(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},t,{children:e}))})),V=function(e){var n=(d.default.Children.map(e,fe)||[]).filter(Boolean);return v.default(n,(function(e,n,r){return r.length-1!==n?[e,">"]:e})).join(" ")}(k),P=function(e){return{base:(n=e,r=n.size,a.cx(J({size:r}),a.css(pe()))),pipeline:ge(e),lastVisibleStageChevron:be(e)};var n,r}({hasHiddenStages:N,size:c}),E=P.base,M=P.pipeline,D=P.lastVisibleStageChevron;return u.jsx("div",m({},f,G.prop,{"data-testid":"pipeline",ref:r,className:a.cx(E,i)}),u.jsx("ol",m({},K.prop,{ref:j,"data-testid":"pipeline-stages",className:a.cx(M,D)}),k),N&&d.default.Children.count(k)>0&&u.jsx(g.default,{align:"top",justify:"middle",trigger:u.jsx(le,{size:c}),triggerEvent:"hover",darkMode:!0},V))}));ye.displayName="Pipeline",ye.propTypes={children:h.default.node,className:h.default.string,size:h.default.oneOf(Object.values(X)).isRequired},e.Counter=le,e.Pipeline=ye,e.Size=X,e.Stage=oe,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
