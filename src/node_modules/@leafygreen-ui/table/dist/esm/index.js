import n,{useReducer as e,useEffect as r,useMemo as t,useContext as o,createContext as a,useState as i,useCallback as l,useRef as c}from"react";import d from"lodash/debounce";import{transparentize as s}from"polished";import{cx as u,css as p}from"@leafygreen-ui/emotion";import{uiColors as f}from"@leafygreen-ui/palette";import{useViewportSize as y,useIsomorphicLayoutEffect as h,useIdAllocator as m}from"@leafygreen-ui/hooks";import{useBaseFontSize as g}from"@leafygreen-ui/leafygreen-provider";import{jsx as b}from"@emotion/react";import{isComponentType as v,createDataProp as w,enforceExhaustive as x}from"@leafygreen-ui/lib";import S from"use-ssr";import{Transition as k}from"react-transition-group";import N from"@leafygreen-ui/icon-button";import O from"@leafygreen-ui/icon/dist/ChevronRight";import C from"@leafygreen-ui/icon/dist/ChevronDown";import j from"@leafygreen-ui/icon/dist/SortAscending";import R from"@leafygreen-ui/icon/dist/SortDescending";import A from"@leafygreen-ui/icon/dist/Unsorted";function E(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,t)}return r}function P(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){T(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}function T(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function F(){return(F=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}return n}).apply(this,arguments)}function I(n,e){if(null==n)return{};var r,t,o=function(n,e){if(null==n)return{};var r,t,o={},a=Object.keys(n);for(t=0;t<a.length;t++)r=a[t],e.indexOf(r)>=0||(o[r]=n[r]);return o}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(t=0;t<a.length;t++)r=a[t],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(n,r)&&(o[r]=n[r])}return o}function H(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function z(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null==r)return;var t,o,a=[],i=!0,l=!1;try{for(r=r.call(n);!(i=(t=r.next()).done)&&(a.push(t.value),!e||a.length!==e);i=!0);}catch(n){l=!0,o=n}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}(n,e)||M(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(n){return function(n){if(Array.isArray(n))return _(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||M(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(n,e){if(n){if("string"==typeof n)return _(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(n,e):void 0}}function _(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}var W="REGISTER_COLUMN_INFO",B="SET_HAS_NESTED_ROWS",L="SET_HAS_ROW_SPAN",V="SET_DATA",G={Number:"number",Weight:"weight",ZipCode:"zipCode",String:"string",Date:"date"},U=a({state:{data:[]},dispatch:function(){}});function q(n,e){switch(e.type){case L:return P(P({},n),{},{hasRowSpan:e.payload});case B:return P(P({},n),{},{hasNestedRows:e.payload});case W:return P(P({},n),{},{columnInfo:P(P({},n.columnInfo),{},T({},e.payload.index,{dataType:e.payload.dataType}))});case V:return P(P({},n),{},{data:e.payload});default:return n}}function Z(n){var o=n.children,a=n.data,i=z(e(q,{data:a,hasNestedRows:!1}),2),l=i[0],c=i[1];r((function(){c({type:V,payload:a})}),[a]);var d=t((function(){return{state:l,dispatch:c}}),[l,c]);return b(U.Provider,{value:d},o)}function $(){return o(U)}var J=["children","className"];function K(n){var e=n.children,r=n.className,t=I(n,J);return b("tr",F({},t,{className:r,"data-testid":"leafygreen-ui-header-row"}),e)}function Q(e){var r=e.columns,t=void 0===r?[]:r,o=n.useRef(!1);var a=function e(r){return r.map((function(r,t){var a={key:t,index:t};if(v(r,"HeaderRow")){o.current=!0;var i=(null==r?void 0:r.props).children;return n.cloneElement(r,{children:e(n.Children.toArray(i))})}return v(r,"TableHeader")?n.cloneElement(r,a):r}))}(t.type===n.Fragment||v(t,"HeaderRow")?n.Children.toArray(t.props.children):t);return o.current?b("thead",null,a):b("thead",null,b(K,null,a))}K.displayName="HeaderRow";var X=a({sort:void 0,setSort:function(){}});function Y(n){var e=n.children,r=z(i(void 0),2),o=r[0],a=r[1],l=t((function(){return{sort:o,setSort:a}}),[o,a]);return b(X.Provider,{value:l},e)}function nn(){return o(X)}var en=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),rn=function(n){var e=n.direction,r=n.accessorValue,t=n.compareFn;return r?function(n,t){var o=r(n),a=r(t);return"desc"!==e?en.compare(o,a):en.compare(a,o)}:t?function(n,r){return t(n,r,e)}:void console.error("Error getting Table data comparison function. Please supply either an `accessorValue` or `compareFn`")};function tn(e){var r=e.children,o=$().state.data,a=nn().sort,i=t((function(){if(a){var n=a.direction,e=a.accessorValue,r=a.compareFn;if(r)return rn({direction:n,compareFn:r});if(e)return rn({direction:n,accessorValue:e})}}),[a]),c=function(e,r,o){var a=t((function(){var t=new Map;return e.forEach((function(e,o){return t.set(e,b(n.Fragment,{key:o},r(e)))})),t}),[e,r]);return t((function(){return o?D(e).sort(o).map((function(n){return a.get(n)})):Array.from(a.values())}),[e,a,o])}(o,l((function(n){return r({datum:n})}),[r]),i);return b("tbody",null,c)}tn.displayName="TableBody";var on=a(14);function an(n){var e=n.children,r=n.baseFontSize;return b(on.Provider,{value:r},e)}function ln(){return o(on)}var cn=a(!1);function dn(n){var e=n.children,r=n.darkMode;return b(cn.Provider,{value:r},e)}function sn(){return o(cn)}var un,pn,fn,yn,hn,mn,gn,bn,vn,wn,xn,Sn=["columns","data","children","className","baseFontSize","darkMode"],kn=s(.7,f.black),Nn=s(.2,f.black),On=p(un||(un=H(["\n  position: relative;\n  max-width: 100%;\n"]))),Cn=p(pn||(pn=H(["\n  border-collapse: collapse;\n  box-sizing: border-box;\n  width: 100%;\n"]))),jn=p(fn||(fn=H(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 16px;\n  overflow: hidden;\n  pointer-events: none;\n\n  &:after {\n    opacity: 0;\n    content: '';\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    width: 16px;\n    border-radius: 100%;\n    transition: opacity 150ms ease-in-out;\n  }\n"]))),Rn=function(n){return p(yn||(yn=H(["\n  left: 0;\n\n  &:after {\n    right: 100%;\n    box-shadow: 4px 0 4px ",";\n  }\n"])),n?Nn:kn)},An=function(n){return p(hn||(hn=H(["\n  right: 0;\n\n  &:after {\n    left: 100%;\n    box-shadow: -4px 0 4px ",";\n  }\n"])),n?Nn:kn)},En=p(mn||(mn=H(["\n  &:after {\n    opacity: 1;\n  }\n"]))),Pn="none",Tn="left",Fn="right",In="both";function Hn(e){var r=e.columns,t=void 0===r?[]:r,o=e.data,a=void 0===o?[]:o,i=e.children,l=e.className,c=e.baseFontSize,s=e.darkMode,m=void 0!==s&&s,v=I(e,Sn),w=z(n.useState(Pn),2),x=w[0],S=w[1],k=n.useRef(null),N=y(),O=g(),C=null!=c?c:14===O||16===O?O:14;h((function(){var n=k.current;null!=n&&(n.scrollWidth>n.clientWidth?S(Fn):null!=N&&n.getBoundingClientRect().width<=N.width&&S(Pn))}),[N]);var j=d((function(n){var e=n.target,r=e.scrollWidth,t=e.clientWidth;if(r>t){var o=n.target.scrollLeft,a=r-t;o>0&&o<a?S(In):o>0?S(Tn):o<a&&S(Fn)}}),50,{leading:!0}),R=x===Tn||x===In,A=x===Fn||x===In;return b("div",{className:On},b("div",{className:u(jn,Rn(m),T({},En,R))}),b("div",{className:u(jn,An(m),T({},En,A))}),b("div",{ref:k,onScroll:function(n){n.persist(),j(n)},className:u(p(gn||(gn=H(["\n            overflow-x: auto;\n          "]))))},b("table",F({cellSpacing:"0",cellPadding:"0",className:u(Cn,p(bn||(bn=H(["\n              border-bottom: 1px solid\n                ",";\n            "])),m?f.gray.dark1:f.gray.light2),l)},v),b(Z,{data:a},b(Y,null,b(an,{baseFontSize:C},b(dn,{darkMode:m},b(Q,{columns:t}),b(tn,null,i))))))))}var zn,Dn,Mn,_n=p(vn||(vn=H(["\n  min-width: 40px;\n  padding: 8px 8px;\n  box-sizing: border-box;\n  vertical-align: middle;\n"]))),Wn=function(n){return p(14===n?wn||(wn=H(["\n      ","\n      font-size: 14px;\n      line-height: 20px;\n    "])):xn||(xn=H(["\n    ","\n    font-size: 16px;\n    line-height: 24px;\n  "])),_n)},Bn=["children","className","isHeader"],Ln=w("td-inner-div"),Vn=p(zn||(zn=H(["\n  line-height: 20px;\n  position: relative;\n"]))),Gn=p(Dn||(Dn=H(["\n  font-weight: bold;\n"]))),Un=p(Mn||(Mn=H(["\n  display: flex;\n  align-items: center;\n"]))),qn=n.forwardRef((function(n,e){var r=n.children,t=n.className,o=n.isHeader,a=void 0!==o&&o,i=I(n,Bn),l=a?"th":"td",c=ln(),d={ref:e,className:u(Wn(c),Vn,T({},Gn,a),t)};return a&&(d.scope="row",d.role="rowheader"),b(l,F({},d,i),b("div",F({className:Un},Ln.prop),r))}));qn.displayName="Cell";var Zn,$n,Jn,Kn,Qn,Xn,Yn,ne,ee,re,te,oe,ae,ie,le,ce=["expanded","disabled","indentLevel","isAnyAncestorCollapsed","children","className"],de="light",se="dark",ue=p(Zn||(Zn=H(["\n  margin-right: 4px;\n  margin-left: -8px;\n"]))),pe=(T(ne={},de,{rowStyle:p($n||($n=H(["\n      --lg-table-row-border-color: ",";\n      color: ",";\n    "])),f.gray.light2,f.gray.dark2),altColor:p(Jn||(Jn=H(["\n      &:nth-of-type(even) {\n        background-color: ",";\n      }\n    "])),f.gray.light3),disabledStyle:p(Kn||(Kn=H(["\n      background-color: ",";\n      color: ",";\n      cursor: not-allowed;\n      border-top: 1px solid ",";\n      border-bottom: 1px solid ",";\n    "])),f.gray.light2,f.gray.base,f.gray.light1,f.gray.light1)}),T(ne,se,{rowStyle:p(Qn||(Qn=H(["\n      --lg-table-row-border-color: ",";\n      background-color: ",";\n      color: ",";\n    "])),f.gray.dark1,f.gray.dark3,f.gray.light3),altColor:p(Xn||(Xn=H(["\n      &:nth-of-type(even) {\n        background-color: ",";\n      }\n    "])),f.gray.dark2),disabledStyle:p(Yn||(Yn=H(["\n      background-color: ",";\n      color: ",";\n      cursor: not-allowed;\n      border-top: 1px solid ",";\n      border-bottom: 1px solid ",";\n    "])),f.gray.dark1,f.gray.base,f.gray.base,f.gray.base)}),ne),fe=p(ee||(ee=H(["\n  --lg-min-cell-height: 40px;\n  border-top: 1px solid var(--lg-table-row-border-color);\n\n  & > td > "," {\n    min-height: var(--lg-min-cell-height);\n    max-height: unset;\n  }\n"])),Ln.selector),ye=p(re||(re=H(["\n  opacity: 0;\n"]))),he=p(te||(te=H(["\n  transform-origin: 50% 0%;\n  border-color: var(--lg-table-row-border-color);\n  opacity: 0;\n  transition: ","ms ease-in-out;\n  transition-property: border-color, opacity;\n\n  & > td {\n    transition: ","ms ease-in-out;\n    transition-property: padding-block;\n\n    & > "," {\n      overflow: hidden;\n      transition: ","ms ease-in-out;\n      transition-property: min-height, max-height;\n    }\n  }\n"])),200,200,Ln.selector,200),me=p(oe||(oe=H(["\n  opacity: 0;\n  border-color: transparent;\n\n  & > td {\n    padding-block: 0;\n\n    & > "," {\n      min-height: 0px;\n      max-height: 0px;\n    }\n  }\n"])),Ln.selector),ge=function(n,e){switch(n){case"entered":return p(ae||(ae=H(["\n        opacity: 1;\n        & > td {\n          padding-block: 8px;\n\n          & > "," {\n            min-height: var(--lg-min-cell-height);\n            max-height: max(var(--lg-min-cell-height), ","px);\n          }\n        }\n      "])),Ln.selector,e);default:return me}};var be=n.forwardRef((function(e,o){var a,l=e.expanded,d=void 0!==l&&l,s=e.disabled,y=void 0!==s&&s,h=e.indentLevel,g=void 0===h?0:h,w=e.isAnyAncestorCollapsed,x=e.children,j=e.className,R=I(e,ce),A=S().isBrowser,E=$(),P=E.state,M=P.data,_=P.columnInfo,W=P.hasNestedRows,V=P.hasRowSpan,U=E.dispatch,q=sn(),Z=q?se:de,J=c(m({prefix:"row"})),K=z(i(d),2),Q=K[0],X=K[1],Y=c(null),nn=z(i(0),2),en=nn[0],rn=nn[1];r((function(){if(Y&&Y.current){var n=Y.current.querySelector("".concat(Ln.selector," > span"));n&&n.offsetHeight&&rn(n.offsetHeight)}}),[Y.current,Q]),r((function(){var e=!1,r=!1;W&&V||(n.Children.forEach(x,(function(n){!v(n,"Row")||e||W||(e=!0),v(n,"Cell")&&n.props.rowSpan&&n.props.rowSpan>1&&!V&&!r&&(r=!0)})),e&&W!==e&&U({type:B,payload:!0}),r&&V!==r&&U({type:L,payload:!0}))}),[x,W,V,U,M]);var tn=t((function(){var e=[];return{rowHasNestedRows:n.Children.toArray(x).some((function(n){return v(n,"Row")})),renderedNestedRows:e,renderedTransitionGroup:A?b(k,{in:Q&&!w,timeout:{enter:0,exit:200},nodeRef:Y},(function(e){return n.Children.map(x,(function(r,t){if(null!=r&&v(r,"Row"))return n.cloneElement(r,{ref:Y,isAnyAncestorCollapsed:w||!Q,indentLevel:g+1,key:"".concat(J.current,"-").concat(g,"-").concat(t),className:u(he,ge(e,en),"transition-".concat(e))})}))})):e}}),[x,Q,w,A,g,en]),on=tn.rowHasNestedRows,an=tn.renderedTransitionGroup,ln=t((function(){var e=[];if(n.Children.forEach(x,(function(r,t){if(v(r,"Cell")){if(null==r.props.children)return null;e.push(n.cloneElement(r,{children:b("span",null,r.props.children),key:"".concat(J.current,"-").concat(t)}))}})),on){var r=b(N,{onClick:function(){return X((function(n){return!n}))},"aria-label":Q?"Collapse row":"Expand row","aria-expanded":Q,className:ue,darkMode:q},b(Q?C:O,{"aria-hidden":!0,color:q?f.gray.base:f.gray.dark2}));e[0]=n.cloneElement(e[0],{children:b(n.Fragment,null,r,b("span",null,e[0].props.children)),key:"".concat(J.current,"-").concat(e[0].props.children)})}return e}),[x,on,Q,X,q]),cn=M&&M.length>=10&&null!=W&&!W,dn=_?Object.entries(_).map((function(n){var e=z(n,2);return function(n,e){var r;return r=e===G.Number?"flex-end":"flex-start",p(ie||(ie=H(["\n    & td:nth-child(",") > div {\n      justify-content: ",";\n    }\n  "])),n,r)}(e[0],e[1].dataType)})):[""],un=u(fe,pe[Z].rowStyle,function(n){return p(le||(le=H(["\n    & > td:nth-child(1) {\n      padding-left: ","px;\n    }\n  "])),8+16*n)}(g),D(dn),(T(a={},ye,!_),T(a,pe[Z].altColor,cn),T(a,pe[Z].disabledStyle,y),a),j);return b(n.Fragment,null,b("tr",F({role:"row",className:un,"aria-disabled":y,ref:o,key:J.current},R),ln),an)}));be.displayName="Row";var ve,we,xe,Se,ke,Ne,Oe,Ce,je,Re,Ae=["label","onClick","index","className","dataType","sortBy","compareFn","handleSort"],Ee="light",Pe="dark",Te=(T(Oe={},Ee,{thStyle:p(ve||(ve=H(["\n      border-color: ",";\n    "])),f.gray.light2),labelStyle:p(we||(we=H(["\n      color: ",";\n    "])),f.gray.dark2),glyphColor:p(xe||(xe=H(["\n      color: ",";\n    "])),f.blue.base)}),T(Oe,Pe,{thStyle:p(Se||(Se=H(["\n      background-color: ",";\n      border-color: ",";\n    "])),f.gray.dark3,f.gray.dark1),labelStyle:p(ke||(ke=H(["\n      color: ",";\n    "])),f.gray.light3),glyphColor:p(Ne||(Ne=H(["\n      color: ",";\n    "])),f.blue.light1)}),Oe),Fe=p(Ce||(Ce=H(["\n  border-width: 0px 1px 3px 1px;\n  border-style: solid;\n"]))),Ie=p(je||(je=H(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  min-height: 32px;\n"]))),He=p(Re||(Re=H(["\n  padding-right: 4px;\n"]))),ze={unsorted:A,asc:R,desc:j};function De(e){var r=e.label,t=(e.onClick,e.index),o=e.className,a=e.dataType,i=e.sortBy,l=e.compareFn,c=e.handleSort,d=I(e,Ae),s=$().dispatch,p=nn(),f=p.sort,y=p.setSort,h=ln(),m=sn(),g=m?Pe:Ee;n.useEffect((function(){"number"==typeof t&&s({type:W,payload:{index:t+1,dataType:a}})}),[t,a,s]);var v,w=i&&function(n){var e=n;if("string"==typeof n)if(n.includes(".")){var r=n.split(".");e=function(n){return r.reduce((function(n,e){return n[e]}),n)}}else e=function(e){return e[n]};return e}(i),S=!!(i||l||c),k=f&&f.columnId===t?f.direction:null,O=null!=k?k:"unsorted",C=ze[O];switch(k){case"asc":v="ascending";break;case"desc":v="descending";break;case null:v="none";break;default:x(k)}return b("th",F({role:"columnheader",scope:"col","aria-sort":v},d,{className:u(Fe,Wn(h),Te[g].thStyle,o)}),b("div",{className:Ie},b("span",{className:u(He,Te[g].labelStyle)},r),S&&b(N,{"aria-label":"sort",onClick:function(){if("number"==typeof t&&S){var n=t===(null==f?void 0:f.columnId)?"asc"===f.direction?"desc":"asc":"desc";y((function(e){return{columnId:t,direction:n,accessorValue:w||void 0,compareFn:l}})),null==c||c(n)}},darkMode:m},b(C,{size:"small",title:"".concat(O,"-").concat(t),className:u(T({},Te[g].glyphColor,"asc"===O||"desc"===O))}))))}De.displayName="TableHeader";export{qn as Cell,G as DataType,K as HeaderRow,be as Row,Hn as Table,De as TableHeader};
//# sourceMappingURL=index.js.map
